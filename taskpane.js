/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"8d768f65702f2137206f.css"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function u(e,a,o,s){var u=a&&a.prototype instanceof l?a:l,c=Object.create(u.prototype);return t(c,"_invoke",function(e,t,a){var o,s,u,l=0,c=a||[],f=!1,g={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return o=e,s=0,u=n,g.n=t,i}};function p(e,t){for(s=e,u=t,r=0;!f&&l&&!a&&r<c.length;r++){var a,o=c[r],p=g.p,h=o[2];e>3?(a=h===t)&&(u=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=n):o[0]<=p&&((a=e<2&&p<o[1])?(s=0,g.v=t,g.n=o[1]):p<h&&(a=e<3||o[0]>t||t>h)&&(o[4]=e,o[5]=t,g.n=h,s=0))}if(a||e>1)return i;throw f=!0,t}return function(a,c,h){if(l>1)throw TypeError("Generator is already running");for(f&&1===c&&p(c,h),s=c,u=h;(r=s<2?n:u)||!f;){o||(s?s<3?(s>1&&(g.n=-1),p(s,u)):g.n=u:g.v=u);try{if(l=2,o){if(s||(a="next"),r=o[a]){if(!(r=r.call(o,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,s<2&&(s=0)}else 1===s&&(r=o.return)&&r.call(o),s<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=n}else if((r=(f=g.n<0)?u:e.call(t,g))!==i)break}catch(e){o=n,s=1,u=e}finally{l=1}}return{value:r,done:f}}}(e,o,s),!0),c}var i={};function l(){}function c(){}function f(){}r=Object.getPrototypeOf;var g=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),p=f.prototype=l.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=f,t(p,"constructor",f),t(f,"constructor",c),c.displayName="GeneratorFunction",t(f,s,"GeneratorFunction"),t(p),t(p,s,"Generator"),t(p,o,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:u,m:h}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},t(e,n,r,a)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw s}}}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,s,u=[],i=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{if(!i&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw a}}return u}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,a,o,s){try{var u=e[o](s),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){u(o,r,a,s,i,"next",e)}function i(e){u(o,r,a,s,i,"throw",e)}s(void 0)})}}function l(){return c.apply(this,arguments)}function c(){return c=i(e().m(function t(){var o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=i(e().m(function t(o){var s,u,i,l,c,A,D,I,E,T,M,U,S,x,N,F,B,K,P,O,j,L,G,Y,_,H,X,$,z,J,q,Q,V,W,Z,ee,te,ne,re,ae,oe,se,ue,ie,le,ce,fe,ge,pe,he,de,ve,ye,me,we,be,Re,ke,Ce,Ae,De,Ie,Ee,Te,Me,Ue,Se,xe,Ne,Fe,Be,Ke,Pe,Oe,je,Le,Ge,Ye,_e,He,Xe,$e,ze,Je,qe,Qe,Ve,We,Ze,et,tt,nt,rt,at,ot,st,ut,it,lt,ct,ft,gt,pt,ht,dt,vt,yt,mt,wt,bt,Rt,kt,Ct,At,Dt,It,Et,Tt,Mt,Ut,St,xt,Nt,Ft,Bt,Kt,Pt,Ot,jt,Lt,Gt,Yt,_t,Ht,Xt,$t,zt;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=o.workbook.worksheets.getItem("DrugDetails"),u=o.workbook.worksheets.getItem("packageDistribution"),i=u.getRange("A2:D7"),l=s.getUsedRange().getLastRow(),o.workbook.worksheets.getItem("AutoReplenishHistory"),c=o.workbook.worksheets.getItem("Drug Replenish Dates(New Kits)"),A=o.workbook.worksheets.getItem("auto_replenish_med_groups"),D=o.workbook.worksheets.getItem("Revenue Prediction"),I=o.workbook.worksheets.getItem("AED_Details(main)"),(E=I.getUsedRange()).load(["rowIndex","rowCount"]),e.n=1,o.sync();case 1:return T=E.rowIndex,(M=I.getRange("A2:I".concat(T+1))).load("values"),e.n=2,o.sync();case 2:return U={},M.values.forEach(function(e){e[1]&&""!==e[1].toString().trim()&&(U[e[1].trim()]={itemName:e[1],units:e[2],unitCost:e[3],totalUnitCost:e[4],laCarte:e[5],shelfLife:e[8],basePrice:e[5]})}),console.log("AED Items loaded:",Object.keys(U)),S=new Map,e.p=3,x=o.workbook.worksheets.getItem("Yearly Med Increase"),(N=x.getUsedRange()).load("rowCount"),e.n=4,o.sync();case 4:if(!(N.rowCount>1)){e.n=6;break}return(F=x.getRange("A2:B".concat(N.rowCount))).load("values"),e.n=5,o.sync();case 5:F.values.forEach(function(e){if(e[0]&&null!==e[1]&&""!==e[1]&&!isNaN(e[1])){var t=y(d(e[0]));S.set(t,parseFloat(e[1]))}}),console.log("Monthly increase data loaded:",S);case 6:e.n=8;break;case 7:e.p=7,e.v,console.log("Yearly Med Increase sheet not found or error reading data, using no increases");case 8:return D.getRangeByIndexes(1,0,1e4,12).clear(Excel.ClearApplyTo.contents),c.getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),l.load("rowIndex"),e.n=9,o.sync();case 9:return B=l.rowIndex,(K=s.getRange("B".concat(1,":O",B+1))).load("values"),i.load("values"),e.n=10,o.sync();case 10:return P=i.values,O={},j={},console.log(K.values),K.values.forEach(function(e){O[e[0]]={totalUnitCost:e[3],laCarte:e[4],includedInPackages:[],shelfLife:e[7],basePrice:e[4]};for(var t=8;t<=13;t++)e[t]&&""!==e[t].toString().trim()&&O[e[0]].includedInPackages.push(K.values[0][t])}),P.forEach(function(e){j[e[0]]={retailPrice:e[1],newKitShares:e[2],purchasePrice:e[3],drugs:[],baseRetailPrice:e[1]}}),L=o.workbook.worksheets.getItem("New Kit Data"),(G=L.getUsedRange().getLastRow()).load("rowIndex"),e.n=11,o.sync();case 11:return Y=G.rowIndex,(_=L.getRange("A2:B".concat(Y+1))).load("values"),e.n=12,o.sync();case 12:return H=_.values,X={},$=0,e.p=13,(z=L.getRange("L2")).load("values"),e.n=14,o.sync();case 14:null===z.values[0][0]||""===z.values[0][0]||isNaN(z.values[0][0])||($=parseFloat(z.values[0][0]),console.log("Using discount percentage:",$)),e.n=16;break;case 15:e.p=15,e.v,console.log("Error reading discount from L2, using 0% discount");case 16:return J=function(e,t,n){if(0===n.size)return e;var a=new Date,o=y(t);if(t<a)return e;var s,u=1,i=r(Array.from(n.keys()).sort());try{for(i.s();!(s=i.n()).done;){var l=s.value;l<=o&&(u*=1+n.get(l))}}catch(e){i.e(e)}finally{i.f()}return e*u},q=H.map(function(e){var t=y(d(e[0]));v(t)||(X[t]=e[1]);var n=e[1],r=d(e[0]),a=J(j.EMK1.baseRetailPrice,r,S),o=J(j.EMK5.baseRetailPrice,r,S),s=J(j.EMK10.baseRetailPrice,r,S),u=J(j.EMK15.baseRetailPrice,r,S),i=J(j["EMK1-Mini"].baseRetailPrice,r,S),l=J(j["EMK10-Mini"].baseRetailPrice,r,S),c=Math.floor(j.EMK1.newKitShares*n)*a,f=Math.floor(j.EMK5.newKitShares*n)*o,g=Math.floor(j.EMK10.newKitShares*n)*s,p=Math.floor(j.EMK15.newKitShares*n)*u,h=Math.floor(j["EMK1-Mini"].newKitShares*n)*i,m=Math.floor(j["EMK10-Mini"].newKitShares*n)*l,w=(c+f+g+p+h+m)*(1-$),b=c*(1-$),R=f*(1-$),k=g*(1-$),C=p*(1-$),A=h*(1-$),D=m*(1-$);return[e[0],e[1],w,"",b,R,k,C,A,D]}),L.getRange("A2:J"+(q.length+1)).values=q,K.values.forEach(function(e){"X"===e[8]&&j.EMK1.drugs.push(e[0]),"X"===e[9]&&j.EMK5.drugs.push(e[0]),"X"===e[10]&&j.EMK10.drugs.push(e[0]),"X"===e[11]&&j.EMK15.drugs.push(e[0]),"X"===e[12]&&j["EMK1-Mini"].drugs.push(e[0]),"X"===e[13]&&j["EMK10-Mini"].drugs.push(e[0])}),Q=[],Object.keys(X).forEach(function(e){var t=X[e];Object.keys(j).forEach(function(n){var r=Math.floor(t*j[n].newKitShares);r<1||j[n].drugs.forEach(function(t){if(""!=O[t].shelfLife&&"N/A"!=O[t].shelfLife){var a=k(e),o=J(O[t].basePrice,a,S);Q.push([e,n,t,r,o*r,O[t].shelfLife])}})})}),V=Q.map(function(e){for(var t=a(e,6),r=t[0],o=(t[1],t[2],t[3],t[4],t[5]),s=a(r.split("-").map(Number),2),u=s[0],i=s[1],l=new Date(Date.UTC(u,i-1,1)),c=[],f=1;f<=10;f++){var g=new Date(l);g.setUTCDate(g.getUTCDate()+o*f);var p=g.getUTCFullYear(),h=String(g.getUTCMonth()+1).padStart(2,"0");c.push("".concat(p,"-").concat(h))}return[].concat(n(e),c)}),c.getRangeByIndexes(1,0,V.length,V[0].length).values=V,W=f(q),Z=g("2025-07",300,W),ee=p(Z,V),te=A.getUsedRange(),(ne=te.getLastRow()).load("rowIndex"),e.n=17,o.sync();case 17:return(re=A.getRangeByIndexes(2,0,ne.rowIndex-1,6)).load("values"),e.n=18,o.sync();case 18:ae=[["Group","Company","Medication","Expiration","Price","Auto Replenish","Generated Dates"]],oe=r(re.values),e.p=19,oe.s();case 20:if((se=oe.n()).done){e.n=25;break}if(ue=se.value,ie=a(ue,6),le=ie[0],ce=ie[1],fe=ie[2],ge=ie[3],pe=ie[4],"Enabled"===(he=ie[5])&&"N/A"!=ge&&""!=ge){e.n=21;break}return e.a(3,24);case 21:if(de=O[fe],ve=d(ge),ye=ve?J(pe,ve,S):pe,ae.push([le,ce,fe,ve?w(ve):"N/A",ye,he,""]),de&&ve&&de.shelfLife&&""!==de.shelfLife&&"N/A"!==de.shelfLife&&!isNaN(de.shelfLife)){e.n=22;break}return e.a(3,24);case 22:if(!((me=parseInt(de.shelfLife))<=0)){e.n=23;break}return e.a(3,24);case 23:for(we=1;we<=20;we++)be=b(ve,me*we),Re=J(pe,be,S),ae.push([le,ce,fe,w(be),parseFloat(Re.toFixed(2)),he,"Generated"]);case 24:e.n=20;break;case 25:e.n=27;break;case 26:e.p=26,Xt=e.v,oe.e(Xt);case 27:return e.p=27,oe.f(),e.f(27);case 28:return ke=o.workbook.worksheets.getItem("auto_replenish_aed_groups"),Ce=ke.getUsedRange(),(Ae=Ce.getLastRow()).load("rowIndex"),e.n=29,o.sync();case 29:return(De=ke.getRangeByIndexes(2,0,Ae.rowIndex-1,6)).load("values"),e.n=30,o.sync();case 30:console.log("AED Auto Replenish data:",De.values),Ie=[["Group","Company","AED Item","Expiration","Price","Auto Replenish","Generated Dates"]],Ee=r(De.values),e.p=31,Ee.s();case 32:if((Te=Ee.n()).done){e.n=37;break}if(Me=Te.value,Ue=a(Me,6),Se=Ue[0],xe=Ue[1],Ne=Ue[2],Fe=Ue[3],Be=Ue[4],"Enabled"===(Ke=Ue[5])){e.n=33;break}return e.a(3,36);case 33:if(Pe=Ne?Ne.toString().trim():"",Oe=U[Pe],je=Fe&&"N/A"!==Fe&&""!==Fe?d(Fe):null,Le=je?J(Be,je,S):Be,Ie.push([Se,xe,Pe,je?w(je):"N/A",Le,Ke,""]),je&&Oe&&Oe.shelfLife&&""!==Oe.shelfLife&&"N/A"!==Oe.shelfLife&&!isNaN(Oe.shelfLife)){e.n=34;break}return e.a(3,36);case 34:if(!((Ge=parseInt(Oe.shelfLife))<=0)){e.n=35;break}return e.a(3,36);case 35:for(Ye=1;Ye<=20;Ye++)_e=b(je,Ge*Ye),He=J(Be,_e,S),Ie.push([Se,xe,Pe,w(_e),parseFloat(He.toFixed(2)),Ke,"Generated"]);case 36:e.n=32;break;case 37:e.n=39;break;case 38:e.p=38,$t=e.v,Ee.e($t);case 39:return e.p=39,Ee.f(),e.f(39);case 40:return console.log("AED Auto Replenish processed items:",Ie.length),Xe=h(Z,ae),$e=h(Z,Ie),console.log("Regular Auto Replenish:",Xe),console.log("AED Auto Replenish:",$e),ze=new Set([].concat(n(ee.keys()),n(Xe.keys()),n($e.keys()),n(W.keys()),n(Z.keys()))),Je=[],qe=R(),Qe=w(qe),We=.25,e.p=41,Ve=o.workbook.worksheets.getItem("Non-Auto Replenish"),Ze=Ve.getRange("G2"),et=Ve.getRange("H2"),Ze.load("values"),et.load("values"),e.n=42,o.sync();case 42:null===et.values[0][0]||""===et.values[0][0]||isNaN(et.values[0][0])?null===Ze.values[0][0]||""===Ze.values[0][0]||isNaN(Ze.values[0][0])||(We=parseFloat(Ze.values[0][0])):We=parseFloat(et.values[0][0]),console.log("Using Non-Auto Replenishment percentage:",We),e.n=44;break;case 43:e.p=43,e.v,console.log("Non-Auto Replenish sheet not found or error reading values, using default 25%");case 44:return tt=0,e.p=45,nt=o.workbook.worksheets.getItem("AED Sales"),(rt=nt.getRange("G2")).load("values"),e.n=46,o.sync();case 46:null===rt.values[0][0]||""===rt.values[0][0]||isNaN(rt.values[0][0])||(tt=parseFloat(rt.values[0][0])),console.log("Using AED Sales value:",tt),e.n=48;break;case 47:e.p=47,e.v,console.log("AED Sales sheet not found or error reading G2 value, using 0");case 48:at=n(ze).sort(),ot=r(at);try{for(ot.s();!(st=ot.n()).done;)ut=st.value,it=W.get(ut)||0,lt=Xe.get(ut)||0,ct=$e.get(ut)||0,ft=ee.get(ut)||0,ht=it+lt+ct+ft+(gt=ut>Qe?lt*We:0)+(pt=ut>Qe?tt:0),Je.push([ut,ht,it,lt,ft,gt,pt,ct])}catch(e){ot.e(e)}finally{ot.f()}return D.getRangeByIndexes(1,0,Je.length,Je[0].length).values=Je,dt=["Month","Total Revenue","New Kit Revenue","Auto Replenish","Drug Data Revenue","Non-Auto Replenishment","AED Sales","AED Auto Replenish"],D.getRangeByIndexes(0,0,1,dt.length).values=[dt],e.n=49,o.sync();case 49:return console.log("Final Revenue Forecast:",Je),console.table(Je),(vt=Array.from(Xe.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])}),yt=o.workbook.worksheets.getItem("AutoReplenishHistory"),(mt=yt.getUsedRange()).load(["columnIndex","columnCount","rowCount"]),e.n=50,o.sync();case 50:if(!(mt.columnCount>1)){e.n=53;break}return wt=yt.getRangeByIndexes(1,1,1,mt.columnCount-1),bt=yt.getRangeByIndexes(2,0,mt.rowCount-2,1),wt.load("values"),bt.load("values"),e.n=51,o.sync();case 51:return console.log("Dates in History:",bt.values),Rt=wt.values[0],kt=m(new Date),Ct=Rt.indexOf(kt),At=bt.values.map(function(e){return e[0]}),Dt=C(At,vt[0][0]),console.log("Beginning Date Index:",Dt),console.log("Target Date:",vt[0][0]),console.log("Current Month Position:",Ct),e.n=52,o.sync();case 52:-1!==Ct?(yt.getRangeByIndexes(2+Dt,Ct+1,vt.length,1).values=vt.map(function(e){return[e[1]]}),yt.getRangeByIndexes(2+Dt,0,vt.length,1).values=vt.map(function(e){return[e[0]]})):(yt.getRangeByIndexes(1,mt.columnCount,1,1).numberFormat=[["@"]],yt.getRangeByIndexes(1,mt.columnCount,1,1).values=[[kt]],yt.getRangeByIndexes(2+Dt,mt.columnCount,vt.length,1).values=vt.map(function(e){return[e[1]]}),yt.getRangeByIndexes(2+Dt,0,vt.length,1).values=vt.map(function(e){return[e[0]]}));case 53:if(!($e.size>0)){e.n=63;break}e.p=54,(It=Array.from($e.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])});try{Et=o.workbook.worksheets.getItem("AutoReplenishAEDHistory")}catch(e){Et=o.workbook.worksheets.add("AutoReplenishAEDHistory")}if(Tt=Et.getUsedRange(),Mt=m(new Date),Tt){e.n=55;break}Et.getRange("A1").values=[["Report Dates"]],Et.getRange("A2").values=[["Replenish Dates"]],Ut=n(new Set(n(It.map(function(e){return e[0]})))).sort(),St=Ut.map(function(e){return[e]}),Et.getRange("A3:A"+(St.length+2)).values=St,Et.getRange("B2").numberFormat=[["@"]],Et.getRange("B2").values=[[Mt]],xt=Ut.map(function(e){return[$e.get(e)||0]}),Et.getRange("B3:B"+(xt.length+2)).values=xt,e.n=60;break;case 55:return Tt.load(["columnCount","rowCount"]),e.n=56,o.sync();case 56:return(Nt=Et.getRangeByIndexes(1,Tt.columnCount-1,1,1)).load("values"),e.n=57,o.sync();case 57:if(Nt.values[0][0]===Mt){e.n=59;break}return(Ft=Et.getRange("A3:A"+Tt.rowCount)).load("values"),e.n=58,o.sync();case 58:for(Bt=Ft.values.map(function(e){return e[0]}).filter(function(e){return e}),Kt=Tt.columnCount,Et.getRangeByIndexes(1,Kt,1,1).numberFormat=[["@"]],Et.getRangeByIndexes(1,Kt,1,1).values=[[Mt]],Pt=0;Pt<Bt.length;Pt++)Ot=Bt[Pt],jt=$e.get(Ot)||0,Et.getRangeByIndexes(Pt+2,Kt,1,1).values=[[jt]];if(Lt=It.map(function(e){return a(e,1)[0]}).filter(function(e){return!Bt.includes(e)}).sort(),Lt.length>0)for(Gt=Bt.length+2,Et.getRangeByIndexes(Gt,0,Lt.length,1).values=Lt.map(function(e){return[e]}),Yt=0;Yt<Lt.length;Yt++)_t=Lt[Yt],Ht=$e.get(_t)||0,Et.getRangeByIndexes(Gt+Yt,Kt,1,1).values=[[Ht]];console.log("New column added to AED AutoReplenishHistory for date:",Mt),e.n=60;break;case 59:console.log("No new column added - same date as last run:",Mt);case 60:return e.n=61,o.sync();case 61:console.log("AED AutoReplenishHistory updated successfully"),e.n=63;break;case 62:e.p=62,zt=e.v,console.log("Error creating/updating AutoReplenishAEDHistory:",zt);case 63:return e.n=64,o.sync();case 64:return e.a(2,o.sync())}},t,null,[[54,62],[45,47],[41,43],[31,38,39,40],[19,26,27,28],[13,15],[3,7]])}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error(o);case 3:return t.a(2)}},t,null,[[0,2]])})),c.apply(this,arguments)}function f(e){var t=new Map,n=R(),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1));return e.forEach(function(e){var n=a(e,3),o=n[0],s=(n[1],n[2]),u=d(o);if(u>=r){var i="".concat(u.getUTCFullYear(),"-").concat(String(u.getUTCMonth()+1).padStart(2,"0"));t.set(i,s)}}),t}function g(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2023-06",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=new Map,o=a(e.split("-").map(Number),2),s=o[0],u=o[1],i=new Date(Date.UTC(s,u-1,1)),l=0;l<t;l++){var c=i.getUTCFullYear(),f=String(i.getUTCMonth()+1).padStart(2,"0"),g="".concat(c,"-").concat(f),p=n.get(g)||0;r.set(g,p),i.setUTCMonth(i.getUTCMonth()+1)}return r}function p(e,t){var n,a=new Map,o=r(t);try{var s=function(){var t=n.value,r=parseFloat(t[4]);t.slice(6).forEach(function(t){e.has(t)&&(e.set(t,e.get(t)+r),a.set(t,null!=a.get(t)?a.get(t)+r:r))})};for(o.s();!(n=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}return a}function h(e,t){var n=new Map;return t.forEach(function(t){var r=a(t,6),o=(r[0],r[1],r[2],r[3]),s=r[4];if("Enabled"===r[5]){var u="string"==typeof s?parseFloat(s.replace("$","")):s,i=k(o);if(i){var l="".concat(i.getUTCFullYear(),"-").concat(String(i.getUTCMonth()+1).padStart(2,"0"));e.has(l)&&(isNaN(u)||(e.set(l,e.get(l)+u),n.set(l,void 0!==n.get(l)?n.get(l)+u:u)))}}}),n}function d(e){if(!e||isNaN(e))return new Date(NaN);var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}function v(e){var t,n,r=R(),o=r.getUTCFullYear(),s=r.getUTCMonth()+1;if(e instanceof Date)t=e.getUTCFullYear(),n=e.getUTCMonth()+1;else{if("string"!=typeof e)return!1;var u=a(e.split("-").map(Number),2);t=u[0],n=u[1]}return o>t||o===t&&s>n}function y(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function m(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function w(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function b(e,t){var n=new Date(e);return n.setUTCDate(n.getUTCDate()+t),n}function R(){var e=new Date;return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1))}function k(e){if(!e||"N/A"===e)return new Date(NaN);try{if(/^\d{4}-\d{2}$/.test(e)){var t=a(e.split("-").map(Number),2),n=t[0],r=t[1];return new Date(Date.UTC(n,r-1,1))}var o=new Date(e);return isNaN(o.getTime())?new Date(NaN):new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),1))}catch(e){return new Date(NaN)}}function C(e,t){for(var n=A(t),r=0;r<e.length;r++){var a=A(e[r]);if(n.getTime()===a.getTime())return r}return console.warn("Target date not found in history, using index 0"),0}function A(e){var t=e.split("-"),n=parseInt(t[0]),r=parseInt(t[1]);return new Date(Date.UTC(n,r-1,1))}Office.onReady(function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=l)})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map