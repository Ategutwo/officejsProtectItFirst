/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"8d768f65702f2137206f.css"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function l(e,a,o,s){var l=a&&a.prototype instanceof c?a:c,i=Object.create(l.prototype);return t(i,"_invoke",function(e,t,a){var o,s,l,c=0,i=a||[],g=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return o=e,s=0,l=n,f.n=t,u}};function p(e,t){for(s=e,l=t,r=0;!g&&c&&!a&&r<i.length;r++){var a,o=i[r],p=f.p,d=o[2];e>3?(a=d===t)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=n):o[0]<=p&&((a=e<2&&p<o[1])?(s=0,f.v=t,f.n=o[1]):p<d&&(a=e<3||o[0]>t||t>d)&&(o[4]=e,o[5]=t,f.n=d,s=0))}if(a||e>1)return u;throw g=!0,t}return function(a,i,d){if(c>1)throw TypeError("Generator is already running");for(g&&1===i&&p(i,d),s=i,l=d;(r=s<2?n:l)||!g;){o||(s?s<3?(s>1&&(f.n=-1),p(s,l)):f.n=l:f.v=l);try{if(c=2,o){if(s||(a="next"),r=o[a]){if(!(r=r.call(o,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,s<2&&(s=0)}else 1===s&&(r=o.return)&&r.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=n}else if((r=(g=f.n<0)?l:e.call(t,f))!==u)break}catch(e){o=n,s=1,l=e}finally{c=1}}return{value:r,done:g}}}(e,o,s),!0),i}var u={};function c(){}function i(){}function g(){}r=Object.getPrototypeOf;var f=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),p=g.prototype=c.prototype=Object.create(f);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,t(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return i.prototype=g,t(p,"constructor",g),t(g,"constructor",i),i.displayName="GeneratorFunction",t(g,s,"GeneratorFunction"),t(p),t(p,s,"Generator"),t(p,o,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:d}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},t(e,n,r,a)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){u=!0,s=e},f:function(){try{l||null==n.return||n.return()}finally{if(u)throw s}}}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,s,l=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return l}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,a,o,s){try{var l=e[o](s),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){l(o,r,a,s,u,"next",e)}function u(e){l(o,r,a,s,u,"throw",e)}s(void 0)})}}function c(){return i.apply(this,arguments)}function i(){return i=u(e().m(function t(){var o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=u(e().m(function t(o){var s,l,u,c,i,A,D,T,E,I,M,U,N,S,x,F,K,B,P,L,O,j,Y,G,_,H,$,X,z,J,V,q,Q,W,Z,ee,te,ne,re,ae,oe,se,le,ue,ce,ie,ge,fe,pe,de,he,ve,ye,me,we,be,ke,Re,Ce,Ae,De,Te,Ee,Ie,Me,Ue,Ne,Se,xe,Fe,Ke,Be,Pe,Le,Oe,je,Ye,Ge,_e,He,$e,Xe,ze,Je,Ve,qe,Qe,We,Ze,et,tt,nt,rt,at,ot,st,lt,ut,ct,it,gt,ft,pt,dt,ht,vt,yt,mt,wt,bt,kt,Rt,Ct,At,Dt,Tt,Et,It,Mt,Ut,Nt,St,xt,Ft,Kt,Bt,Pt,Lt,Ot,jt,Yt,Gt,_t,Ht,$t,Xt,zt,Jt,Vt,qt,Qt,Wt,Zt,en,tn,nn,rn,an,on,sn,ln,un,cn,gn,fn,pn,dn,hn,vn,yn,mn,wn,bn,kn,Rn,Cn,An,Dn,Tn,En,In,Mn,Un,Nn,Sn,xn,Fn,Kn,Bn,Pn;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=o.workbook.worksheets.getItem("DrugDetails"),l=o.workbook.worksheets.getItem("packageDistribution"),u=l.getRange("A2:D7"),c=s.getUsedRange().getLastRow(),o.workbook.worksheets.getItem("AutoReplenishHistory"),i=o.workbook.worksheets.getItem("Drug Replenish Dates(New Kits)"),A=o.workbook.worksheets.getItem("auto_replenish_med_groups"),D=o.workbook.worksheets.getItem("Revenue Prediction"),T=o.workbook.worksheets.getItem("AED_Details(main)"),(E=T.getUsedRange()).load(["rowIndex","rowCount"]),e.n=1,o.sync();case 1:return I=E.rowIndex,(M=T.getRange("A2:I".concat(I+1))).load("values"),e.n=2,o.sync();case 2:return U={},M.values.forEach(function(e){e[1]&&""!==e[1].toString().trim()&&(U[e[1].trim()]={itemName:e[1],units:e[2],unitCost:e[3],totalUnitCost:e[4],laCarte:e[5],shelfLife:e[8],basePrice:e[5]})}),console.log("AED Items loaded:",Object.keys(U)),N=new Map,e.p=3,S=o.workbook.worksheets.getItem("Yearly Med Increase"),(x=S.getUsedRange()).load("rowCount"),e.n=4,o.sync();case 4:if(!(x.rowCount>1)){e.n=6;break}return(F=S.getRange("A2:B".concat(x.rowCount))).load("values"),e.n=5,o.sync();case 5:F.values.forEach(function(e){if(e[0]&&null!==e[1]&&""!==e[1]&&!isNaN(e[1])){var t=y(h(e[0]));N.set(t,parseFloat(e[1]))}}),console.log("Monthly increase data loaded:",N);case 6:e.n=8;break;case 7:e.p=7,e.v,console.log("Yearly Med Increase sheet not found or error reading data, using no increases");case 8:return D.getRangeByIndexes(1,0,1e4,15).clear(Excel.ClearApplyTo.contents),i.getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),c.load("rowIndex"),e.n=9,o.sync();case 9:return K=c.rowIndex,(B=s.getRange("B".concat(1,":O",K+1))).load("values"),u.load("values"),e.n=10,o.sync();case 10:return P=u.values,L={},O={},console.log(B.values),B.values.forEach(function(e){L[e[0]]={totalUnitCost:e[3],laCarte:e[4],includedInPackages:[],shelfLife:e[7],basePrice:e[4]};for(var t=8;t<=13;t++)e[t]&&""!==e[t].toString().trim()&&L[e[0]].includedInPackages.push(B.values[0][t])}),P.forEach(function(e){O[e[0]]={retailPrice:e[1],newKitShares:e[2],purchasePrice:e[3],drugs:[],baseRetailPrice:e[1]}}),j=o.workbook.worksheets.getItem("New Kit Data"),(Y=j.getUsedRange().getLastRow()).load("rowIndex"),e.n=11,o.sync();case 11:return G=Y.rowIndex,(_=j.getRange("A2:B".concat(G+1))).load("values"),e.n=12,o.sync();case 12:return H=_.values,$={},X=0,e.p=13,(z=j.getRange("L2")).load("values"),e.n=14,o.sync();case 14:null===z.values[0][0]||""===z.values[0][0]||isNaN(z.values[0][0])||(X=parseFloat(z.values[0][0]),console.log("Using discount percentage:",X)),e.n=16;break;case 15:e.p=15,e.v,console.log("Error reading discount from L2, using 0% discount");case 16:return J=function(e,t,n){if(0===n.size)return e;var a=new Date,o=y(t);if(t<a)return e;var s,l=1,u=r(Array.from(n.keys()).sort());try{for(u.s();!(s=u.n()).done;){var c=s.value;c<=o&&(l*=1+n.get(c))}}catch(e){u.e(e)}finally{u.f()}return e*l},V=H.map(function(e){var t=y(h(e[0]));v(t)||($[t]=e[1]);var n=e[1],r=h(e[0]),a=J(O.EMK1.baseRetailPrice,r,N),o=J(O.EMK5.baseRetailPrice,r,N),s=J(O.EMK10.baseRetailPrice,r,N),l=J(O.EMK15.baseRetailPrice,r,N),u=J(O["EMK1-Mini"].baseRetailPrice,r,N),c=J(O["EMK10-Mini"].baseRetailPrice,r,N),i=Math.floor(O.EMK1.newKitShares*n)*a,g=Math.floor(O.EMK5.newKitShares*n)*o,f=Math.floor(O.EMK10.newKitShares*n)*s,p=Math.floor(O.EMK15.newKitShares*n)*l,d=Math.floor(O["EMK1-Mini"].newKitShares*n)*u,m=Math.floor(O["EMK10-Mini"].newKitShares*n)*c,w=(i+g+f+p+d+m)*(1-X),b=i*(1-X),k=g*(1-X),R=f*(1-X),C=p*(1-X),A=d*(1-X),D=m*(1-X);return[e[0],e[1],w,"",b,k,R,C,A,D]}),j.getRange("A2:J"+(V.length+1)).values=V,B.values.forEach(function(e){"X"===e[8]&&O.EMK1.drugs.push(e[0]),"X"===e[9]&&O.EMK5.drugs.push(e[0]),"X"===e[10]&&O.EMK10.drugs.push(e[0]),"X"===e[11]&&O.EMK15.drugs.push(e[0]),"X"===e[12]&&O["EMK1-Mini"].drugs.push(e[0]),"X"===e[13]&&O["EMK10-Mini"].drugs.push(e[0])}),q=new Map,Q=[],(W=o.workbook.worksheets.getItem("Replenish Dates(TakoverKits)")).getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),e.n=17,o.sync();case 17:return e.p=17,Z=o.workbook.worksheets.getItem("TakeOverDrugDetails"),(ee=Z.getUsedRange()).load(["rowIndex","rowCount"]),e.n=18,o.sync();case 18:return te=ee.rowCount,(ne=Z.getRange("A2:C".concat(te+1))).load("values"),e.n=19,o.sync();case 19:return console.log("Takeover Drug Details rows: ".concat(ne.values.length)),console.log("Takeover Drug Details sample:",ne.values.slice(0,5)),re={},ae=0,ne.values.forEach(function(e,t){if(e[0]&&""!==e[0].toString().trim()){var n=e[0].toString().trim(),r=e[1]?e[1].toString().trim():"",a=e[2]&&!isNaN(e[2])?parseInt(e[2]):0;if(r){re[r]||(re[r]=[]);var o=L[n]?L[n].laCarte:0,s=L[n]?L[n].shelfLife:0;o>0&&a>0?(re[r].push({drugName:n,daysToFirstReplenishment:a,price:o,shelfLife:s}),ae++):console.log("Skipping drug ".concat(n," - price: ").concat(o,", days: ").concat(a))}}}),console.log("Loaded ".concat(ae," valid takeover drugs across kits:"),Object.keys(re)),Object.keys(re).forEach(function(e){console.log("  ".concat(e,": ").concat(re[e].length," drugs"))}),oe=o.workbook.worksheets.getItem("New Takover Kit Data"),(se=oe.getUsedRange()).load(["rowIndex","rowCount","columnCount"]),e.n=20,o.sync();case 20:return le=se.rowCount,(ue=oe.getRange("A2:G".concat(le+1))).load("values"),e.n=21,o.sync();case 21:if(console.log("Takeover Kit Data rows: ".concat(ue.values.length)),console.log("Takeover Kit Data sample:",ue.values.slice(0,3)),ce={1:"EMK1",2:"EMK5",3:"EMK10",4:"EMK15",5:"EMK1-Mini",6:"EMK10-Mini"},ie=0,ge={},ue.values.forEach(function(e,t){var n=h(e[0]),r=y(n);console.log("\nProcessing month: ".concat(r)),ge[r]={kits:0,drugs:0,revenue:0};for(var a=function(){var t=ce[o],a=e[o]&&!isNaN(e[o])?parseInt(e[o]):0;console.log("  ".concat(t,": ").concat(a," takeovers")),a>0&&re[t]&&(ge[r].kits+=a,re[t].forEach(function(e){if(e.price&&!isNaN(e.price)&&e.daysToFirstReplenishment>0&&e.shelfLife&&!isNaN(e.shelfLife)){var o=e.price*a;ie++,ge[r].drugs++,ge[r].revenue+=o;var s=new Date(n);s.setUTCDate(s.getUTCDate()+e.daysToFirstReplenishment);var l=y(s);console.log("    ".concat(e.drugName,": ").concat(a," Ã— $").concat(e.price," = $").concat(o,", first replenish: ").concat(l));for(var u=[],c=0;c<10;c++){var i=new Date(s);i.setUTCDate(i.getUTCDate()+e.shelfLife*c);var g=i.getUTCFullYear(),f=String(i.getUTCMonth()+1).padStart(2,"0"),p="".concat(g,"-").concat(f);u.push(p);var d=q.get(p)||0;q.set(p,d+o)}Q.push([r,t+" (Takeover)",e.drugName,a,o,e.shelfLife,e.daysToFirstReplenishment].concat(u))}}))},o=1;o<=6;o++)a()}),console.log("\n=== TAKEOVER PROCESSING SUMMARY ==="),console.log("Total drug entries processed: ".concat(ie)),console.log("Monthly breakdown:",ge),console.log("Takeover Revenue Map entries: ".concat(q.size)),console.log("Takeover Revenue Map sample:",Array.from(q.entries()).slice(0,10)),console.log("Takeover Drug Predictions count: ".concat(Q.length)),!(Q.length>0)){e.n=24;break}if(fe=W.getUsedRange(),pe=1,!fe){e.n=23;break}return fe.load("rowCount"),e.n=22,o.sync();case 22:pe=fe.rowCount;case 23:console.log("Adding ".concat(Q.length," takeover predictions starting at row ").concat(pe)),W.getRangeByIndexes(pe,0,Q.length,Q[0].length).values=Q,e.n=25;break;case 24:console.log("No takeover predictions to add!");case 25:e.n=27;break;case 26:e.p=26,xn=e.v,console.log("Error processing takeover kit data:",xn);case 27:return de=[],Object.keys($).forEach(function(e){var t=$[e];Object.keys(O).forEach(function(n){var r=Math.floor(t*O[n].newKitShares);r<1||O[n].drugs.forEach(function(t){if(""!=L[t].shelfLife&&"N/A"!=L[t].shelfLife){var a=R(e),o=J(L[t].basePrice,a,N);de.push([e,n,t,r,o*r,L[t].shelfLife])}})})}),he=de.map(function(e){for(var t=a(e,6),r=t[0],o=(t[1],t[2],t[3],t[4],t[5]),s=a(r.split("-").map(Number),2),l=s[0],u=s[1],c=new Date(Date.UTC(l,u-1,1)),i=[],g=1;g<=10;g++){var f=new Date(c);f.setUTCDate(f.getUTCDate()+o*g);var p=f.getUTCFullYear(),d=String(f.getUTCMonth()+1).padStart(2,"0");i.push("".concat(p,"-").concat(d))}return[].concat(n(e),i)}),i.getRangeByIndexes(1,0,he.length,he[0].length).values=he,ve=g(V),ye=f("2025-07",300,ve),me=p(ye,he),we=A.getUsedRange(),(be=we.getLastRow()).load("rowIndex"),e.n=28,o.sync();case 28:return(ke=A.getRangeByIndexes(2,0,be.rowIndex-1,6)).load("values"),e.n=29,o.sync();case 29:Re=[["Group","Company","Medication","Expiration","Price","Auto Replenish","Generated Dates"]],Ce=r(ke.values),e.p=30,Ce.s();case 31:if((Ae=Ce.n()).done){e.n=36;break}if(De=Ae.value,Te=a(De,6),Ee=Te[0],Ie=Te[1],Me=Te[2],Ue=Te[3],Ne=Te[4],"Enabled"===(Se=Te[5])&&"N/A"!=Ue&&""!=Ue){e.n=32;break}return e.a(3,35);case 32:if(xe=L[Me],Fe=h(Ue),Ke=Fe?J(Ne,Fe,N):Ne,Re.push([Ee,Ie,Me,Fe?w(Fe):"N/A",Ke,Se,""]),xe&&Fe&&xe.shelfLife&&""!==xe.shelfLife&&"N/A"!==xe.shelfLife&&!isNaN(xe.shelfLife)){e.n=33;break}return e.a(3,35);case 33:if(!((Be=parseInt(xe.shelfLife))<=0)){e.n=34;break}return e.a(3,35);case 34:for(Pe=1;Pe<=20;Pe++)Le=b(Fe,Be*Pe),Oe=J(Ne,Le,N),Re.push([Ee,Ie,Me,w(Le),parseFloat(Oe.toFixed(2)),Se,"Generated"]);case 35:e.n=31;break;case 36:e.n=38;break;case 37:e.p=37,Fn=e.v,Ce.e(Fn);case 38:return e.p=38,Ce.f(),e.f(38);case 39:return je=o.workbook.worksheets.getItem("auto_replenish_aed_groups"),Ye=je.getUsedRange(),(Ge=Ye.getLastRow()).load("rowIndex"),e.n=40,o.sync();case 40:return(_e=je.getRangeByIndexes(2,0,Ge.rowIndex-1,6)).load("values"),e.n=41,o.sync();case 41:console.log("AED Auto Replenish data:",_e.values),He=[["Group","Company","AED Item","Expiration","Price","Auto Replenish","Generated Dates"]],$e=r(_e.values),e.p=42,$e.s();case 43:if((Xe=$e.n()).done){e.n=48;break}if(ze=Xe.value,Je=a(ze,6),Ve=Je[0],qe=Je[1],Qe=Je[2],We=Je[3],Ze=Je[4],"Enabled"===(et=Je[5])){e.n=44;break}return e.a(3,47);case 44:if(tt=Qe?Qe.toString().trim():"",nt=U[tt],rt=We&&"N/A"!==We&&""!==We?h(We):null,at=rt?J(Ze,rt,N):Ze,He.push([Ve,qe,tt,rt?w(rt):"N/A",at,et,""]),rt&&nt&&nt.shelfLife&&""!==nt.shelfLife&&"N/A"!==nt.shelfLife&&!isNaN(nt.shelfLife)){e.n=45;break}return e.a(3,47);case 45:if(!((ot=parseInt(nt.shelfLife))<=0)){e.n=46;break}return e.a(3,47);case 46:for(st=1;st<=20;st++)lt=b(rt,ot*st),ut=J(Ze,lt,N),He.push([Ve,qe,tt,w(lt),parseFloat(ut.toFixed(2)),et,"Generated"]);case 47:e.n=43;break;case 48:e.n=50;break;case 49:e.p=49,Kn=e.v,$e.e(Kn);case 50:return e.p=50,$e.f(),e.f(50);case 51:return console.log("AED Auto Replenish processed items:",He.length),ct=d(ye,Re),it=d(ye,He),console.log("Regular Auto Replenish:",ct),console.log("AED Auto Replenish:",it),gt=new Set([].concat(n(me.keys()),n(ct.keys()),n(it.keys()),n(ve.keys()),n(ye.keys()),n(q.keys()))),ft=[],pt=k(),dt=w(pt),vt=.25,e.p=52,ht=o.workbook.worksheets.getItem("Non-Auto Replenish"),yt=ht.getRange("G2"),mt=ht.getRange("H2"),yt.load("values"),mt.load("values"),e.n=53,o.sync();case 53:null===mt.values[0][0]||""===mt.values[0][0]||isNaN(mt.values[0][0])?null===yt.values[0][0]||""===yt.values[0][0]||isNaN(yt.values[0][0])||(vt=parseFloat(yt.values[0][0])):vt=parseFloat(mt.values[0][0]),console.log("Using Non-Auto Replenishment percentage:",vt),e.n=55;break;case 54:e.p=54,e.v,console.log("Non-Auto Replenish sheet not found or error reading values, using default 25%");case 55:return wt=0,e.p=56,bt=o.workbook.worksheets.getItem("AED Sales"),(kt=bt.getRange("G2")).load("values"),e.n=57,o.sync();case 57:null===kt.values[0][0]||""===kt.values[0][0]||isNaN(kt.values[0][0])||(wt=parseFloat(kt.values[0][0])),console.log("Using AED Sales value:",wt),e.n=59;break;case 58:e.p=58,e.v,console.log("AED Sales sheet not found or error reading G2 value, using 0");case 59:Rt=n(gt).sort(),Ct=r(Rt);try{for(Ct.s();!(At=Ct.n()).done;)Dt=At.value,Tt=ve.get(Dt)||0,Et=ct.get(Dt)||0,It=it.get(Dt)||0,Mt=me.get(Dt)||0,Ut=q.get(Dt)||0,xt=Tt+Et+It+Mt+(Nt=Dt>dt?Et*vt:0)+(St=Dt>dt?wt:0)+Ut,ft.push([Dt,xt,Tt,Et,Mt,Nt,St,It,Ut])}catch(e){Ct.e(e)}finally{Ct.f()}return D.getRangeByIndexes(1,0,ft.length,ft[0].length).values=ft,Ft=["Month","Total Revenue","New Kit Revenue","Auto Replenish","Drug Data Revenue","Non-Auto Replenishment","AED Sales","AED Auto Replenish","New Takeover Kit Revenue"],D.getRangeByIndexes(0,0,1,Ft.length).values=[Ft],e.n=60,o.sync();case 60:return console.log("Final Revenue Forecast:",ft),console.table(ft),(Kt=Array.from(ct.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])}),Bt=o.workbook.worksheets.getItem("AutoReplenishHistory"),(Pt=Bt.getUsedRange()).load(["columnIndex","columnCount","rowCount"]),e.n=61,o.sync();case 61:if(!(Pt.columnCount>1)){e.n=64;break}return Lt=Bt.getRangeByIndexes(1,1,1,Pt.columnCount-1),Ot=Bt.getRangeByIndexes(2,0,Pt.rowCount-2,1),Lt.load("values"),Ot.load("values"),e.n=62,o.sync();case 62:return console.log("Dates in History:",Ot.values),jt=Lt.values[0],Yt=m(new Date),Gt=jt.indexOf(Yt),_t=Ot.values.map(function(e){return e[0]}),Ht=C(_t,Kt[0][0]),console.log("Beginning Date Index:",Ht),console.log("Target Date:",Kt[0][0]),console.log("Current Month Position:",Gt),e.n=63,o.sync();case 63:-1!==Gt?(Bt.getRangeByIndexes(2+Ht,Gt+1,Kt.length,1).values=Kt.map(function(e){return[e[1]]}),Bt.getRangeByIndexes(2+Ht,0,Kt.length,1).values=Kt.map(function(e){return[e[0]]})):(Bt.getRangeByIndexes(1,Pt.columnCount,1,1).numberFormat=[["@"]],Bt.getRangeByIndexes(1,Pt.columnCount,1,1).values=[[Yt]],Bt.getRangeByIndexes(2+Ht,Pt.columnCount,Kt.length,1).values=Kt.map(function(e){return[e[1]]}),Bt.getRangeByIndexes(2+Ht,0,Kt.length,1).values=Kt.map(function(e){return[e[0]]}));case 64:if(!(it.size>0)){e.n=74;break}e.p=65,($t=Array.from(it.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])});try{Xt=o.workbook.worksheets.getItem("AutoReplenishAEDHistory")}catch(e){Xt=o.workbook.worksheets.add("AutoReplenishAEDHistory")}if(zt=Xt.getUsedRange(),Jt=m(new Date),zt){e.n=66;break}Xt.getRange("A1").values=[["Report Dates"]],Xt.getRange("A2").values=[["Replenish Dates"]],Vt=n(new Set(n($t.map(function(e){return e[0]})))).sort(),qt=Vt.map(function(e){return[e]}),Xt.getRange("A3:A"+(qt.length+2)).values=qt,Xt.getRange("B2").numberFormat=[["@"]],Xt.getRange("B2").values=[[Jt]],console.log("Hello Alvin"),Qt=Vt.map(function(e){return[it.get(e)||0]}),Xt.getRange("B3:B"+(Qt.length+2)).values=Qt,e.n=71;break;case 66:return zt.load(["columnCount","rowCount"]),e.n=67,o.sync();case 67:return(Wt=Xt.getRangeByIndexes(1,zt.columnCount-1,1,1)).load("values"),e.n=68,o.sync();case 68:if(Wt.values[0][0]===Jt){e.n=70;break}return(Zt=Xt.getRange("A3:A"+zt.rowCount)).load("values"),e.n=69,o.sync();case 69:for(en=Zt.values.map(function(e){return e[0]}).filter(function(e){return e}),tn=zt.columnCount,Xt.getRangeByIndexes(1,tn,1,1).numberFormat=[["@"]],Xt.getRangeByIndexes(1,tn,1,1).values=[[Jt]],nn=0;nn<en.length;nn++)rn=en[nn],an=it.get(rn)||0,Xt.getRangeByIndexes(nn+2,tn,1,1).values=[[an]];if(on=$t.map(function(e){return a(e,1)[0]}).filter(function(e){return!en.includes(e)}).sort(),on.length>0)for(sn=en.length+2,Xt.getRangeByIndexes(sn,0,on.length,1).values=on.map(function(e){return[e]}),ln=0;ln<on.length;ln++)un=on[ln],cn=it.get(un)||0,Xt.getRangeByIndexes(sn+ln,tn,1,1).values=[[cn]];console.log("New column added to AED AutoReplenishHistory for date:",Jt),e.n=71;break;case 70:console.log("No new column added - same date as last run:",Jt);case 71:return e.n=72,o.sync();case 72:console.log("AED AutoReplenishHistory updated successfully"),e.n=74;break;case 73:e.p=73,Bn=e.v,console.log("Error creating/updating AutoReplenishAEDHistory:",Bn);case 74:e.p=74;try{(gn=o.workbook.worksheets.getItem("Yearly Revenue")).getUsedRange().clear(Excel.ClearApplyTo.contents)}catch(e){gn=o.workbook.worksheets.add("Yearly Revenue")}return(fn=D.getUsedRange()).load("values"),e.n=75,o.sync();case 75:pn=fn.values,dn=new Map,hn=1;case 76:if(!(hn<pn.length)){e.n=79;break}if((vn=pn[hn])&&!(vn.length<9)){e.n=77;break}return e.a(3,78);case 77:yn=a(vn,9),mn=yn[0],wn=yn[1],bn=yn[2],kn=yn[3],Rn=yn[4],Cn=yn[5],An=yn[6],Dn=yn[7],Tn=yn[8],En=mn.split("-")[0],dn.has(En)||dn.set(En,{total:0,newKit:0,autoReplenish:0,drugData:0,nonAuto:0,aedSales:0,aedAuto:0,takeover:0}),(In=dn.get(En)).total+=parseFloat(wn)||0,In.newKit+=parseFloat(bn)||0,In.autoReplenish+=parseFloat(kn)||0,In.drugData+=parseFloat(Rn)||0,In.nonAuto+=parseFloat(Cn)||0,In.aedSales+=parseFloat(An)||0,In.aedAuto+=parseFloat(Dn)||0,In.takeover+=parseFloat(Tn)||0;case 78:hn++,e.n=76;break;case 79:Mn=Array.from(dn.entries()).map(function(e){var t=a(e,2),n=t[0],r=t[1];return[n,r.total,r.newKit,r.autoReplenish,r.drugData,r.nonAuto,r.aedSales,r.aedAuto,r.takeover]}).sort(function(e,t){return e[0].localeCompare(t[0])}),Nn=[Un=["Year","Total Revenue","New Kit Revenue","Auto Replenish","Drug Data Revenue","Non-Auto Replenishment","AED Sales","AED Auto Replenish","New Takeover Kit Revenue"]].concat(n(Mn)),gn.getRangeByIndexes(0,0,Nn.length,Un.length).values=Nn,(Sn=gn.getRangeByIndexes(0,0,1,Un.length)).format.fill.color="#4472C4",Sn.format.font.color="white",Sn.format.font.bold=!0,Nn.length>1&&(gn.getRangeByIndexes(1,1,Nn.length-1,Un.length-1).numberFormat=[["$#,##0.00"]]),gn.getUsedRange().format.autofitColumns(),console.log("Yearly Revenue summary created successfully"),console.table(Mn),e.n=81;break;case 80:e.p=80,Pn=e.v,console.log("Error creating Yearly Revenue summary:",Pn);case 81:return e.n=82,o.sync();case 82:return e.a(2,o.sync())}},t,null,[[74,80],[65,73],[56,58],[52,54],[42,49,50,51],[30,37,38,39],[17,26],[13,15],[3,7]])}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error(o);case 3:return t.a(2)}},t,null,[[0,2]])})),i.apply(this,arguments)}function g(e){var t=new Map,n=k(),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1));return e.forEach(function(e){var n=a(e,3),o=n[0],s=(n[1],n[2]),l=h(o);if(l>=r){var u="".concat(l.getUTCFullYear(),"-").concat(String(l.getUTCMonth()+1).padStart(2,"0"));t.set(u,s)}}),t}function f(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2023-06",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=new Map,o=a(e.split("-").map(Number),2),s=o[0],l=o[1],u=new Date(Date.UTC(s,l-1,1)),c=0;c<t;c++){var i=u.getUTCFullYear(),g=String(u.getUTCMonth()+1).padStart(2,"0"),f="".concat(i,"-").concat(g),p=n.get(f)||0;r.set(f,p),u.setUTCMonth(u.getUTCMonth()+1)}return r}function p(e,t){var n,a=new Map,o=r(t);try{var s=function(){var t=n.value,r=parseFloat(t[4]);t.slice(6).forEach(function(t){e.has(t)&&(e.set(t,e.get(t)+r),a.set(t,null!=a.get(t)?a.get(t)+r:r))})};for(o.s();!(n=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}return a}function d(e,t){var n=new Map;return t.forEach(function(t){var r=a(t,6),o=(r[0],r[1],r[2],r[3]),s=r[4];if("Enabled"===r[5]){var l="string"==typeof s?parseFloat(s.replace("$","")):s,u=R(o);if(u){var c="".concat(u.getUTCFullYear(),"-").concat(String(u.getUTCMonth()+1).padStart(2,"0"));e.has(c)&&(isNaN(l)||(e.set(c,e.get(c)+l),n.set(c,void 0!==n.get(c)?n.get(c)+l:l)))}}}),n}function h(e){if(!e||isNaN(e))return new Date(NaN);var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}function v(e){var t,n,r=k(),o=r.getUTCFullYear(),s=r.getUTCMonth()+1;if(e instanceof Date)t=e.getUTCFullYear(),n=e.getUTCMonth()+1;else{if("string"!=typeof e)return!1;var l=a(e.split("-").map(Number),2);t=l[0],n=l[1]}return o>t||o===t&&s>n}function y(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function m(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function w(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function b(e,t){var n=new Date(e);return n.setUTCDate(n.getUTCDate()+t),n}function k(){var e=new Date;return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1))}function R(e){if(!e||"N/A"===e)return new Date(NaN);try{if(/^\d{4}-\d{2}$/.test(e)){var t=a(e.split("-").map(Number),2),n=t[0],r=t[1];return new Date(Date.UTC(n,r-1,1))}var o=new Date(e);return isNaN(o.getTime())?new Date(NaN):new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),1))}catch(e){return new Date(NaN)}}function C(e,t){for(var n=A(t),r=0;r<e.length;r++){var a=A(e[r]);if(n.getTime()===a.getTime())return r}return console.warn("Target date not found in history, using index 0"),0}function A(e){var t=e.split("-"),n=parseInt(t[0]),r=parseInt(t[1]);return new Date(Date.UTC(n,r-1,1))}Office.onReady(function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=c)})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map