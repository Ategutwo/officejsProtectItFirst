/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"8d768f65702f2137206f.css"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.toStringTag||"@@toStringTag";function s(e,a,o,u){var s=a&&a.prototype instanceof c?a:c,l=Object.create(s.prototype);return t(l,"_invoke",function(e,t,a){var o,u,s,c=0,l=a||[],f=!1,g={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return o=e,u=0,s=n,g.n=t,i}};function p(e,t){for(u=e,s=t,r=0;!f&&c&&!a&&r<l.length;r++){var a,o=l[r],p=g.p,h=o[2];e>3?(a=h===t)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=n):o[0]<=p&&((a=e<2&&p<o[1])?(u=0,g.v=t,g.n=o[1]):p<h&&(a=e<3||o[0]>t||t>h)&&(o[4]=e,o[5]=t,g.n=h,u=0))}if(a||e>1)return i;throw f=!0,t}return function(a,l,h){if(c>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),u=l,s=h;(r=u<2?n:s)||!f;){o||(u?u<3?(u>1&&(g.n=-1),p(u,s)):g.n=s:g.v=s);try{if(c=2,o){if(u||(a="next"),r=o[a]){if(!(r=r.call(o,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,u<2&&(u=0)}else 1===u&&(r=o.return)&&r.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=n}else if((r=(f=g.n<0)?s:e.call(t,g))!==i)break}catch(e){o=n,u=1,s=e}finally{c=1}}return{value:r,done:f}}}(e,o,u),!0),l}var i={};function c(){}function l(){}function f(){}r=Object.getPrototypeOf;var g=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),p=f.prototype=c.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,u,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,t(p,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,u,"GeneratorFunction"),t(p),t(p,u,"Generator"),t(p,o,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:s,m:h}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function u(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(u("next",0),u("throw",1),u("return",2))},t(e,n,r,a)}function n(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,u=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw u}}}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,s=[],i=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n,r,a,o,u){try{var s=e[o](u),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function u(e){s(o,r,a,u,i,"next",e)}function i(e){s(o,r,a,u,i,"throw",e)}u(void 0)})}}function c(){return l.apply(this,arguments)}function l(){return l=i(e().m(function t(){var o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=i(e().m(function t(o){var u,s,i,c,l,U,S,R,D,E,I,N,x,A,K,F,P,O,j,B,Y,G,L,_,X,$,H,z,J,q,Q,V,W,Z,ee,te,ne,re,ae,oe,ue,se,ie,ce,le,fe,ge,pe,he,ve,de,ye,we,be,me,Te,Ce,Me,ke,Ue,Se,Re,De,Ee,Ie,Ne,xe,Ae,Ke,Fe,Pe,Oe,je,Be,Ye,Ge,Le,_e,Xe,$e,He,ze,Je,qe;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return u=o.workbook.worksheets.getItem("DrugDetails"),s=o.workbook.worksheets.getItem("packageDistribution"),i=s.getRange("A2:D7"),c=u.getUsedRange().getLastRow(),o.workbook.worksheets.getItem("AutoReplenishHistory"),l=o.workbook.worksheets.getItem("Drug Replenish Dates(New Kits)"),U=o.workbook.worksheets.getItem("auto_replenish_med_groups"),S=o.workbook.worksheets.getItem("Revenue Prediction"),R=new Map,e.p=1,D=o.workbook.worksheets.getItem("Yearly Med Increase"),(E=D.getUsedRange()).load("rowCount"),e.n=2,o.sync();case 2:if(!(E.rowCount>1)){e.n=4;break}return(I=D.getRange("A2:B".concat(E.rowCount))).load("values"),e.n=3,o.sync();case 3:I.values.forEach(function(e){if(e[0]&&null!==e[1]&&""!==e[1]&&!isNaN(e[1])){var t=w(d(e[0]));R.set(t,parseFloat(e[1]))}}),console.log("Monthly increase data loaded:",R);case 4:e.n=6;break;case 5:e.p=5,e.v,console.log("Yearly Med Increase sheet not found or error reading data, using no increases");case 6:return S.getRangeByIndexes(1,0,1e4,10).clear(Excel.ClearApplyTo.contents),l.getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),c.load("rowIndex"),e.n=7,o.sync();case 7:return N=c.rowIndex,(x=u.getRange("B".concat(1,":O",N+1))).load("values"),i.load("values"),e.n=8,o.sync();case 8:return A=i.values,K={},F={},console.log(x.values),x.values.forEach(function(e){K[e[0]]={totalUnitCost:e[3],laCarte:e[4],includedInPackages:[],shelfLife:e[7],basePrice:e[4]};for(var t=8;t<=13;t++)""!==e[t].toString().trim()&&K[e[0]].includedInPackages.push(x.values[0][t])}),A.forEach(function(e){F[e[0]]={retailPrice:e[1],newKitShares:e[2],purchasePrice:e[3],drugs:[],baseRetailPrice:e[1]}}),console.log(K,"Meds Object"),P=o.workbook.worksheets.getItem("New Kit Data"),(O=P.getUsedRange().getLastRow()).load("rowIndex"),e.n=9,o.sync();case 9:return j=O.rowIndex,(B=P.getRange("A2:B".concat(j+1))).load("values"),e.n=10,o.sync();case 10:return Y=B.values,G={},L=0,e.p=11,(_=P.getRange("L2")).load("values"),e.n=12,o.sync();case 12:null===_.values[0][0]||""===_.values[0][0]||isNaN(_.values[0][0])||(L=parseFloat(_.values[0][0]),console.log("Using discount percentage:",L)),e.n=14;break;case 13:e.p=13,e.v,console.log("Error reading discount from L2, using 0% discount");case 14:return X=function(e,t,n){if(0===n.size)return e;var a=new Date,o=w(t);if(t<a)return e;var u,s=1,i=r(Array.from(n.keys()).sort());try{for(i.s();!(u=i.n()).done;){var c=u.value;c<=o&&(s*=1+n.get(c))}}catch(e){i.e(e)}finally{i.f()}return e*s},$=Y.map(function(e){var t=w(d(e[0]));y(t)||(G[t]=e[1]);var n=e[1],r=d(e[0]),a=X(F.EMK1.baseRetailPrice,r,R),o=X(F.EMK5.baseRetailPrice,r,R),u=X(F.EMK10.baseRetailPrice,r,R),s=X(F.EMK15.baseRetailPrice,r,R),i=X(F["EMK1-Mini"].baseRetailPrice,r,R),c=X(F["EMK10-Mini"].baseRetailPrice,r,R),l=Math.floor(F.EMK1.newKitShares*n)*a,f=Math.floor(F.EMK5.newKitShares*n)*o,g=Math.floor(F.EMK10.newKitShares*n)*u,p=Math.floor(F.EMK15.newKitShares*n)*s,h=Math.floor(F["EMK1-Mini"].newKitShares*n)*i,v=Math.floor(F["EMK10-Mini"].newKitShares*n)*c,b=(l+f+g+p+h+v)*(1-L),m=l*(1-L),T=f*(1-L),C=g*(1-L),M=p*(1-L),k=h*(1-L),U=v*(1-L);return[e[0],e[1],b,"",m,T,C,M,k,U]}),P.getRange("A2:J"+($.length+1)).values=$,x.values.forEach(function(e){"X"===e[8]&&F.EMK1.drugs.push(e[0]),"X"===e[9]&&F.EMK5.drugs.push(e[0]),"X"===e[10]&&F.EMK10.drugs.push(e[0]),"X"===e[11]&&F.EMK15.drugs.push(e[0]),"X"===e[12]&&F["EMK1-Mini"].drugs.push(e[0]),"X"===e[13]&&F["EMK10-Mini"].drugs.push(e[0])}),H=[],Object.keys(G).forEach(function(e){var t=G[e];Object.keys(F).forEach(function(n){var r=Math.floor(t*F[n].newKitShares);r<1||F[n].drugs.forEach(function(t){if(""!=K[t].shelfLife&&"N/A"!=K[t].shelfLife){var a=M(e),o=X(K[t].basePrice,a,R);H.push([e,n,t,r,o*r,K[t].shelfLife])}})})}),z=H.map(function(e){for(var t=a(e,6),r=t[0],o=(t[1],t[2],t[3],t[4],t[5]),u=a(r.split("-").map(Number),2),s=u[0],i=u[1],c=new Date(Date.UTC(s,i-1,1)),l=[],f=1;f<=10;f++){var g=new Date(c);g.setUTCDate(g.getUTCDate()+o*f);var p=g.getUTCFullYear(),h=String(g.getUTCMonth()+1).padStart(2,"0");l.push("".concat(p,"-").concat(h))}return[].concat(n(e),l)}),l.getRangeByIndexes(1,0,z.length,z[0].length).values=z,J=g($),q=p("2025-07",300,J),Q=h(q,z),V=U.getUsedRange(),(W=V.getLastRow()).load("rowIndex"),e.n=15,o.sync();case 15:return(Z=U.getRangeByIndexes(2,0,W.rowIndex-1,6)).load("values"),e.n=16,o.sync();case 16:ee=[["Group","Company","Medication","Expiration","Price","Auto Replenish","Generated Dates"]],te=r(Z.values),e.p=17,te.s();case 18:if((ne=te.n()).done){e.n=22;break}if(re=ne.value,ae=a(re,6),oe=ae[0],ue=ae[1],se=ae[2],ie=ae[3],ce=ae[4],"Enabled"===(le=ae[5])&&"N/A"!=ie&&""!=ie){e.n=19;break}return e.a(3,21);case 19:if(fe=K[se],ge=d(ie),pe=ge?X(ce,ge,R):ce,ee.push([oe,ue,se,ge?m(ge):"N/A",pe,le,""]),fe&&ge){e.n=20;break}return e.a(3,21);case 20:for(he=fe.shelfLife,ve=1;ve<=20;ve++)de=T(ge,he*ve),ye=X(ce,de,R),ee.push([oe,ue,se,m(de),parseFloat(ye.toFixed(2)),le,"Generated"]);case 21:e.n=18;break;case 22:e.n=24;break;case 23:e.p=23,qe=e.v,te.e(qe);case 24:return e.p=24,te.f(),e.f(24);case 25:return we=v(q,ee),console.log(Q,J,we),be=new Set([].concat(n(Q.keys()),n(we.keys()),n(J.keys()),n(q.keys()))),me=[],Te=C(),Ce=m(Te),ke=.25,e.p=26,Me=o.workbook.worksheets.getItem("Non-Auto Replenish"),Ue=Me.getRange("G2"),Se=Me.getRange("H2"),Ue.load("values"),Se.load("values"),e.n=27,o.sync();case 27:null===Se.values[0][0]||""===Se.values[0][0]||isNaN(Se.values[0][0])?null===Ue.values[0][0]||""===Ue.values[0][0]||isNaN(Ue.values[0][0])||(ke=parseFloat(Ue.values[0][0])):ke=parseFloat(Se.values[0][0]),console.log("Using Non-Auto Replenishment percentage:",ke),e.n=29;break;case 28:e.p=28,e.v,console.log("Non-Auto Replenish sheet not found or error reading values, using default 25%");case 29:return Re=0,e.p=30,De=o.workbook.worksheets.getItem("AED Sales"),(Ee=De.getRange("G2")).load("values"),e.n=31,o.sync();case 31:null===Ee.values[0][0]||""===Ee.values[0][0]||isNaN(Ee.values[0][0])||(Re=parseFloat(Ee.values[0][0])),console.log("Using AED Sales value:",Re),e.n=33;break;case 32:e.p=32,e.v,console.log("AED Sales sheet not found or error reading G2 value, using 0");case 33:Ie=r(n(be).sort());try{for(Ie.s();!(Ne=Ie.n()).done;)xe=Ne.value,Ae=J.get(xe)||0,Ke=we.get(xe)||0,Fe=Q.get(xe)||0,je=Ae+Ke+Fe+(Pe=xe>Ce?Ke*ke:0)+(Oe=xe>Ce?Re:0),me.push([xe,je,Ae,Ke,Fe,Pe,Oe])}catch(e){Ie.e(e)}finally{Ie.f()}return S.getRangeByIndexes(1,0,me.length,me[0].length).values=me,e.n=34,o.sync();case 34:return console.table(me),Be=f(me),Ye=o.workbook.worksheets.getItem("AutoReplenishHistory"),(Ge=Ye.getUsedRange()).load(["columnIndex","columnCount","rowCount"]),e.n=35,o.sync();case 35:if(!(Ge.columnCount<=1)){e.n=36;break}return e.a(2);case 36:return Le=Ye.getRangeByIndexes(1,1,1,Ge.columnCount-1),_e=Ye.getRangeByIndexes(2,0,Ge.rowCount-2,1),Le.load("values"),_e.load("values"),e.n=37,o.sync();case 37:return console.log("Dates in History:",_e.values),Xe=Le.values[0],$e=b(new Date),He=Xe.indexOf($e),ze=_e.values.map(function(e){return e[0]}),Je=k(ze,Be[0][0]),console.log("Beginning Date Index:",Je),console.log("Target Date:",Be[0][0]),console.log("Current Month Position:",He),e.n=38,o.sync();case 38:return-1!==He?(Ye.getRangeByIndexes(2+Je,He+1,Be.length,1).values=Be.map(function(e){return[e[1]]}),Ye.getRangeByIndexes(2+Je,0,Be.length,1).values=Be.map(function(e){return[e[0]]})):(Ye.getRangeByIndexes(1,Ge.columnCount,1,1).numberFormat=[["@"]],Ye.getRangeByIndexes(1,Ge.columnCount,1,1).values=[[$e]],Ye.getRangeByIndexes(2+Je,Ge.columnCount,Be.length,1).values=Be.map(function(e){return[e[1]]}),Ye.getRangeByIndexes(2+Je,0,Be.length,1).values=Be.map(function(e){return[e[0]]})),e.n=39,o.sync();case 39:return e.a(2,o.sync())}},t,null,[[30,32],[26,28],[17,23,24,25],[11,13],[1,5]])}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error(o);case 3:return t.a(2)}},t,null,[[0,2]])})),l.apply(this,arguments)}function f(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]]).map(function(e){return[e[0],e[3]]})}function g(e){var t=new Map,n=C(),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1));return e.forEach(function(e){var n=a(e,3),o=n[0],u=(n[1],n[2]),s=d(o);if(s>=r){var i="".concat(s.getUTCFullYear(),"-").concat(String(s.getUTCMonth()+1).padStart(2,"0"));t.set(i,u)}}),t}function p(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2023-06",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=new Map,o=a(e.split("-").map(Number),2),u=o[0],s=o[1],i=new Date(Date.UTC(u,s-1,1)),c=0;c<t;c++){var l=i.getUTCFullYear(),f=String(i.getUTCMonth()+1).padStart(2,"0"),g="".concat(l,"-").concat(f),p=n.get(g)||0;r.set(g,p),i.setUTCMonth(i.getUTCMonth()+1)}return r}function h(e,t){var n,a=new Map,o=r(t);try{var u=function(){var t=n.value,r=parseFloat(t[4]);t.slice(6).forEach(function(t){e.has(t)&&(e.set(t,e.get(t)+r),a.set(t,null!=a.get(t)?a.get(t)+r:r))})};for(o.s();!(n=o.n()).done;)u()}catch(e){o.e(e)}finally{o.f()}return a}function v(e,t){var n=new Map;return t.forEach(function(t){var r=a(t,6),o=(r[0],r[1],r[2],r[3]),u=r[4];if("Enabled"===r[5]){var s="string"==typeof u?parseFloat(u.replace("$","")):u,i=M(o);if(i){var c="".concat(i.getUTCFullYear(),"-").concat(String(i.getUTCMonth()+1).padStart(2,"0"));e.has(c)&&(isNaN(s)||(e.set(c,e.get(c)+s),n.set(c,void 0!==n.get(c)?n.get(c)+s:s)))}}}),n}function d(e){if(!e||isNaN(e))return new Date(NaN);var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}function y(e){var t,n,r=C(),o=r.getUTCFullYear(),u=r.getUTCMonth()+1;if(e instanceof Date)t=e.getUTCFullYear(),n=e.getUTCMonth()+1;else{if("string"!=typeof e)return!1;var s=a(e.split("-").map(Number),2);t=s[0],n=s[1]}return o>t||o===t&&u>n}function w(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function b(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function m(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function T(e,t){var n=new Date(e);return n.setUTCDate(n.getUTCDate()+t),n}function C(){var e=new Date;return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1))}function M(e){if(!e||"N/A"===e)return new Date(NaN);try{if(/^\d{4}-\d{2}$/.test(e)){var t=a(e.split("-").map(Number),2),n=t[0],r=t[1];return new Date(Date.UTC(n,r-1,1))}var o=new Date(e);return isNaN(o.getTime())?new Date(NaN):new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),1))}catch(e){return new Date(NaN)}}function k(e,t){for(var n=U(t),r=0;r<e.length;r++){var a=U(e[r]);if(n.getTime()===a.getTime())return r}return console.warn("Target date not found in history, using index 0"),0}function U(e){var t=e.split("-"),n=parseInt(t[0]),r=parseInt(t[1]);return new Date(Date.UTC(n,r-1,1))}Office.onReady(function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=c)})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map