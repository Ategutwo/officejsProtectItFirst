/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"8d768f65702f2137206f.css"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function l(e,a,o,s){var l=a&&a.prototype instanceof c?a:c,i=Object.create(l.prototype);return t(i,"_invoke",function(e,t,a){var o,s,l,c=0,i=a||[],g=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return o=e,s=0,l=n,f.n=t,u}};function p(e,t){for(s=e,l=t,r=0;!g&&c&&!a&&r<i.length;r++){var a,o=i[r],p=f.p,d=o[2];e>3?(a=d===t)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=n):o[0]<=p&&((a=e<2&&p<o[1])?(s=0,f.v=t,f.n=o[1]):p<d&&(a=e<3||o[0]>t||t>d)&&(o[4]=e,o[5]=t,f.n=d,s=0))}if(a||e>1)return u;throw g=!0,t}return function(a,i,d){if(c>1)throw TypeError("Generator is already running");for(g&&1===i&&p(i,d),s=i,l=d;(r=s<2?n:l)||!g;){o||(s?s<3?(s>1&&(f.n=-1),p(s,l)):f.n=l:f.v=l);try{if(c=2,o){if(s||(a="next"),r=o[a]){if(!(r=r.call(o,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,s<2&&(s=0)}else 1===s&&(r=o.return)&&r.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=n}else if((r=(g=f.n<0)?l:e.call(t,f))!==u)break}catch(e){o=n,s=1,l=e}finally{c=1}}return{value:r,done:g}}}(e,o,s),!0),i}var u={};function c(){}function i(){}function g(){}r=Object.getPrototypeOf;var f=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),p=g.prototype=c.prototype=Object.create(f);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,t(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return i.prototype=g,t(p,"constructor",g),t(g,"constructor",i),i.displayName="GeneratorFunction",t(g,s,"GeneratorFunction"),t(p),t(p,s,"Generator"),t(p,o,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:d}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},t(e,n,r,a)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){u=!0,s=e},f:function(){try{l||null==n.return||n.return()}finally{if(u)throw s}}}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,s,l=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return l}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,a,o,s){try{var l=e[o](s),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function s(e){l(o,r,a,s,u,"next",e)}function u(e){l(o,r,a,s,u,"throw",e)}s(void 0)})}}function c(){return i.apply(this,arguments)}function i(){return i=u(e().m(function t(){var o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=u(e().m(function t(o){var s,l,u,c,i,T,A,D,E,I,M,U,N,S,x,F,K,B,L,P,O,j,Y,G,_,H,X,$,z,J,V,q,Q,W,Z,ee,te,ne,re,ae,oe,se,le,ue,ce,ie,ge,fe,pe,de,he,ve,ye,me,we,ke,be,Re,Ce,Te,Ae,De,Ee,Ie,Me,Ue,Ne,Se,xe,Fe,Ke,Be,Le,Pe,Oe,je,Ye,Ge,_e,He,Xe,$e,ze,Je,Ve,qe,Qe,We,Ze,et,tt,nt,rt,at,ot,st,lt,ut,ct,it,gt,ft,pt,dt,ht,vt,yt,mt,wt,kt,bt,Rt,Ct,Tt,At,Dt,Et,It,Mt,Ut,Nt,St,xt,Ft,Kt,Bt,Lt,Pt,Ot,jt,Yt,Gt,_t,Ht,Xt,$t,zt,Jt,Vt,qt,Qt,Wt,Zt,en,tn,nn,rn,an,on,sn,ln,un,cn,gn,fn,pn,dn,hn,vn,yn,mn,wn,kn,bn,Rn,Cn,Tn,An,Dn,En,In,Mn,Un,Nn,Sn,xn,Fn,Kn,Bn,Ln,Pn,On,jn;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=new Set(["Aspirin (3 / 2-packs)","Syringe 3ml Luer-Lok Tip 25G x 1","Syringe BD 1ml TB - 25G X 5/8"]),l=o.workbook.worksheets.getItem("DrugDetails"),u=o.workbook.worksheets.getItem("packageDistribution"),c=u.getRange("A2:D7"),i=l.getUsedRange().getLastRow(),o.workbook.worksheets.getItem("AutoReplenishHistory"),T=o.workbook.worksheets.getItem("Drug Replenish Dates(New Kits)"),A=o.workbook.worksheets.getItem("auto_replenish_med_groups"),D=o.workbook.worksheets.getItem("Revenue Prediction"),E=o.workbook.worksheets.getItem("AED_Details(main)"),(I=E.getUsedRange()).load(["rowIndex","rowCount"]),e.n=1,o.sync();case 1:return M=I.rowIndex,(U=E.getRange("A2:I".concat(M+1))).load("values"),e.n=2,o.sync();case 2:return N={},U.values.forEach(function(e){e[1]&&""!==e[1].toString().trim()&&(N[e[1].trim()]={itemName:e[1],units:e[2],unitCost:e[3],totalUnitCost:e[4],laCarte:e[5],shelfLife:e[8],basePrice:e[5]})}),console.log("AED Items loaded:",Object.keys(N)),S=new Map,e.p=3,x=o.workbook.worksheets.getItem("Yearly Med Increase"),(F=x.getUsedRange()).load("rowCount"),e.n=4,o.sync();case 4:if(!(F.rowCount>1)){e.n=6;break}return(K=x.getRange("A2:B".concat(F.rowCount))).load("values"),e.n=5,o.sync();case 5:K.values.forEach(function(e){if(e[0]&&null!==e[1]&&""!==e[1]&&!isNaN(e[1])){var t=y(h(e[0]));S.set(t,parseFloat(e[1]))}}),console.log("Monthly increase data loaded:",S);case 6:e.n=8;break;case 7:e.p=7,e.v,console.log("Yearly Med Increase sheet not found or error reading data, using no increases");case 8:return D.getRangeByIndexes(1,0,1e4,15).clear(Excel.ClearApplyTo.contents),T.getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),i.load("rowIndex"),e.n=9,o.sync();case 9:return B=i.rowIndex,(L=l.getRange("B".concat(1,":O",B+1))).load("values"),c.load("values"),e.n=10,o.sync();case 10:return P=c.values,O={},j={},console.log(L.values),L.values.forEach(function(e){O[e[0]]={totalUnitCost:e[3],laCarte:e[4],includedInPackages:[],shelfLife:e[7],basePrice:e[4]};for(var t=8;t<=13;t++)e[t]&&""!==e[t].toString().trim()&&O[e[0]].includedInPackages.push(L.values[0][t])}),P.forEach(function(e){j[e[0]]={retailPrice:e[1],newKitShares:e[2],purchasePrice:e[3],drugs:[],baseRetailPrice:e[1]}}),Y=o.workbook.worksheets.getItem("New Kit Data"),(G=Y.getUsedRange().getLastRow()).load("rowIndex"),e.n=11,o.sync();case 11:return _=G.rowIndex,(H=Y.getRange("A2:B".concat(_+1))).load("values"),e.n=12,o.sync();case 12:return X=H.values,$={},z=0,e.p=13,(J=Y.getRange("L2")).load("values"),e.n=14,o.sync();case 14:null===J.values[0][0]||""===J.values[0][0]||isNaN(J.values[0][0])||(z=parseFloat(J.values[0][0]),console.log("Using discount percentage:",z)),e.n=16;break;case 15:e.p=15,e.v,console.log("Error reading discount from L2, using 0% discount");case 16:return V=function(e,t,n){if(0===n.size)return e;var a=new Date,o=y(t);if(t<a)return e;var s,l=1,u=r(Array.from(n.keys()).sort());try{for(u.s();!(s=u.n()).done;){var c=s.value;c<=o&&(l*=1+n.get(c))}}catch(e){u.e(e)}finally{u.f()}return e*l},q=X.map(function(e){var t=y(h(e[0]));v(t)||($[t]=e[1]);var n=e[1],r=h(e[0]),a=V(j.EMK1.baseRetailPrice,r,S),o=V(j.EMK5.baseRetailPrice,r,S),s=V(j.EMK10.baseRetailPrice,r,S),l=V(j.EMK15.baseRetailPrice,r,S),u=V(j["EMK1-Mini"].baseRetailPrice,r,S),c=V(j["EMK10-Mini"].baseRetailPrice,r,S),i=Math.floor(j.EMK1.newKitShares*n)*a,g=Math.floor(j.EMK5.newKitShares*n)*o,f=Math.floor(j.EMK10.newKitShares*n)*s,p=Math.floor(j.EMK15.newKitShares*n)*l,d=Math.floor(j["EMK1-Mini"].newKitShares*n)*u,m=Math.floor(j["EMK10-Mini"].newKitShares*n)*c,w=(i+g+f+p+d+m)*(1-z),k=i*(1-z),b=g*(1-z),R=f*(1-z),C=p*(1-z),T=d*(1-z),A=m*(1-z);return[e[0],e[1],w,"",k,b,R,C,T,A]}),Y.getRange("A2:J"+(q.length+1)).values=q,L.values.forEach(function(e){"X"===e[8]&&j.EMK1.drugs.push(e[0]),"X"===e[9]&&j.EMK5.drugs.push(e[0]),"X"===e[10]&&j.EMK10.drugs.push(e[0]),"X"===e[11]&&j.EMK15.drugs.push(e[0]),"X"===e[12]&&j["EMK1-Mini"].drugs.push(e[0]),"X"===e[13]&&j["EMK10-Mini"].drugs.push(e[0])}),Q=new Map,W=[],(Z=o.workbook.worksheets.getItem("Replenish Dates(TakoverKits)")).getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),e.n=17,o.sync();case 17:return e.p=17,ee=o.workbook.worksheets.getItem("TakeOverDrugDetails"),(te=ee.getUsedRange()).load(["rowIndex","rowCount"]),e.n=18,o.sync();case 18:return ne=te.rowCount,(re=ee.getRange("A2:C".concat(ne+1))).load("values"),e.n=19,o.sync();case 19:return console.log("Takeover Drug Details rows: ".concat(re.values.length)),console.log("Takeover Drug Details sample:",re.values.slice(0,5)),ae={},oe=0,re.values.forEach(function(e,t){if(e[0]&&""!==e[0].toString().trim()){var n=e[0].toString().trim(),r=e[1]?e[1].toString().trim():"",a=e[2]&&!isNaN(e[2])?parseInt(e[2]):0;if(r){ae[r]||(ae[r]=[]);var o=O[n]?O[n].laCarte:0,s=O[n]?O[n].shelfLife:0;o>0&&a>0?(ae[r].push({drugName:n,daysToFirstReplenishment:a,price:o,shelfLife:s}),oe++):console.log("Skipping drug ".concat(n," - price: ").concat(o,", days: ").concat(a))}}}),console.log("Loaded ".concat(oe," valid takeover drugs across kits:"),Object.keys(ae)),Object.keys(ae).forEach(function(e){console.log("  ".concat(e,": ").concat(ae[e].length," drugs"))}),se=o.workbook.worksheets.getItem("New Takover Kit Data"),(le=se.getUsedRange()).load(["rowIndex","rowCount","columnCount"]),e.n=20,o.sync();case 20:return ue=le.rowCount,(ce=se.getRange("A2:G".concat(ue+1))).load("values"),e.n=21,o.sync();case 21:if(console.log("Takeover Kit Data rows: ".concat(ce.values.length)),console.log("Takeover Kit Data sample:",ce.values.slice(0,3)),ie={1:"EMK1",2:"EMK5",3:"EMK10",4:"EMK15",5:"EMK1-Mini",6:"EMK10-Mini"},ge=0,fe={},ce.values.forEach(function(e,t){var n=h(e[0]),r=y(n);console.log("\nProcessing month: ".concat(r)),fe[r]={kits:0,drugs:0,revenue:0};for(var a=function(){var t=ie[o],a=e[o]&&!isNaN(e[o])?parseInt(e[o]):0;console.log("  ".concat(t,": ").concat(a," takeovers")),a>0&&ae[t]&&(fe[r].kits+=a,ae[t].forEach(function(e){if(e.price&&!isNaN(e.price)&&e.daysToFirstReplenishment>0&&e.shelfLife&&!isNaN(e.shelfLife)){var o=s.has(e.drugName.trim()),l=new Date(n);l.setUTCDate(l.getUTCDate()+e.daysToFirstReplenishment),y(l);for(var u=[],c=[],i=0;i<10;i++){var g=new Date(l);g.setUTCDate(g.getUTCDate()+e.shelfLife*i);var f=g.getUTCFullYear(),p=String(g.getUTCMonth()+1).padStart(2,"0"),d="".concat(f,"-").concat(p);u.push(d);var h;h=o?0===i?e.price*a:0:e.price*a,c.push(h);var v=Q.get(d)||0;Q.set(d,v+h)}ge++,fe[r].drugs++,fe[r].revenue+=c[0],W.push([r,t+" (Takeover)",e.drugName,a,c[0],e.shelfLife,e.daysToFirstReplenishment].concat(u))}}))},o=1;o<=6;o++)a()}),console.log("\n=== TAKEOVER PROCESSING SUMMARY ==="),console.log("Total drug entries processed: ".concat(ge)),console.log("Monthly breakdown:",fe),console.log("Takeover Revenue Map entries: ".concat(Q.size)),console.log("Takeover Revenue Map sample:",Array.from(Q.entries()).slice(0,10)),console.log("Takeover Drug Predictions count: ".concat(W.length)),!(W.length>0)){e.n=24;break}if(pe=Z.getUsedRange(),de=1,!pe){e.n=23;break}return pe.load("rowCount"),e.n=22,o.sync();case 22:de=pe.rowCount;case 23:console.log("Adding ".concat(W.length," takeover predictions starting at row ").concat(de)),Z.getRangeByIndexes(de,0,W.length,W[0].length).values=W,e.n=25;break;case 24:console.log("No takeover predictions to add!");case 25:e.n=27;break;case 26:e.p=26,Bn=e.v,console.log("Error processing takeover kit data:",Bn);case 27:return he=[],Object.keys($).forEach(function(e){var t=$[e];Object.keys(j).forEach(function(n){var r=Math.floor(t*j[n].newKitShares);r<1||j[n].drugs.forEach(function(t){if(""!=O[t].shelfLife&&"N/A"!=O[t].shelfLife){var a=s.has(t.trim()),o=R(e),l=a?0:V(O[t].basePrice,o,S);he.push([e,n,t,r,l*r,O[t].shelfLife])}})})}),ve=he.map(function(e){for(var t=a(e,6),r=t[0],o=(t[1],t[2],t[3],t[4],t[5]),s=a(r.split("-").map(Number),2),l=s[0],u=s[1],c=new Date(Date.UTC(l,u-1,1)),i=[],g=1;g<=10;g++){var f=new Date(c);f.setUTCDate(f.getUTCDate()+o*g);var p=f.getUTCFullYear(),d=String(f.getUTCMonth()+1).padStart(2,"0");i.push("".concat(p,"-").concat(d))}return[].concat(n(e),i)}),T.getRangeByIndexes(1,0,ve.length,ve[0].length).values=ve,ye=g(q),me=f("2025-07",300,ye),we=p(me,ve),ke=A.getUsedRange(),(be=ke.getLastRow()).load("rowIndex"),e.n=28,o.sync();case 28:return(Re=A.getRangeByIndexes(2,0,be.rowIndex-1,6)).load("values"),e.n=29,o.sync();case 29:Ce=[["Group","Company","Medication","Expiration","Price","Auto Replenish","Generated Dates"]],Te=r(Re.values),e.p=30,Te.s();case 31:if((Ae=Te.n()).done){e.n=36;break}if(De=Ae.value,Ee=a(De,6),Ie=Ee[0],Me=Ee[1],Ue=Ee[2],Ne=Ee[3],Se=Ee[4],"Enabled"===(xe=Ee[5])&&"N/A"!=Ne&&""!=Ne){e.n=32;break}return e.a(3,35);case 32:if(Fe=O[Ue],Ke=h(Ne),Be=s.has(Ue.trim()),Le=Be?0:Ke?V(Se,Ke,S):Se,Ce.push([Ie,Me,Ue,Ke?w(Ke):"N/A",Le,xe,""]),Fe&&Ke&&Fe.shelfLife&&""!==Fe.shelfLife&&"N/A"!==Fe.shelfLife&&!isNaN(Fe.shelfLife)){e.n=33;break}return e.a(3,35);case 33:if(!((Pe=parseInt(Fe.shelfLife))<=0)){e.n=34;break}return e.a(3,35);case 34:for(Oe=1;Oe<=20;Oe++)je=k(Ke,Pe*Oe),Ye=Be?0:V(Se,je,S),Ce.push([Ie,Me,Ue,w(je),parseFloat(Ye.toFixed(2)),xe,"Generated"]);case 35:e.n=31;break;case 36:e.n=38;break;case 37:e.p=37,Ln=e.v,Te.e(Ln);case 38:return e.p=38,Te.f(),e.f(38);case 39:return Ge=o.workbook.worksheets.getItem("auto_replenish_aed_groups"),_e=Ge.getUsedRange(),(He=_e.getLastRow()).load("rowIndex"),e.n=40,o.sync();case 40:return(Xe=Ge.getRangeByIndexes(2,0,He.rowIndex-1,6)).load("values"),e.n=41,o.sync();case 41:console.log("AED Auto Replenish data:",Xe.values),$e=[["Group","Company","AED Item","Expiration","Price","Auto Replenish","Generated Dates"]],ze=r(Xe.values),e.p=42,ze.s();case 43:if((Je=ze.n()).done){e.n=48;break}if(Ve=Je.value,qe=a(Ve,6),Qe=qe[0],We=qe[1],Ze=qe[2],et=qe[3],tt=qe[4],"Enabled"===(nt=qe[5])){e.n=44;break}return e.a(3,47);case 44:if(rt=Ze?Ze.toString().trim():"",at=N[rt],ot=et&&"N/A"!==et&&""!==et?h(et):null,st=s.has(rt),lt=st?0:ot?V(tt,ot,S):tt,$e.push([Qe,We,rt,ot?w(ot):"N/A",lt,nt,""]),ot&&at&&at.shelfLife&&""!==at.shelfLife&&"N/A"!==at.shelfLife&&!isNaN(at.shelfLife)){e.n=45;break}return e.a(3,47);case 45:if(!((ut=parseInt(at.shelfLife))<=0)){e.n=46;break}return e.a(3,47);case 46:for(ct=1;ct<=20;ct++)it=k(ot,ut*ct),gt=st?0:V(tt,it,S),$e.push([Qe,We,rt,w(it),parseFloat(gt.toFixed(2)),nt,"Generated"]);case 47:e.n=43;break;case 48:e.n=50;break;case 49:e.p=49,Pn=e.v,ze.e(Pn);case 50:return e.p=50,ze.f(),e.f(50);case 51:return console.log("AED Auto Replenish processed items:",$e.length),ft=d(me,Ce),pt=d(me,$e),console.log("Regular Auto Replenish:",ft),console.log("AED Auto Replenish:",pt),dt=new Set([].concat(n(we.keys()),n(ft.keys()),n(pt.keys()),n(ye.keys()),n(me.keys()),n(Q.keys()))),ht=[],vt=b(),yt=w(vt),wt=.25,e.p=52,mt=o.workbook.worksheets.getItem("Non-Auto Replenish"),kt=mt.getRange("G2"),bt=mt.getRange("H2"),kt.load("values"),bt.load("values"),e.n=53,o.sync();case 53:null===bt.values[0][0]||""===bt.values[0][0]||isNaN(bt.values[0][0])?null===kt.values[0][0]||""===kt.values[0][0]||isNaN(kt.values[0][0])||(wt=parseFloat(kt.values[0][0])):wt=parseFloat(bt.values[0][0]),console.log("Using Non-Auto Replenishment percentage:",wt),e.n=55;break;case 54:e.p=54,e.v,console.log("Non-Auto Replenish sheet not found or error reading values, using default 25%");case 55:return Rt=0,e.p=56,Ct=o.workbook.worksheets.getItem("AED Sales"),(Tt=Ct.getRange("G2")).load("values"),e.n=57,o.sync();case 57:null===Tt.values[0][0]||""===Tt.values[0][0]||isNaN(Tt.values[0][0])||(Rt=parseFloat(Tt.values[0][0])),console.log("Using AED Sales value:",Rt),e.n=59;break;case 58:e.p=58,e.v,console.log("AED Sales sheet not found or error reading G2 value, using 0");case 59:At=n(dt).sort(),Dt=r(At);try{for(Dt.s();!(Et=Dt.n()).done;)It=Et.value,Mt=ye.get(It)||0,Ut=ft.get(It)||0,Nt=pt.get(It)||0,St=we.get(It)||0,xt=Q.get(It)||0,Bt=Mt+Ut+Nt+St+(Ft=It>yt?Ut*wt:0)+(Kt=It>yt?Rt:0)+xt,ht.push([It,Bt,Mt,Ut,St,Ft,Kt,Nt,xt])}catch(e){Dt.e(e)}finally{Dt.f()}return D.getRangeByIndexes(1,0,ht.length,ht[0].length).values=ht,Lt=["Month","Total Revenue","New Kit Revenue","Auto Replenish","Drug Data Revenue","Non-Auto Replenishment","AED Sales","AED Auto Replenish","New Takeover Kit Revenue"],D.getRangeByIndexes(0,0,1,Lt.length).values=[Lt],e.n=60,o.sync();case 60:return console.log("Final Revenue Forecast:",ht),console.table(ht),(Pt=Array.from(ft.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])}),Ot=o.workbook.worksheets.getItem("AutoReplenishHistory"),(jt=Ot.getUsedRange()).load(["columnIndex","columnCount","rowCount"]),e.n=61,o.sync();case 61:if(!(jt.columnCount>1)){e.n=64;break}return Yt=Ot.getRangeByIndexes(1,1,1,jt.columnCount-1),Gt=Ot.getRangeByIndexes(2,0,jt.rowCount-2,1),Yt.load("values"),Gt.load("values"),e.n=62,o.sync();case 62:return console.log("Dates in History:",Gt.values),_t=Yt.values[0],Ht=m(new Date),Xt=_t.indexOf(Ht),$t=Gt.values.map(function(e){return e[0]}),zt=C($t,Pt[0][0]),console.log("Beginning Date Index:",zt),console.log("Target Date:",Pt[0][0]),console.log("Current Month Position:",Xt),e.n=63,o.sync();case 63:-1!==Xt?(Ot.getRangeByIndexes(2+zt,Xt+1,Pt.length,1).values=Pt.map(function(e){return[e[1]]}),Ot.getRangeByIndexes(2+zt,0,Pt.length,1).values=Pt.map(function(e){return[e[0]]})):(Ot.getRangeByIndexes(1,jt.columnCount,1,1).numberFormat=[["@"]],Ot.getRangeByIndexes(1,jt.columnCount,1,1).values=[[Ht]],Ot.getRangeByIndexes(2+zt,jt.columnCount,Pt.length,1).values=Pt.map(function(e){return[e[1]]}),Ot.getRangeByIndexes(2+zt,0,Pt.length,1).values=Pt.map(function(e){return[e[0]]}));case 64:if(!(pt.size>0)){e.n=74;break}e.p=65,(Jt=Array.from(pt.entries()).map(function(e){var t=a(e,2);return[t[0],t[1]]})).sort(function(e,t){return e[0].localeCompare(t[0])});try{Vt=o.workbook.worksheets.getItem("AutoReplenishAEDHistory")}catch(e){Vt=o.workbook.worksheets.add("AutoReplenishAEDHistory")}if(qt=Vt.getUsedRange(),Qt=m(new Date),qt){e.n=66;break}Vt.getRange("A1").values=[["Report Dates"]],Vt.getRange("A2").values=[["Replenish Dates"]],Wt=n(new Set(n(Jt.map(function(e){return e[0]})))).sort(),Zt=Wt.map(function(e){return[e]}),Vt.getRange("A3:A"+(Zt.length+2)).values=Zt,Vt.getRange("B2").numberFormat=[["@"]],Vt.getRange("B2").values=[[Qt]],console.log("Hello Alvin"),en=Wt.map(function(e){return[pt.get(e)||0]}),Vt.getRange("B3:B"+(en.length+2)).values=en,e.n=71;break;case 66:return qt.load(["columnCount","rowCount"]),e.n=67,o.sync();case 67:return(tn=Vt.getRangeByIndexes(1,qt.columnCount-1,1,1)).load("values"),e.n=68,o.sync();case 68:if(tn.values[0][0]===Qt){e.n=70;break}return(nn=Vt.getRange("A3:A"+qt.rowCount)).load("values"),e.n=69,o.sync();case 69:for(rn=nn.values.map(function(e){return e[0]}).filter(function(e){return e}),an=qt.columnCount,Vt.getRangeByIndexes(1,an,1,1).numberFormat=[["@"]],Vt.getRangeByIndexes(1,an,1,1).values=[[Qt]],on=0;on<rn.length;on++)sn=rn[on],ln=pt.get(sn)||0,Vt.getRangeByIndexes(on+2,an,1,1).values=[[ln]];if(un=Jt.map(function(e){return a(e,1)[0]}).filter(function(e){return!rn.includes(e)}).sort(),un.length>0)for(cn=rn.length+2,Vt.getRangeByIndexes(cn,0,un.length,1).values=un.map(function(e){return[e]}),gn=0;gn<un.length;gn++)fn=un[gn],pn=pt.get(fn)||0,Vt.getRangeByIndexes(cn+gn,an,1,1).values=[[pn]];console.log("New column added to AED AutoReplenishHistory for date:",Qt),e.n=71;break;case 70:console.log("No new column added - same date as last run:",Qt);case 71:return e.n=72,o.sync();case 72:console.log("AED AutoReplenishHistory updated successfully"),e.n=74;break;case 73:e.p=73,On=e.v,console.log("Error creating/updating AutoReplenishAEDHistory:",On);case 74:e.p=74;try{(dn=o.workbook.worksheets.getItem("Yearly Revenue")).getUsedRange().clear(Excel.ClearApplyTo.contents)}catch(e){dn=o.workbook.worksheets.add("Yearly Revenue")}return(hn=D.getUsedRange()).load("values"),e.n=75,o.sync();case 75:vn=hn.values,yn=new Map,mn=1;case 76:if(!(mn<vn.length)){e.n=79;break}if((wn=vn[mn])&&!(wn.length<9)){e.n=77;break}return e.a(3,78);case 77:kn=a(wn,9),bn=kn[0],Rn=kn[1],Cn=kn[2],Tn=kn[3],An=kn[4],Dn=kn[5],En=kn[6],In=kn[7],Mn=kn[8],Un=bn.split("-")[0],yn.has(Un)||yn.set(Un,{total:0,newKit:0,autoReplenish:0,drugData:0,nonAuto:0,aedSales:0,aedAuto:0,takeover:0}),(Nn=yn.get(Un)).total+=parseFloat(Rn)||0,Nn.newKit+=parseFloat(Cn)||0,Nn.autoReplenish+=parseFloat(Tn)||0,Nn.drugData+=parseFloat(An)||0,Nn.nonAuto+=parseFloat(Dn)||0,Nn.aedSales+=parseFloat(En)||0,Nn.aedAuto+=parseFloat(In)||0,Nn.takeover+=parseFloat(Mn)||0;case 78:mn++,e.n=76;break;case 79:Sn=Array.from(yn.entries()).map(function(e){var t=a(e,2),n=t[0],r=t[1];return[n,r.total,r.newKit,r.autoReplenish,r.drugData,r.nonAuto,r.aedSales,r.aedAuto,r.takeover]}).sort(function(e,t){return e[0].localeCompare(t[0])}),Fn=[xn=["Year","Total Revenue","New Kit Revenue","Auto Replenish","Drug Data Revenue","Non-Auto Replenishment","AED Sales","AED Auto Replenish","New Takeover Kit Revenue"]].concat(n(Sn)),dn.getRangeByIndexes(0,0,Fn.length,xn.length).values=Fn,(Kn=dn.getRangeByIndexes(0,0,1,xn.length)).format.fill.color="#4472C4",Kn.format.font.color="white",Kn.format.font.bold=!0,Fn.length>1&&(dn.getRangeByIndexes(1,1,Fn.length-1,xn.length-1).numberFormat=[["$#,##0.00"]]),dn.getUsedRange().format.autofitColumns(),console.log("Yearly Revenue summary created successfully"),console.table(Sn),e.n=81;break;case 80:e.p=80,jn=e.v,console.log("Error creating Yearly Revenue summary:",jn);case 81:return e.n=82,o.sync();case 82:return e.a(2,o.sync())}},t,null,[[74,80],[65,73],[56,58],[52,54],[42,49,50,51],[30,37,38,39],[17,26],[13,15],[3,7]])}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error(o);case 3:return t.a(2)}},t,null,[[0,2]])})),i.apply(this,arguments)}function g(e){var t=new Map,n=b(),r=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1));return e.forEach(function(e){var n=a(e,3),o=n[0],s=(n[1],n[2]),l=h(o);if(l>=r){var u="".concat(l.getUTCFullYear(),"-").concat(String(l.getUTCMonth()+1).padStart(2,"0"));t.set(u,s)}}),t}function f(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2023-06",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=new Map,o=a(e.split("-").map(Number),2),s=o[0],l=o[1],u=new Date(Date.UTC(s,l-1,1)),c=0;c<t;c++){var i=u.getUTCFullYear(),g=String(u.getUTCMonth()+1).padStart(2,"0"),f="".concat(i,"-").concat(g),p=n.get(f)||0;r.set(f,p),u.setUTCMonth(u.getUTCMonth()+1)}return r}function p(e,t){var n,a=new Map,o=r(t);try{var s=function(){var t=n.value,r=parseFloat(t[4]);t.slice(6).forEach(function(t){e.has(t)&&(e.set(t,e.get(t)+r),a.set(t,null!=a.get(t)?a.get(t)+r:r))})};for(o.s();!(n=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}return a}function d(e,t){var n=new Map;return t.forEach(function(t){var r=a(t,6),o=(r[0],r[1],r[2],r[3]),s=r[4];if("Enabled"===r[5]){var l="string"==typeof s?parseFloat(s.replace("$","")):s,u=R(o);if(u){var c="".concat(u.getUTCFullYear(),"-").concat(String(u.getUTCMonth()+1).padStart(2,"0"));e.has(c)&&(isNaN(l)||(e.set(c,e.get(c)+l),n.set(c,void 0!==n.get(c)?n.get(c)+l:l)))}}}),n}function h(e){if(!e||isNaN(e))return new Date(NaN);var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}function v(e){var t,n,r=b(),o=r.getUTCFullYear(),s=r.getUTCMonth()+1;if(e instanceof Date)t=e.getUTCFullYear(),n=e.getUTCMonth()+1;else{if("string"!=typeof e)return!1;var l=a(e.split("-").map(Number),2);t=l[0],n=l[1]}return o>t||o===t&&s>n}function y(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function m(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function w(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function k(e,t){var n=new Date(e);return n.setUTCDate(n.getUTCDate()+t),n}function b(){var e=new Date;return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1))}function R(e){if(!e||"N/A"===e)return new Date(NaN);try{if(/^\d{4}-\d{2}$/.test(e)){var t=a(e.split("-").map(Number),2),n=t[0],r=t[1];return new Date(Date.UTC(n,r-1,1))}var o=new Date(e);return isNaN(o.getTime())?new Date(NaN):new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),1))}catch(e){return new Date(NaN)}}function C(e,t){for(var n=T(t),r=0;r<e.length;r++){var a=T(e[r]);if(n.getTime()===a.getTime())return r}return console.warn("Target date not found in history, using index 0"),0}function T(e){var t=e.split("-"),n=parseInt(t[0]),r=parseInt(t[1]);return new Date(Date.UTC(n,r-1,1))}Office.onReady(function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=c)})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map