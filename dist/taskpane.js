/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"8d768f65702f2137206f.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.toStringTag||"@@toStringTag";function c(e,o,a,u){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,o){var a,u,c,s=0,l=o||[],f=!1,g={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return a=e,u=0,c=n,g.n=t,i}};function p(e,t){for(u=e,c=t,r=0;!f&&s&&!o&&r<l.length;r++){var o,a=l[r],p=g.p,h=a[2];e>3?(o=h===t)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=n):a[0]<=p&&((o=e<2&&p<a[1])?(u=0,g.v=t,g.n=a[1]):p<h&&(o=e<3||a[0]>t||t>h)&&(a[4]=e,a[5]=t,g.n=h,u=0))}if(o||e>1)return i;throw f=!0,t}return function(o,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,h),u=l,c=h;(r=u<2?n:c)||!f;){a||(u?u<3?(u>1&&(g.n=-1),p(u,c)):g.n=c:g.v=c);try{if(s=2,a){if(u||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,u<2&&(u=0)}else 1===u&&(r=a.return)&&r.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=n}else if((r=(f=g.n<0)?c:e.call(t,g))!==i)break}catch(e){a=n,u=1,c=e}finally{s=1}}return{value:r,done:f}}}(e,a,u),!0),l}var i={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var g=[][a]?r(r([][a]())):(t(r={},a,(function(){return this})),r),p=f.prototype=s.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,u,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=f,t(p,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,u,"GeneratorFunction"),t(p),t(p,u,"Generator"),t(p,a,(function(){return this})),t(p,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:c,m:h}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){if(n)a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r;else{var u=function(n,r){t(e,n,(function(e){return this._invoke(n,r,e)}))};u("next",0),u("throw",1),u("return",2)}},t(e,n,r,o)}function n(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,u=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw u}}}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,u,c=[],i=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw o}}return c}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,o,a,u){try{var c=e[a](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){c(a,r,o,u,i,"next",e)}function i(e){c(a,r,o,u,i,"throw",e)}u(void 0)}))}}function s(){return l.apply(this,arguments)}function l(){return l=i(e().m((function t(){var a;return e().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=i(e().m((function t(a){var u,c,i,s,l,v,M,S,k,E,I,x,R,C,K,T,D,O,A,j,P,U,F,B,N,G,L,Y,_,X,$,H,J,q,z,Q,V,W,Z,ee,te,ne,re,oe,ae,ue,ce,ie,se,le,fe,ge,pe,he,de,ve,ye,we,be,me,Me,Se,ke,Ee,Ie;return e().w((function(e){for(;;)switch(e.n){case 0:return u=a.workbook.worksheets.getItem("DrugDetails"),c=a.workbook.worksheets.getItem("packageDistribution"),i=c.getRange("A2:D7"),s=u.getUsedRange().getLastRow(),a.workbook.worksheets.getItem("AutoReplenishHistory"),l=a.workbook.worksheets.getItem("Drug Replenish Dates(New Kits)"),v=a.workbook.worksheets.getItem("auto_replenish_med_groups"),(M=a.workbook.worksheets.getItem("Revenue Prediction")).getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),l.getRangeByIndexes(1,0,1e4,50).clear(Excel.ClearApplyTo.contents),s.load("rowIndex"),e.n=1,a.sync();case 1:return S=s.rowIndex,(k=u.getRange("B".concat(1,":O",S+1))).load("values"),i.load("values"),e.n=2,a.sync();case 2:return E=i.values,I={},x={},console.log(k.values),k.values.forEach((function(e){I[e[0]]={totalUnitCost:e[3],laCarte:e[4],includedInPackages:[],shelfLife:e[7]};for(var t=8;t<=13;t++)""!==e[t].toString().trim()&&I[e[0]].includedInPackages.push(k.values[0][t])})),E.forEach((function(e){x[e[0]]={retailPrice:e[1],newKitShares:e[2],purchasePrice:e[3],drugs:[]}})),console.log(I,"Meds Object"),R=a.workbook.worksheets.getItem("New Kit Data"),(C=R.getUsedRange().getLastRow()).load("rowIndex"),e.n=3,a.sync();case 3:return K=C.rowIndex,(T=R.getRange("A2:B".concat(K+1))).load("values"),e.n=4,a.sync();case 4:return D=T.values,O={},A=D.map((function(e){O[w(m(e[0]))]=e[1];var t=e[1],n=Math.floor(x.EMK1.newKitShares*t)*x.EMK1.retailPrice,r=Math.floor(x.EMK5.newKitShares*t)*x.EMK5.retailPrice,o=Math.floor(x.EMK10.newKitShares*t)*x.EMK10.retailPrice,a=Math.floor(x.EMK15.newKitShares*t)*x.EMK15.retailPrice,u=Math.floor(x["EMK1-Mini"].newKitShares*t)*x["EMK1-Mini"].retailPrice,c=Math.floor(x["EMK10-Mini"].newKitShares*t)*x["EMK10-Mini"].retailPrice;return[e[0],e[1],n+r+o+a+u+c,"",n,r,o,a,u,c]})),R.getRange("A2:J"+(A.length+1)).values=A,k.values.forEach((function(e){"X"===e[8]&&x.EMK1.drugs.push(e[0]),"X"===e[9]&&x.EMK5.drugs.push(e[0]),"X"===e[10]&&x.EMK10.drugs.push(e[0]),"X"===e[11]&&x.EMK15.drugs.push(e[0]),"X"===e[12]&&x["EMK1-Mini"].drugs.push(e[0]),"X"===e[13]&&x["EMK10-Mini"].drugs.push(e[0])})),j=[],Object.keys(O).forEach((function(e){var t=O[e];Object.keys(x).forEach((function(n){var r=Math.floor(t*x[n].newKitShares);r<1||x[n].drugs.forEach((function(t){""!=I[t].shelfLife&&"N/A"!=I[t].shelfLife&&j.push([e,n,t,r,I[t].laCarte*r,I[t].shelfLife])}))}))})),P=j.map((function(e){for(var t=o(e,6),r=t[0],a=(t[1],t[2],t[3],t[4],t[5]),u=o(r.split("-").map(Number),2),c=u[0],i=u[1],s=new Date(c,i-1),l=[],f=1;f<=10;f++){var g=new Date(s);g.setDate(g.getDate()+a*f);var p=g.getFullYear(),h=String(g.getMonth()+1).padStart(2,"0");l.push("".concat(p,"-").concat(h))}return[].concat(n(e),l)})),l.getRangeByIndexes(1,0,P.length,P[0].length).values=P,U=g(A),F=p("2025-07",300,U),B=h(F,P),N=v.getUsedRange(),(G=N.getLastRow()).load("rowIndex"),e.n=5,a.sync();case 5:return(L=v.getRangeByIndexes(2,0,G.rowIndex-1,6)).load("values"),e.n=6,a.sync();case 6:Y=[["Group","Company","Medication","Expiration","Price","Auto Replenish","Generated Dates"]],_=r(L.values),e.p=7,_.s();case 8:if((X=_.n()).done){e.n=12;break}if($=X.value,H=o($,6),J=H[0],q=H[1],z=H[2],Q=H[3],V=H[4],"Enabled"===(W=H[5])&&"N/A"!=Q&&""!=Q){e.n=9;break}return e.a(3,11);case 9:if(Z=I[z],ee=m(Q),Y.push([J,q,z,ee?y(ee):"N/A",V,W,""]),Z&&ee){e.n=10;break}return e.a(3,11);case 10:for(te=Z.shelfLife,Z.laCarte,ne=1;ne<=20;ne++)t=te*ne,re=new Date(ee.valueOf()+864e5*t),Y.push([J,q,z,y(re),parseFloat(V.toFixed(2)),W,"Generated"]);case 11:e.n=8;break;case 12:e.n=14;break;case 13:e.p=13,Ie=e.v,_.e(Ie);case 14:return e.p=14,_.f(),e.f(14);case 15:oe=d(F,Y),console.log(B,U,oe),ae=new Set([].concat(n(B.keys()),n(oe.keys()),n(U.keys()),n(F.keys()))),ue=[],ce=r(n(ae).sort());try{for(ce.s();!(ie=ce.n()).done;)se=ie.value,le=U.get(se)||0,fe=oe.get(se)||0,ge=B.get(se)||0,pe=le+fe+ge,ue.push([se,pe,le,fe,ge])}catch(e){ce.e(e)}finally{ce.f()}return M.getRangeByIndexes(1,0,ue.length,ue[0].length).values=ue,e.n=16,a.sync();case 16:return console.table(ue),he=f(ue),de=a.workbook.worksheets.getItem("AutoReplenishHistory"),(ve=de.getUsedRange()).load(["columnIndex","columnCount","rowCount"]),e.n=17,a.sync();case 17:if(!(ve.columnCount<=1)){e.n=18;break}return e.a(2);case 18:return ye=de.getRangeByIndexes(1,1,1,ve.columnCount-1),we=de.getRangeByIndexes(2,0,ve.rowCount-2,1),ye.load("values"),we.load("values"),e.n=19,a.sync();case 19:return console.log(we.values),be=ye.values[0],me=b(new Date),Me=be.indexOf(me),Se=we.values.map((function(e){return e[0]})),ke=Se.indexOf(he[0][0]),console.log(me=be[0]),e.n=20,a.sync();case 20:return-1!==Me?(de.getRangeByIndexes(2+ke,Me+1,he.length,1).values=he.map((function(e){return[e[1]]})),de.getRangeByIndexes(2+ke,0,he.length,1).values=he.map((function(e){return[e[0]]}))):(Ee=b(new Date),de.getRangeByIndexes(1,ve.columnCount,1,1).numberFormat=[["@"]],de.getRangeByIndexes(1,ve.columnCount,1,1).values=[[Ee]],de.getRangeByIndexes(2+ke,ve.columnCount,he.length,1).values=he.map((function(e){return[e[1]]})),de.getRangeByIndexes(2+ke,0,he.length,1).values=he.map((function(e){return[e[0]]}))),e.n=21,a.sync();case 21:return e.a(2,a.sync())}var t}),t,null,[[7,13,14,15]])})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,a=t.v,console.error(a);case 3:return t.a(2)}}),t,null,[[0,2]])}))),l.apply(this,arguments)}function f(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]]).map((function(e){return[e[0],e[3]]}))}function g(e){var t=new Map,n=new Date,r=new Date(n.getFullYear(),n.getMonth()+1,1);return e.forEach((function(e){var n=o(e,3),a=n[0],u=(n[1],n[2]),c=m(a);if(console.log("Here we are"),c>=r){var i="".concat(c.getFullYear(),"-").concat(String(c.getMonth()+1).padStart(2,"0"));t.set(i,u)}})),t}function p(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2023-06",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=new Map,a=o(e.split("-").map(Number),2),u=a[0],c=a[1],i=new Date(u,c-1),s=0;s<t;s++){var l=i.getFullYear(),f=String(i.getMonth()+1).padStart(2,"0"),g="".concat(l,"-").concat(f),p=n.get(g)||0;r.set(g,p),i.setMonth(i.getMonth()+1)}return r}function h(e,t){var n,o=new Map,a=r(t);try{var u=function(){var t=n.value,r=parseFloat(t[4]);t.slice(6).forEach((function(t){e.has(t)&&(e.set(t,e.get(t)+r),o.set(t,null!=o.get(t)?o.get(t)+r:r))}))};for(a.s();!(n=a.n()).done;)u()}catch(e){a.e(e)}finally{a.f()}return o}function d(e,t){var n=new Map;return t.forEach((function(t){var r=o(t,6),a=(r[0],r[1],r[2],r[3]),u=r[4];if("Enabled"===r[5]){var c="string"==typeof u?parseFloat(u.replace("$","")):u,i=new v(a),s="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"));e.has(s)&&(isNaN(c)||(e.set(s,e.get(s)+c),n.set(s,void 0!==n.get(s)?n.get(s)+c:c)))}})),n}function v(e){var t=o(e.split("-").map(Number),2),n=t[0],r=t[1];return new Date(Date.UTC(n,r-1,1))}function y(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function w(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0");return"".concat(t,"-").concat(n)}function b(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=e.getUTCDate();return"".concat(t,"-").concat(n,"-").concat(r)}function m(e){var t=Math.floor(e-25569),n=new Date(86400*t*1e3);return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("run").onclick=s)}))}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map