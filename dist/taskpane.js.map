{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n/* global console, document, Excel, Office */\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Excel) {\r\n    document.getElementById(\"run\").onclick = run;\r\n  }\r\n});\r\n\r\nexport async function run() {\r\n  try {\r\n    await Excel.run(async (context) => {\r\n      // List of drugs that should be free for auto-replenishments\r\n      const FREE_DRUGS = new Set([\r\n        \"Aspirin (3 / 2-packs)\",\r\n        \"Syringe 3ml Luer-Lok Tip 25G x 1\", \r\n        \"Syringe BD 1ml TB - 25G X 5/8\"\r\n      ]);\r\n      \r\n      let ws = context.workbook.worksheets.getItem(\"DrugDetails\");\r\n      let packageDetails = context.workbook.worksheets.getItem(\"packageDistribution\");\r\n      let packageDetailsRange = packageDetails.getRange(\"A2:D7\");\r\n      let usedRange = ws.getUsedRange().getLastRow();\r\n      let wsAutoReplenishHistroy = context.workbook.worksheets.getItem(\"AutoReplenishHistory\");\r\n      let drugsExpirationPredictions = context.workbook.worksheets.getItem(\r\n        \"Drug Replenish Dates(New Kits)\"\r\n      );\r\n      let wsAutoReplenishMedGroups = context.workbook.worksheets.getItem(\r\n        \"auto_replenish_med_groups\"\r\n      );\r\n      let wsRevenuePredictions = context.workbook.worksheets.getItem(\"Revenue Prediction\");\r\n      \r\n      // Get AED Details sheet data\r\n      let wsAEDDetails = context.workbook.worksheets.getItem(\"AED_Details(main)\");\r\n      let aedUsedRange = wsAEDDetails.getUsedRange();\r\n      aedUsedRange.load([\"rowIndex\", \"rowCount\"]);\r\n      await context.sync();\r\n      let aedLastRow = aedUsedRange.rowIndex;\r\n      let aedDataRange = wsAEDDetails.getRange(`A2:I${aedLastRow + 1}`);\r\n      aedDataRange.load(\"values\");\r\n      await context.sync();\r\n      \r\n      // Create AED details object - use the AED Accessories name as key\r\n      let aedMedsObj = {};\r\n      aedDataRange.values.forEach((row) => {\r\n        if (row[1] && row[1].toString().trim() !== \"\") {\r\n          aedMedsObj[row[1].trim()] = {\r\n            itemName: row[1],\r\n            units: row[2],\r\n            unitCost: row[3],\r\n            totalUnitCost: row[4],\r\n            laCarte: row[5],\r\n            shelfLife: row[8],\r\n            basePrice: row[5] // Store base price for monthly increases\r\n          };\r\n        }\r\n      });\r\n      \r\n      console.log(\"AED Items loaded:\", Object.keys(aedMedsObj));\r\n      \r\n      // Get monthly increase data from \"Yearly Med Increase\" sheet\r\n      let monthlyIncreaseMap = new Map();\r\n      try {\r\n        const yearlyIncreaseSheet = context.workbook.worksheets.getItem(\"Yearly Med Increase\");\r\n        const usedRangeIncrease = yearlyIncreaseSheet.getUsedRange();\r\n        usedRangeIncrease.load(\"rowCount\");\r\n        await context.sync();\r\n        \r\n        if (usedRangeIncrease.rowCount > 1) {\r\n          const increaseDataRange = yearlyIncreaseSheet.getRange(`A2:B${usedRangeIncrease.rowCount}`);\r\n          increaseDataRange.load(\"values\");\r\n          await context.sync();\r\n          \r\n          increaseDataRange.values.forEach(row => {\r\n            if (row[0] && row[1] !== null && row[1] !== \"\" && !isNaN(row[1])) {\r\n              const date = excelSerialDateToJSDate(row[0]);\r\n              const monthKey = formatDate(date);\r\n              //Percentage Increase Area\r\n              monthlyIncreaseMap.set(monthKey, parseFloat(row[1]));\r\n            }\r\n          });\r\n          console.log(\"Monthly increase data loaded:\", monthlyIncreaseMap);\r\n        }\r\n      } catch (error) {\r\n        console.log(\"Yearly Med Increase sheet not found or error reading data, using no increases\");\r\n      }\r\n      \r\n      // Clear only up to column J to preserve discount in column L\r\n      wsRevenuePredictions.getRangeByIndexes(1, 0, 10000, 15).clear(Excel.ClearApplyTo.contents);\r\n      drugsExpirationPredictions\r\n        .getRangeByIndexes(1, 0, 10000, 50)\r\n        .clear(Excel.ClearApplyTo.contents);\r\n      \r\n      //Get the Details\r\n      usedRange.load(\"rowIndex\");\r\n      await context.sync();\r\n      let lastRow = usedRange.rowIndex;\r\n      let data = ws.getRange(`B${1}:O${lastRow + 1}`);\r\n      data.load(\"values\");\r\n      packageDetailsRange.load(\"values\");\r\n      await context.sync();\r\n      let packageDetailsData = packageDetailsRange.values;\r\n      let medsObj = {};\r\n      let emkDetails = {};\r\n      \r\n      //Get the drug details\r\n      console.log(data.values);\r\n      data.values.forEach((row) => {\r\n        medsObj[row[0]] = {\r\n          totalUnitCost: row[3],\r\n          laCarte: row[4],\r\n          includedInPackages: [],\r\n          shelfLife: row[7],\r\n          basePrice: row[4] // Store base price for monthly increases\r\n        };\r\n        for (let i = 8; i <= 13; i++) {\r\n          if (row[i] && row[i].toString().trim() !== \"\") {\r\n            medsObj[row[0]].includedInPackages.push(data.values[0][i]);\r\n          }\r\n        }\r\n      });\r\n\r\n      packageDetailsData.forEach((row) => {\r\n        //Create the emk objecst\r\n        emkDetails[row[0]] = {\r\n          retailPrice: row[1],\r\n          newKitShares: row[2],\r\n          purchasePrice: row[3],\r\n          drugs: [],\r\n          baseRetailPrice: row[1] // Store base price for monthly increases\r\n        };\r\n      });\r\n\r\n      //Get the New Kit Data\r\n      let wsNewKit = context.workbook.worksheets.getItem(\"New Kit Data\");\r\n      let newKitsLastRow = wsNewKit.getUsedRange().getLastRow();\r\n      newKitsLastRow.load(\"rowIndex\");\r\n      await context.sync();\r\n      let newKitsLastRowIndex = newKitsLastRow.rowIndex;\r\n      let dataRange = wsNewKit.getRange(`A2:B${newKitsLastRowIndex + 1}`);\r\n      dataRange.load(\"values\");\r\n      await context.sync();\r\n      let newKitData = dataRange.values;\r\n      let salesHistory = {};\r\n      \r\n      // Get discount percentage from L2\r\n      let discountPercentage = 0;\r\n      try {\r\n        const discountRange = wsNewKit.getRange(\"L2\");\r\n        discountRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        if (discountRange.values[0][0] !== null && discountRange.values[0][0] !== \"\" && !isNaN(discountRange.values[0][0])) {\r\n          discountPercentage = parseFloat(discountRange.values[0][0]);\r\n          console.log(\"Using discount percentage:\", discountPercentage);\r\n        }\r\n      } catch (error) {\r\n        console.log(\"Error reading discount from L2, using 0% discount\");\r\n      }\r\n      \r\n      // Function to apply monthly price increases cumulatively\r\n      const getAdjustedPrice = (basePrice, targetDate, increaseMap) => {\r\n        if (increaseMap.size === 0) return basePrice;\r\n        \r\n        const currentDate = new Date();\r\n        const targetMonthKey = formatDate(targetDate);\r\n        \r\n        // If target date is before current date, no increases applied\r\n        if (targetDate < currentDate) return basePrice;\r\n        \r\n        // Sort all increase months chronologically\r\n        const sortedIncreaseMonths = Array.from(increaseMap.keys()).sort();\r\n        \r\n        let adjustedPrice = basePrice;\r\n        let cumulativeIncrease = 1;\r\n        \r\n        // Apply all increases that occur before or in the target month\r\n        for (const increaseMonth of sortedIncreaseMonths) {\r\n          if (increaseMonth <= targetMonthKey) {\r\n            const increaseRate = increaseMap.get(increaseMonth);\r\n            cumulativeIncrease *= (1 + increaseRate);\r\n          }\r\n        }\r\n        \r\n        adjustedPrice = basePrice * cumulativeIncrease;\r\n        return adjustedPrice;\r\n      };\r\n      \r\n      //Get the Kit Revenue for each Kit and total Revenue with discount applied\r\n      let calculatedKitData = newKitData.map((row) => {\r\n        let currentMonthKey = formatDate(excelSerialDateToJSDate(row[0]))\r\n        if(!isPastMonth(currentMonthKey)){\r\n          salesHistory[currentMonthKey] = row[1];\r\n        }\r\n        let numberOfKits = row[1];\r\n        const rowDate = excelSerialDateToJSDate(row[0]);\r\n        \r\n        // Calculate base prices with monthly increases applied\r\n        let EMK1_base_retail = getAdjustedPrice(emkDetails[\"EMK1\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK5_base_retail = getAdjustedPrice(emkDetails[\"EMK5\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK10_base_retail = getAdjustedPrice(emkDetails[\"EMK10\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK15_base_retail = getAdjustedPrice(emkDetails[\"EMK15\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK1Mini_base_retail = getAdjustedPrice(emkDetails[\"EMK1-Mini\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK10Mini_base_retail = getAdjustedPrice(emkDetails[\"EMK10-Mini\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        \r\n        let EMK1_base =\r\n          Math.floor(emkDetails[\"EMK1\"].newKitShares * numberOfKits) *\r\n          EMK1_base_retail;\r\n        let EMK5_base =\r\n          Math.floor(emkDetails[\"EMK5\"].newKitShares * numberOfKits) *\r\n          EMK5_base_retail;\r\n        let EMK10_base =\r\n          Math.floor(emkDetails[\"EMK10\"].newKitShares * numberOfKits) *\r\n          EMK10_base_retail;\r\n        let EMK15_base =\r\n          Math.floor(emkDetails[\"EMK15\"].newKitShares * numberOfKits) *\r\n          EMK15_base_retail;\r\n        let EMK1Mini_base =\r\n          Math.floor(emkDetails[\"EMK1-Mini\"].newKitShares * numberOfKits) *\r\n          EMK1Mini_base_retail;\r\n        let EMK10Mini_base =\r\n          Math.floor(emkDetails[\"EMK10-Mini\"].newKitShares * numberOfKits) *\r\n          EMK10Mini_base_retail;\r\n        \r\n        // Apply discount to total revenue\r\n        let totalBaseRevenue = EMK1_base + EMK5_base + EMK10_base + EMK15_base + EMK1Mini_base + EMK10Mini_base;\r\n        let totalDiscountedRevenue = totalBaseRevenue * (1 - discountPercentage);\r\n        \r\n        // Apply discount to individual kit revenues\r\n        let EMK1 = EMK1_base * (1 - discountPercentage);\r\n        let EMK5 = EMK5_base * (1 - discountPercentage);\r\n        let EMK10 = EMK10_base * (1 - discountPercentage);\r\n        let EMK15 = EMK15_base * (1 - discountPercentage);\r\n        let EMK1Mini = EMK1Mini_base * (1 - discountPercentage);\r\n        let EMK10Mini = EMK10Mini_base * (1 - discountPercentage);\r\n        \r\n        return [\r\n          row[0],\r\n          row[1],\r\n          totalDiscountedRevenue,\r\n          \"\",\r\n          EMK1,\r\n          EMK5,\r\n          EMK10,\r\n          EMK15,\r\n          EMK1Mini,\r\n          EMK10Mini,\r\n        ];\r\n      });\r\n      \r\n      //Add the Kit Revenue to the sheet (only up to column J to preserve discount in L)\r\n      wsNewKit.getRange(\"A2:J\" + (calculatedKitData.length + 1)).values = calculatedKitData;\r\n      \r\n      //Get the drugs that belong to each Kit\r\n      data.values.forEach((row) => {\r\n        row[8] === \"X\" ? emkDetails[\"EMK1\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[9] === \"X\" ? emkDetails[\"EMK5\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[10] === \"X\" ? emkDetails[\"EMK10\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[11] === \"X\" ? emkDetails[\"EMK15\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[12] === \"X\" ? emkDetails[\"EMK1-Mini\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[13] === \"X\" ? emkDetails[\"EMK10-Mini\"][\"drugs\"].push(row[0]) : \"\";\r\n      });\r\n// ========== NEW TAKEOVER KIT CALCULATIONS ==========\r\nlet takeoverRevenueMap = new Map();\r\nlet takeoverDrugPredictions = [];\r\nlet drugsTakeoverExpirationPredictions = context.workbook.worksheets.getItem(\r\n  \"Replenish Dates(TakoverKits)\"\r\n);\r\ndrugsTakeoverExpirationPredictions\r\n  .getRangeByIndexes(1, 0, 10000, 50)\r\n  .clear(Excel.ClearApplyTo.contents);\r\nawait context.sync();\r\n\r\ntry {\r\n  // Get Takeover Drug Details\r\n  let wsTakeoverDrugDetails = context.workbook.worksheets.getItem(\"TakeOverDrugDetails\");\r\n  let takeoverDrugsUsedRange = wsTakeoverDrugDetails.getUsedRange();\r\n  takeoverDrugsUsedRange.load([\"rowIndex\", \"rowCount\"]);\r\n  await context.sync();\r\n  \r\n  let takeoverDrugsLastRow = takeoverDrugsUsedRange.rowCount;\r\n  let takeoverDrugsDataRange = wsTakeoverDrugDetails.getRange(`A2:C${takeoverDrugsLastRow + 1}`);\r\n  takeoverDrugsDataRange.load(\"values\");\r\n  await context.sync();\r\n  \r\n  console.log(`Takeover Drug Details rows: ${takeoverDrugsDataRange.values.length}`);\r\n  console.log(\"Takeover Drug Details sample:\", takeoverDrugsDataRange.values.slice(0, 5));\r\n\r\n  // Create takeover drug details object grouped by kit\r\n  let takeoverDrugDetails = {};\r\n  let drugCount = 0;\r\n  \r\n  takeoverDrugsDataRange.values.forEach((row, index) => {\r\n    if (row[0] && row[0].toString().trim() !== \"\") {\r\n      const drugName = row[0].toString().trim();\r\n      const kit = row[1] ? row[1].toString().trim() : \"\";\r\n      const daysToFirstReplenishment = row[2] && !isNaN(row[2]) ? parseInt(row[2]) : 0;\r\n      \r\n      if (kit) {\r\n        if (!takeoverDrugDetails[kit]) {\r\n          takeoverDrugDetails[kit] = [];\r\n        }\r\n        \r\n        // Get drug price and shelf life from main drug details\r\n        const drugPrice = medsObj[drugName] ? medsObj[drugName].laCarte : 0;\r\n        const shelfLife = medsObj[drugName] ? medsObj[drugName].shelfLife : 0;\r\n        \r\n        if (drugPrice > 0 && daysToFirstReplenishment > 0) {\r\n          takeoverDrugDetails[kit].push({\r\n            drugName: drugName,\r\n            daysToFirstReplenishment: daysToFirstReplenishment,\r\n            price: drugPrice,\r\n            shelfLife: shelfLife\r\n          });\r\n          drugCount++;\r\n        } else {\r\n          console.log(`Skipping drug ${drugName} - price: ${drugPrice}, days: ${daysToFirstReplenishment}`);\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  console.log(`Loaded ${drugCount} valid takeover drugs across kits:`, Object.keys(takeoverDrugDetails));\r\n  Object.keys(takeoverDrugDetails).forEach(kit => {\r\n    console.log(`  ${kit}: ${takeoverDrugDetails[kit].length} drugs`);\r\n  });\r\n\r\n  // Get New Takeover Kit Data\r\n  let wsNewTakeoverKitData = context.workbook.worksheets.getItem(\"New Takover Kit Data\");\r\n  let takeoverKitsUsedRange = wsNewTakeoverKitData.getUsedRange();\r\n  takeoverKitsUsedRange.load([\"rowIndex\", \"rowCount\", \"columnCount\"]);\r\n  await context.sync();\r\n  \r\n  let takeoverKitsLastRow = takeoverKitsUsedRange.rowCount;\r\n  let takeoverKitsDataRange = wsNewTakeoverKitData.getRange(`A2:G${takeoverKitsLastRow + 1}`);\r\n  takeoverKitsDataRange.load(\"values\");\r\n  await context.sync();\r\n  \r\n  console.log(`Takeover Kit Data rows: ${takeoverKitsDataRange.values.length}`);\r\n  console.log(\"Takeover Kit Data sample:\", takeoverKitsDataRange.values.slice(0, 3));\r\n\r\n  // Process takeover kit data\r\n  \r\n  const kitColumns = {\r\n    1: \"EMK1\",\r\n    2: \"EMK5\", \r\n    3: \"EMK10\",\r\n    4: \"EMK15\",\r\n    5: \"EMK1-Mini\",\r\n    6: \"EMK10-Mini\"\r\n  };\r\n\r\n  let totalProcessed = 0;\r\n  let monthlyBreakdown = {};\r\n\r\n  takeoverKitsDataRange.values.forEach((row, rowIndex) => {\r\n    const takeoverDate = excelSerialDateToJSDate(row[0]);\r\n    const takeoverMonthKey = formatDate(takeoverDate);\r\n    \r\n    console.log(`\\nProcessing month: ${takeoverMonthKey}`);\r\n    monthlyBreakdown[takeoverMonthKey] = { kits: 0, drugs: 0, revenue: 0 };\r\n    \r\n    // Process each kit type in this month\r\n    for (let i = 1; i <= 6; i++) {\r\n      const kitName = kitColumns[i];\r\n      const numberOfTakeovers = row[i] && !isNaN(row[i]) ? parseInt(row[i]) : 0;\r\n      \r\n      console.log(`  ${kitName}: ${numberOfTakeovers} takeovers`);\r\n      \r\n      if (numberOfTakeovers > 0 && takeoverDrugDetails[kitName]) {\r\n        monthlyBreakdown[takeoverMonthKey].kits += numberOfTakeovers;\r\n        \r\n        // For each drug in this kit, calculate replenishments\r\n        takeoverDrugDetails[kitName].forEach(drug => {\r\n          if (drug.price && !isNaN(drug.price) && drug.daysToFirstReplenishment > 0 && drug.shelfLife && !isNaN(drug.shelfLife)) {\r\n            \r\n            // Check if this drug is in the FREE_DRUGS list\r\n            const isFreeDrug = FREE_DRUGS.has(drug.drugName.trim());\r\n            \r\n            // Calculate first replenishment date\r\n            const firstReplenishDate = new Date(takeoverDate);\r\n            firstReplenishDate.setUTCDate(firstReplenishDate.getUTCDate() + drug.daysToFirstReplenishment);\r\n            const firstReplenishMonthKey = formatDate(firstReplenishDate);\r\n            \r\n            // Generate ALL replenishment dates\r\n            const replenishmentDates = [];\r\n            const replenishmentRevenues = [];\r\n            \r\n            for (let i = 0; i < 10; i++) {\r\n              const expireDate = new Date(firstReplenishDate);\r\n              expireDate.setUTCDate(expireDate.getUTCDate() + drug.shelfLife * i);\r\n              \r\n              const expireYear = expireDate.getUTCFullYear();\r\n              const expireMonth = String(expireDate.getUTCMonth() + 1).padStart(2, \"0\");\r\n              const monthKey = `${expireYear}-${expireMonth}`;\r\n              \r\n              replenishmentDates.push(monthKey);\r\n              \r\n              // Calculate revenue based on whether drug is free and if it's first replenishment\r\n              let drugRevenue = 0;\r\n              if (isFreeDrug) {\r\n                // For free drugs: FIRST replenishment is charged, SUBSEQUENT ones are FREE\r\n                drugRevenue = (i === 0) ? (drug.price * numberOfTakeovers) : 0;\r\n              } else {\r\n                // For regular drugs: ALL replenishments are charged\r\n                drugRevenue = drug.price * numberOfTakeovers;\r\n              }\r\n              \r\n              replenishmentRevenues.push(drugRevenue);\r\n              \r\n              // Add revenue to EACH replenishment month\r\n              const currentRevenue = takeoverRevenueMap.get(monthKey) || 0;\r\n              takeoverRevenueMap.set(monthKey, currentRevenue + drugRevenue);\r\n              // console.log(\"ALvin starts Here\")\r\n              // console.log(`${drug.drugName}: ${numberOfTakeovers}  $${drug.price} = $${drugRevenue}, replenish ${i+1}: ${monthKey} ${isFreeDrug ? (i === 0 ? '(FREE_DRUG - FIRST REPLENISHMENT CHARGED)' : '(FREE_DRUG - SUBSEQUENT FREE)') : '(REGULAR DRUG - CHARGED)'}`);\r\n            }\r\n            \r\n            totalProcessed++;\r\n            monthlyBreakdown[takeoverMonthKey].drugs++;\r\n            monthlyBreakdown[takeoverMonthKey].revenue += replenishmentRevenues[0]; // Count first replenishment revenue\r\n            \r\n            // Add to drug predictions for tracking\r\n            takeoverDrugPredictions.push([\r\n              takeoverMonthKey,\r\n              kitName + \" (Takeover)\",\r\n              drug.drugName,\r\n              numberOfTakeovers,\r\n              replenishmentRevenues[0], // First replenishment revenue\r\n              drug.shelfLife,\r\n              drug.daysToFirstReplenishment,\r\n              ...replenishmentDates\r\n            ]);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  console.log(`\\n=== TAKEOVER PROCESSING SUMMARY ===`);\r\n  console.log(`Total drug entries processed: ${totalProcessed}`);\r\n  console.log(`Monthly breakdown:`, monthlyBreakdown);\r\n  console.log(`Takeover Revenue Map entries: ${takeoverRevenueMap.size}`);\r\n  console.log(\"Takeover Revenue Map sample:\", Array.from(takeoverRevenueMap.entries()).slice(0, 10));\r\n  console.log(`Takeover Drug Predictions count: ${takeoverDrugPredictions.length}`);\r\n\r\n  // Add takeover drug predictions to the main drug predictions sheet\r\n  if (takeoverDrugPredictions.length > 0) {\r\n    const currentPredictionsRange = drugsTakeoverExpirationPredictions.getUsedRange();\r\n    let currentRowCount = 1;\r\n    if (currentPredictionsRange) {\r\n      currentPredictionsRange.load(\"rowCount\");\r\n      await context.sync();\r\n      currentRowCount = currentPredictionsRange.rowCount;\r\n    }\r\n    \r\n    console.log(`Adding ${takeoverDrugPredictions.length} takeover predictions starting at row ${currentRowCount}`);\r\n    \r\n    drugsTakeoverExpirationPredictions.getRangeByIndexes(\r\n      currentRowCount,\r\n      0,\r\n      takeoverDrugPredictions.length,\r\n      takeoverDrugPredictions[0].length\r\n    ).values = takeoverDrugPredictions;\r\n  } else {\r\n    console.log(\"No takeover predictions to add!\");\r\n  }\r\n\r\n} catch (error) {\r\n  console.log(\"Error processing takeover kit data:\", error);\r\n}\r\n// ========== END TAKEOVER KIT CALCULATIONS ==========\r\n      \r\n      //Creating calculation for all drugs per month with monthly price increases\r\n      let newKitDrugPredictions = [];\r\n      Object.keys(salesHistory).forEach((month) => {\r\n        let totalKitAmount = salesHistory[month];\r\n        Object.keys(emkDetails).forEach((kit) => {\r\n          let kitAmount = Math.floor(totalKitAmount * emkDetails[kit].newKitShares);\r\n          if (kitAmount < 1) return;\r\n          emkDetails[kit].drugs.forEach((drug) => {\r\n            if (medsObj[drug].shelfLife == \"\" || medsObj[drug].shelfLife == \"N/A\") return;\r\n            \r\n            // Check if this drug should be free for replenishment\r\n            const isFreeDrug = FREE_DRUGS.has(drug.trim());\r\n            \r\n            // Apply monthly increase to drug price, but set to 0 if free\r\n            const drugDate = parseMonthString(month);\r\n            const adjustedDrugPrice = isFreeDrug ? 0 : getAdjustedPrice(medsObj[drug].basePrice, drugDate, monthlyIncreaseMap);\r\n            \r\n            newKitDrugPredictions.push([\r\n              month,\r\n              kit,\r\n              drug,\r\n              kitAmount,\r\n              adjustedDrugPrice * kitAmount, // Use adjusted price (0 if free)\r\n              medsObj[drug].shelfLife,\r\n            ]);\r\n          });\r\n        });\r\n      });\r\n\r\n      //Adding Replenish Dates to the Drug Details\r\n      const updatedDrugData = newKitDrugPredictions.map((row) => {\r\n        const [date, code, description, qty, total, expiryDays] = row;\r\n        const [year, month] = date.split(\"-\").map(Number);\r\n        const baseDate = new Date(Date.UTC(year, month - 1, 1)); // Use UTC\r\n\r\n        const replenishments = [];\r\n\r\n        for (let i = 1; i <= 10; i++) {\r\n          const expireDate = new Date(baseDate);\r\n          expireDate.setUTCDate(expireDate.getUTCDate() + expiryDays * i); // Use UTC\r\n\r\n          const expireYear = expireDate.getUTCFullYear();\r\n          const expireMonth = String(expireDate.getUTCMonth() + 1).padStart(2, \"0\");\r\n\r\n          replenishments.push(`${expireYear}-${expireMonth}`);\r\n        }\r\n\r\n        return [...row, ...replenishments];\r\n      });\r\n      \r\n      drugsExpirationPredictions.getRangeByIndexes(\r\n        1,\r\n        0,\r\n        updatedDrugData.length,\r\n        updatedDrugData[0].length\r\n      ).values = updatedDrugData;\r\n      \r\n      // --- Step 5: Execute everything\r\n      const baseMap = getBaseKitMap(calculatedKitData);\r\n      const forecastMap = generateForecast(\"2025-07\", 300, baseMap);\r\n\r\n      // Plug in your generated updatedDrugData (with replenishment dates)\r\n      let drugDataMap = applyDrugDataRevenue(forecastMap, updatedDrugData);\r\n      let usedRangeAutoReplenishMedGroups = wsAutoReplenishMedGroups.getUsedRange();\r\n      let lastRowAutoReplenishMedGroups = usedRangeAutoReplenishMedGroups.getLastRow();\r\n      lastRowAutoReplenishMedGroups.load(\"rowIndex\");\r\n      await context.sync();\r\n      \r\n      //Get Autor replenish sheet data\r\n      let rangeAutoReplenishMedGroupsAll = wsAutoReplenishMedGroups.getRangeByIndexes(\r\n        2,\r\n        0,\r\n        lastRowAutoReplenishMedGroups.rowIndex - 1,\r\n        6\r\n      );\r\n      rangeAutoReplenishMedGroupsAll.load(\"values\");\r\n      await context.sync();\r\n      \r\n      //Add the Future expiration dates for the auto replenishments with monthly price increases\r\n      const outputAutoReplenishAndForecast = [\r\n        [\r\n          \"Group\",\r\n          \"Company\",\r\n          \"Medication\",\r\n          \"Expiration\",\r\n          \"Price\",\r\n          \"Auto Replenish\",\r\n          \"Generated Dates\",\r\n        ],\r\n      ];\r\n\r\n      for (const row of rangeAutoReplenishMedGroupsAll.values) {\r\n        const [group, company, medication, expirationStr, price, autoReplenish] = row;\r\n\r\n        if (autoReplenish !== \"Enabled\" || expirationStr == \"N/A\" || expirationStr == \"\") continue;\r\n\r\n        const config = medsObj[medication];\r\n        const baseDate = excelSerialDateToJSDate(expirationStr);\r\n\r\n        // Check if this medication should be free\r\n        const isFreeDrug = FREE_DRUGS.has(medication.trim());\r\n        const adjustedPrice = isFreeDrug ? 0 : (baseDate ? getAdjustedPrice(price, baseDate, monthlyIncreaseMap) : price);\r\n\r\n        // Always include original (keep existing records even if no shelf life)\r\n        outputAutoReplenishAndForecast.push([\r\n          group,\r\n          company,\r\n          medication,\r\n          baseDate ? formatMonth(baseDate) : \"N/A\",\r\n          adjustedPrice,\r\n          autoReplenish,\r\n          \"\",\r\n        ]);\r\n\r\n        // Only create future replenishments if shelf life exists and is valid\r\n        if (!config || !baseDate || !config.shelfLife || config.shelfLife === \"\" || config.shelfLife === \"N/A\" || isNaN(config.shelfLife)){ \r\n          continue\r\n        };\r\n\r\n        const shelfLife = parseInt(config.shelfLife);\r\n        if (shelfLife <= 0) continue;\r\n\r\n        for (let i = 1; i <= 20; i++) {\r\n          const futureDate = addDays(baseDate, shelfLife * i);\r\n          const futureAdjustedPrice = isFreeDrug ? 0 : getAdjustedPrice(price, futureDate, monthlyIncreaseMap);\r\n          \r\n          outputAutoReplenishAndForecast.push([\r\n            group,\r\n            company,\r\n            medication,\r\n            formatMonth(futureDate),\r\n            parseFloat(futureAdjustedPrice.toFixed(2)),\r\n            autoReplenish,\r\n            \"Generated\",\r\n          ]);\r\n        }\r\n      }\r\n\r\n      // Get AED Auto Replenish groups data\r\n      let wsAutoReplenishAEDGroups = context.workbook.worksheets.getItem(\"auto_replenish_aed_groups\");\r\n      let usedRangeAutoReplenishAEDGroups = wsAutoReplenishAEDGroups.getUsedRange();\r\n      let lastRowAutoReplenishAEDGroups = usedRangeAutoReplenishAEDGroups.getLastRow();\r\n      lastRowAutoReplenishAEDGroups.load(\"rowIndex\");\r\n      await context.sync();\r\n      \r\n      let rangeAutoReplenishAEDGroupsAll = wsAutoReplenishAEDGroups.getRangeByIndexes(\r\n        2,\r\n        0,\r\n        lastRowAutoReplenishAEDGroups.rowIndex - 1,\r\n        6\r\n      );\r\n      rangeAutoReplenishAEDGroupsAll.load(\"values\");\r\n      await context.sync();\r\n      \r\n      console.log(\"AED Auto Replenish data:\", rangeAutoReplenishAEDGroupsAll.values);\r\n      \r\n      // Add AED Auto Replenish data with monthly price increases\r\n      const outputAEDAutoReplenishAndForecast = [\r\n        [\r\n          \"Group\",\r\n          \"Company\",\r\n          \"AED Item\",\r\n          \"Expiration\",\r\n          \"Price\",\r\n          \"Auto Replenish\",\r\n          \"Generated Dates\",\r\n        ],\r\n      ];\r\n\r\n      for (const row of rangeAutoReplenishAEDGroupsAll.values) {\r\n        const [group, company, aedItem, expirationStr, price, autoReplenish] = row;\r\n\r\n        if (autoReplenish !== \"Enabled\") continue;\r\n\r\n        // Clean up the AED item name to match the AED_Details sheet\r\n        const cleanAEDItem = aedItem ? aedItem.toString().trim() : '';\r\n        \r\n        const config = aedMedsObj[cleanAEDItem];\r\n        const baseDate = expirationStr && expirationStr !== \"N/A\" && expirationStr !== \"\" \r\n          ? excelSerialDateToJSDate(expirationStr) \r\n          : null;\r\n\r\n        // Check if this AED item should be free\r\n        const isFreeDrug = FREE_DRUGS.has(cleanAEDItem);\r\n        const adjustedPrice = isFreeDrug ? 0 : (baseDate ? getAdjustedPrice(price, baseDate, monthlyIncreaseMap) : price);\r\n\r\n        // Always include original (keep existing records even if no shelf life or expiration)\r\n        outputAEDAutoReplenishAndForecast.push([\r\n          group,\r\n          company,\r\n          cleanAEDItem,\r\n          baseDate ? formatMonth(baseDate) : \"N/A\",\r\n          adjustedPrice,\r\n          autoReplenish,\r\n          \"\",\r\n        ]);\r\n\r\n        // Only create future replenishments if we have valid expiration date AND shelf life\r\n        if (!baseDate || !config || !config.shelfLife || config.shelfLife === \"\" || config.shelfLife === \"N/A\" || isNaN(config.shelfLife)){ \r\n          continue\r\n        };\r\n\r\n        const shelfLife = parseInt(config.shelfLife);\r\n        if (shelfLife <= 0) continue;\r\n\r\n        for (let i = 1; i <= 20; i++) {\r\n          const futureDate = addDays(baseDate, shelfLife * i);\r\n          const futureAdjustedPrice = isFreeDrug ? 0 : getAdjustedPrice(price, futureDate, monthlyIncreaseMap);\r\n          \r\n          outputAEDAutoReplenishAndForecast.push([\r\n            group,\r\n            company,\r\n            cleanAEDItem,\r\n            formatMonth(futureDate),\r\n            parseFloat(futureAdjustedPrice.toFixed(2)),\r\n            autoReplenish,\r\n            \"Generated\",\r\n          ]);\r\n        }\r\n      }\r\n\r\n      console.log(\"AED Auto Replenish processed items:\", outputAEDAutoReplenishAndForecast.length);\r\n\r\n      // Auto-replenish items (only applied once) - Keep separate for different columns\r\n      let autoReplenish = applyAutoReplenishOnce(forecastMap, outputAutoReplenishAndForecast);\r\n      let aedAutoReplenish = applyAutoReplenishOnce(forecastMap, outputAEDAutoReplenishAndForecast);\r\n      \r\n      console.log(\"Regular Auto Replenish:\", autoReplenish);\r\n      console.log(\"AED Auto Replenish:\", aedAutoReplenish);\r\n\r\n      // 1. Combine all unique months\r\n      const allMonths = new Set([\r\n        ...drugDataMap.keys(),\r\n        ...autoReplenish.keys(),\r\n        ...aedAutoReplenish.keys(),\r\n        ...baseMap.keys(),\r\n        ...forecastMap.keys(),\r\n        ...takeoverRevenueMap.keys(), // Add takeover months\r\n      ]);\r\n\r\n      // 2. Generate final forecast array with separate AED Auto Replenish column\r\n      const finalRevenueForecast = [];\r\n      const currentMonth = getCurrentMonthUTC();\r\n      const currentMonthKey = formatMonth(currentMonth);\r\n      \r\n      // Get the percentage from Non-Auto Replenish sheet\r\n      let nonAutoReplenishSheet;\r\n      let nonAutoPercentage = 0.25; // Default to 25%\r\n      \r\n      try {\r\n        nonAutoReplenishSheet = context.workbook.worksheets.getItem(\"Non-Auto Replenish\");\r\n        const g2Range = nonAutoReplenishSheet.getRange(\"G2\");\r\n        const h2Range = nonAutoReplenishSheet.getRange(\"H2\");\r\n        \r\n        g2Range.load(\"values\");\r\n        h2Range.load(\"values\");\r\n        await context.sync();\r\n        \r\n        // Use H2 if not empty, otherwise use G2\r\n        if (h2Range.values[0][0] !== null && h2Range.values[0][0] !== \"\" && !isNaN(h2Range.values[0][0])) {\r\n          nonAutoPercentage = parseFloat(h2Range.values[0][0]);\r\n        } else if (g2Range.values[0][0] !== null && g2Range.values[0][0] !== \"\" && !isNaN(g2Range.values[0][0])) {\r\n          nonAutoPercentage = parseFloat(g2Range.values[0][0]);\r\n        }\r\n        \r\n        console.log(\"Using Non-Auto Replenishment percentage:\", nonAutoPercentage);\r\n      } catch (error) {\r\n        console.log(\"Non-Auto Replenish sheet not found or error reading values, using default 25%\");\r\n      }\r\n\r\n      // Get AED sales value\r\n      let aedSalesValue = 0;\r\n      try {\r\n        const aedSalesSheet = context.workbook.worksheets.getItem(\"AED Sales\");\r\n        const aedSalesRange = aedSalesSheet.getRange(\"G2\");\r\n        aedSalesRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        if (aedSalesRange.values[0][0] !== null && aedSalesRange.values[0][0] !== \"\" && !isNaN(aedSalesRange.values[0][0])) {\r\n          aedSalesValue = parseFloat(aedSalesRange.values[0][0]);\r\n        }\r\n        \r\n        console.log(\"Using AED Sales value:\", aedSalesValue);\r\n      } catch (error) {\r\n        console.log(\"AED Sales sheet not found or error reading G2 value, using 0\");\r\n      }\r\n\r\n      // Sort months chronologically\r\n      const sortedMonths = [...allMonths].sort();\r\n      \r\n      for (const month of sortedMonths) {\r\n        const newkit = baseMap.get(month) || 0;\r\n        const auto = autoReplenish.get(month) || 0;\r\n        const aedAuto = aedAutoReplenish.get(month) || 0;\r\n        const drugData = drugDataMap.get(month) || 0;\r\n        const takeoverRevenue = takeoverRevenueMap.get(month) || 0; // New takeover revenue\r\n        \r\n        // Calculate Non-Auto Replenishment (25% of Auto Replenish, only for future months)\r\n        const nonAutoReplenishment = (month > currentMonthKey) ? auto * nonAutoPercentage : 0;\r\n        \r\n        // Calculate AED Sales (only for future months)\r\n        const aedSales = (month > currentMonthKey) ? aedSalesValue : 0;\r\n        \r\n        // Update total revenue to include all components including takeover revenue\r\n        const totalRevenue = newkit + auto + aedAuto + drugData + nonAutoReplenishment + aedSales + takeoverRevenue;\r\n\r\n        finalRevenueForecast.push([\r\n          month, \r\n          totalRevenue, \r\n          newkit, \r\n          auto, \r\n          drugData,\r\n          nonAutoReplenishment,\r\n          aedSales,\r\n          aedAuto,  // Column H: AED Auto Replenish\r\n          takeoverRevenue  // Column I: New Takeover Kit Revenue\r\n        ]);\r\n      }\r\n\r\n      // Update the range to include column I (takeover revenue)\r\n      wsRevenuePredictions.getRangeByIndexes(\r\n        1,\r\n        0,\r\n        finalRevenueForecast.length,\r\n        finalRevenueForecast[0].length\r\n      ).values = finalRevenueForecast;\r\n      \r\n      // Add headers including takeover revenue\r\n      const headers = [\r\n        \"Month\", \r\n        \"Total Revenue\", \r\n        \"New Kit Revenue\", \r\n        \"Auto Replenish\", \r\n        \"Drug Data Revenue\",\r\n        \"Non-Auto Replenishment\",\r\n        \"AED Sales\",\r\n        \"AED Auto Replenish\",\r\n        \"New Takeover Kit Revenue\"  // New column for takeover revenue\r\n      ];\r\n      wsRevenuePredictions.getRangeByIndexes(0, 0, 1, headers.length).values = [headers];\r\n      \r\n      await context.sync();\r\n      console.log(\"Final Revenue Forecast:\", finalRevenueForecast);\r\n      console.table(finalRevenueForecast);\r\n\r\n      // --- Separate History Sheets ---\r\n\r\n      // Regular AutoReplenishHistory (only regular auto replenish)\r\n      let autoReplenishDatesAndData = Array.from(autoReplenish.entries()).map(([month, value]) => [month, value]);\r\n      autoReplenishDatesAndData.sort((a, b) => a[0].localeCompare(b[0]));\r\n      \r\n      const sheet = context.workbook.worksheets.getItem(\"AutoReplenishHistory\");\r\n      \r\n      //Get last column\r\n      const autoReplenishHistoryUsedRange = sheet.getUsedRange();\r\n      autoReplenishHistoryUsedRange.load([\"columnIndex\", \"columnCount\",\"rowCount\"]);\r\n      await context.sync();\r\n      \r\n      // Load row 2 headers (row index 1)\r\n      if(autoReplenishHistoryUsedRange.columnCount > 1) {\r\n        const headerRange = sheet.getRangeByIndexes(1, 1, 1, autoReplenishHistoryUsedRange.columnCount-1);\r\n        const datesRange = sheet.getRangeByIndexes(2,0,autoReplenishHistoryUsedRange.rowCount-2,1);\r\n        headerRange.load(\"values\");\r\n        datesRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        console.log(\"Dates in History:\", datesRange.values);\r\n        const headersHistory = headerRange.values[0] // Row 2\r\n        let currentMonthFormatted = formatDateWithDay(new Date());\r\n        let currentMonthPostion = headersHistory.indexOf(currentMonthFormatted);\r\n        let datesInHistory = datesRange.values.map(x => x[0]);\r\n        \r\n        // Use normalized date comparison to find the correct starting row\r\n        let beginningDateIndex = findDateIndexInHistory(datesInHistory, autoReplenishDatesAndData[0][0]);\r\n        \r\n        console.log(\"Beginning Date Index:\", beginningDateIndex);\r\n        console.log(\"Target Date:\", autoReplenishDatesAndData[0][0]);\r\n        console.log(\"Current Month Position:\", currentMonthPostion);\r\n        \r\n        await context.sync();\r\n        \r\n        //Check if it exists in the headers\r\n        if(currentMonthPostion !== -1){ //it Exists\r\n          //Add data to the same column\r\n          sheet.getRangeByIndexes(2+beginningDateIndex,currentMonthPostion+1,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[1]])\r\n          sheet.getRangeByIndexes(2+beginningDateIndex,0,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[0]])\r\n        }\r\n        else{\r\n          //Add data to a new column(The last column) starting at index 1 \r\n          sheet.getRangeByIndexes(1, autoReplenishHistoryUsedRange.columnCount, 1, 1).numberFormat = [[\"@\"]]; // force text\r\n          sheet.getRangeByIndexes(1, autoReplenishHistoryUsedRange.columnCount, 1, 1).values = [[currentMonthFormatted]];\r\n          sheet.getRangeByIndexes(2+beginningDateIndex,autoReplenishHistoryUsedRange.columnCount,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[1]])\r\n          sheet.getRangeByIndexes(2+beginningDateIndex,0,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[0]])\r\n        }\r\n      }\r\n\r\n// AED AutoReplenishHistory - CORRECT FORMAT\r\nif (aedAutoReplenish.size > 0) {\r\n  try {\r\n    let aedAutoReplenishDatesAndData = Array.from(aedAutoReplenish.entries()).map(([month, value]) => [month, value]);\r\n    aedAutoReplenishDatesAndData.sort((a, b) => a[0].localeCompare(b[0]));\r\n    \r\n    // Create or get the AED History sheet\r\n    let aedHistorySheet;\r\n    try {\r\n      aedHistorySheet = context.workbook.worksheets.getItem(\"AutoReplenishAEDHistory\");\r\n    } catch (error) {\r\n      // Sheet doesn't exist, create it\r\n      aedHistorySheet = context.workbook.worksheets.add(\"AutoReplenishAEDHistory\");\r\n    }\r\n    \r\n    // Get existing data structure\r\n    const aedHistoryUsedRange = aedHistorySheet.getUsedRange();\r\n    let currentDateFormatted = formatDateWithDay(new Date());\r\n    \r\n    if (!aedHistoryUsedRange) {\r\n      // Initialize new sheet structure\r\n      // Set up headers - \"Report Dates\" in A1, \"Replenish Dates\" in A2\r\n      aedHistorySheet.getRange(\"A1\").values = [[\"Report Dates\"]];\r\n      aedHistorySheet.getRange(\"A2\").values = [[\"Replenish Dates\"]];\r\n      \r\n      // Write the months in column A starting from A3\r\n      let allMonths = [...new Set([...aedAutoReplenishDatesAndData.map(x => x[0])])].sort();\r\n      let datesColumn = allMonths.map(month => [month]);\r\n      aedHistorySheet.getRange(\"A3:A\" + (datesColumn.length + 2)).values = datesColumn;\r\n      \r\n      // Write current date as first column header in B2 (NOT B1)\r\n      aedHistorySheet.getRange(\"B2\").numberFormat = [[\"@\"]]; \r\n      aedHistorySheet.getRange(\"B2\").values = [[currentDateFormatted]];\r\n      console.log(\"Hello Alvin\");\r\n      // Write the AED values in column B starting from B3\r\n      let valuesColumn = allMonths.map(month => {\r\n        return [aedAutoReplenish.get(month) || 0];\r\n      });\r\n      aedHistorySheet.getRange(\"B3:B\" + (valuesColumn.length + 2)).values = valuesColumn;\r\n      \r\n    } else {\r\n      // Existing sheet with data - check if we need to add new column\r\n      aedHistoryUsedRange.load([\"columnCount\", \"rowCount\"]);\r\n      await context.sync();\r\n      \r\n      // Get the last column header from ROW 2 to check if it's the same date\r\n      const lastHeaderRange = aedHistorySheet.getRangeByIndexes(1, aedHistoryUsedRange.columnCount - 1, 1, 1);\r\n      lastHeaderRange.load(\"values\");\r\n      await context.sync();\r\n      \r\n      const lastHeaderDate = lastHeaderRange.values[0][0];\r\n      \r\n      // Only add new column if it's a different day\r\n      if (lastHeaderDate !== currentDateFormatted) {\r\n        // Get existing dates column (starting from row 3)\r\n        const datesColumnRange = aedHistorySheet.getRange(\"A3:A\" + aedHistoryUsedRange.rowCount);\r\n        datesColumnRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        const existingDates = datesColumnRange.values.map(row => row[0]).filter(date => date);\r\n        \r\n        // Add new column for current date\r\n        let newColumnIndex = aedHistoryUsedRange.columnCount;\r\n        \r\n        // Set up new column header in ROW 2\r\n        aedHistorySheet.getRangeByIndexes(1, newColumnIndex, 1, 1).numberFormat = [[\"@\"]];\r\n        aedHistorySheet.getRangeByIndexes(1, newColumnIndex, 1, 1).values = [[currentDateFormatted]];\r\n        \r\n        // Update values for existing dates starting from ROW 3\r\n        for (let i = 0; i < existingDates.length; i++) {\r\n          let month = existingDates[i];\r\n          let value = aedAutoReplenish.get(month) || 0;\r\n          aedHistorySheet.getRangeByIndexes(i + 2, newColumnIndex, 1, 1).values = [[value]];\r\n        }\r\n        \r\n        // Add any new months that don't exist in the dates column\r\n        let newMonths = aedAutoReplenishDatesAndData\r\n          .map(([month]) => month)\r\n          .filter(month => !existingDates.includes(month))\r\n          .sort();\r\n        \r\n        if (newMonths.length > 0) {\r\n          let startRow = existingDates.length + 2;\r\n          \r\n          // Add new months to column A starting from the next available row\r\n          aedHistorySheet.getRangeByIndexes(startRow, 0, newMonths.length, 1).values = newMonths.map(month => [month]);\r\n          \r\n          // Add values for new months in the new column\r\n          for (let i = 0; i < newMonths.length; i++) {\r\n            let month = newMonths[i];\r\n            let value = aedAutoReplenish.get(month) || 0;\r\n            aedHistorySheet.getRangeByIndexes(startRow + i, newColumnIndex, 1, 1).values = [[value]];\r\n          }\r\n        }\r\n        \r\n        console.log(\"New column added to AED AutoReplenishHistory for date:\", currentDateFormatted);\r\n      } else {\r\n        console.log(\"No new column added - same date as last run:\", currentDateFormatted);\r\n      }\r\n    }\r\n    \r\n    await context.sync();\r\n    console.log(\"AED AutoReplenishHistory updated successfully\");\r\n  } catch (error) {\r\n    console.log(\"Error creating/updating AutoReplenishAEDHistory:\", error);\r\n  }\r\n}\r\n  // Add this code right before the final await context.sync() and return context.sync() in your run function\r\n// Place it after you've populated the wsRevenuePredictions sheet\r\n\r\n// ========== YEARLY REVENUE SUMMARY ==========\r\ntry {\r\n  let yearlyRevenueSheet;\r\n  try {\r\n    yearlyRevenueSheet = context.workbook.worksheets.getItem(\"Yearly Revenue\");\r\n    // Clear existing data\r\n    yearlyRevenueSheet.getUsedRange().clear(Excel.ClearApplyTo.contents);\r\n  } catch (error) {\r\n    // Sheet doesn't exist, create it\r\n    yearlyRevenueSheet = context.workbook.worksheets.add(\"Yearly Revenue\");\r\n  }\r\n\r\n  // Get the revenue predictions data (skip header row)\r\n  const revenueDataRange = wsRevenuePredictions.getUsedRange();\r\n  revenueDataRange.load(\"values\");\r\n  await context.sync();\r\n  \r\n  const revenueData = revenueDataRange.values;\r\n  \r\n  // Skip header row (index 0) and process data rows\r\n  const yearlySummary = new Map();\r\n  \r\n  for (let i = 1; i < revenueData.length; i++) {\r\n    const row = revenueData[i];\r\n    if (!row || row.length < 9) continue;\r\n    \r\n    const [month, totalRevenue, newKit, autoReplenish, drugData, nonAuto, aedSales, aedAuto, takeoverRevenue] = row;\r\n    \r\n    // Extract year from month (format: \"YYYY-MM\")\r\n    const year = month.split('-')[0];\r\n    \r\n    if (!yearlySummary.has(year)) {\r\n      yearlySummary.set(year, {\r\n        total: 0,\r\n        newKit: 0,\r\n        autoReplenish: 0,\r\n        drugData: 0,\r\n        nonAuto: 0,\r\n        aedSales: 0,\r\n        aedAuto: 0,\r\n        takeover: 0\r\n      });\r\n    }\r\n    \r\n    const yearData = yearlySummary.get(year);\r\n    yearData.total += parseFloat(totalRevenue) || 0;\r\n    yearData.newKit += parseFloat(newKit) || 0;\r\n    yearData.autoReplenish += parseFloat(autoReplenish) || 0;\r\n    yearData.drugData += parseFloat(drugData) || 0;\r\n    yearData.nonAuto += parseFloat(nonAuto) || 0;\r\n    yearData.aedSales += parseFloat(aedSales) || 0;\r\n    yearData.aedAuto += parseFloat(aedAuto) || 0;\r\n    yearData.takeover += parseFloat(takeoverRevenue) || 0;\r\n  }\r\n  \r\n  // Convert map to array and sort by year\r\n  const yearlyArray = Array.from(yearlySummary.entries())\r\n    .map(([year, data]) => [year, data.total, data.newKit, data.autoReplenish, data.drugData, data.nonAuto, data.aedSales, data.aedAuto, data.takeover])\r\n    .sort((a, b) => a[0].localeCompare(b[0]));\r\n  \r\n  // Add headers\r\n  const headers = [\r\n    \"Year\", \r\n    \"Total Revenue\", \r\n    \"New Kit Revenue\", \r\n    \"Auto Replenish\", \r\n    \"Drug Data Revenue\",\r\n    \"Non-Auto Replenishment\",\r\n    \"AED Sales\",\r\n    \"AED Auto Replenish\",\r\n    \"New Takeover Kit Revenue\"\r\n  ];\r\n  \r\n  // Prepare data for Excel (headers + sorted yearly data)\r\n  const sheetData = [headers, ...yearlyArray];\r\n  \r\n  // Write to sheet\r\n  yearlyRevenueSheet.getRangeByIndexes(0, 0, sheetData.length, headers.length).values = sheetData;\r\n  \r\n  // Format the header row\r\n  const headerRange = yearlyRevenueSheet.getRangeByIndexes(0, 0, 1, headers.length);\r\n  headerRange.format.fill.color = \"#4472C4\";\r\n  headerRange.format.font.color = \"white\";\r\n  headerRange.format.font.bold = true;\r\n  \r\n  // Format numbers as currency\r\n  if (sheetData.length > 1) {\r\n    const dataRange = yearlyRevenueSheet.getRangeByIndexes(1, 1, sheetData.length - 1, headers.length - 1);\r\n    dataRange.numberFormat = [[\"$#,##0.00\"]];\r\n  }\r\n  \r\n  // Auto-fit columns for better readability\r\n  yearlyRevenueSheet.getUsedRange().format.autofitColumns();\r\n  \r\n  console.log(\"Yearly Revenue summary created successfully\");\r\n  console.table(yearlyArray);\r\n  \r\n} catch (error) {\r\n  console.log(\"Error creating Yearly Revenue summary:\", error);\r\n}\r\n// ========== END YEARLY REVENUE SUMMARY ==========      \r\n\r\n\r\n      await context.sync();\r\n      return context.sync();\r\n    });\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\n// ... (all helper functions remain exactly the same)\r\n\r\nfunction getDatesAndData(foreCastData=[[]]){\r\n  return foreCastData.map(\r\n    x => [x[0],x[3]]\r\n  )\r\n}\r\n\r\nfunction getBaseKitMap(baseKitRevenue) {\r\n  const map = new Map();\r\n\r\n  const now = getCurrentMonthUTC(); // Use UTC for consistency\r\n  const nextMonth = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth() + 1, 1));\r\n\r\n  baseKitRevenue.forEach(([dateStr, kitQuantity, revenue]) => {\r\n    const date = excelSerialDateToJSDate(dateStr);\r\n    if (date >= nextMonth) {\r\n      const key = `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, \"0\")}`;\r\n      map.set(key, revenue);\r\n    }\r\n  });\r\n\r\n  return map;\r\n}\r\n\r\nfunction generateForecast(start = \"2023-06\", months = 120, baseMap = new Map()) {\r\n  const forecast = new Map();\r\n  const [startYear, startMonth] = start.split(\"-\").map(Number);\r\n  const date = new Date(Date.UTC(startYear, startMonth - 1, 1)); // Use UTC\r\n\r\n  for (let i = 0; i < months; i++) {\r\n    const year = date.getUTCFullYear();\r\n    const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n    const key = `${year}-${month}`;\r\n    const baseRevenue = baseMap.get(key) || 0;\r\n    forecast.set(key, baseRevenue);\r\n    date.setUTCMonth(date.getUTCMonth() + 1);\r\n  }\r\n\r\n  return forecast;\r\n}\r\n\r\nfunction applyDrugDataRevenue(forecastMap, drugData) {\r\n  let drugDataMap = new Map();\r\n  for (const row of drugData) {\r\n    const total = parseFloat(row[4]);\r\n    const replenishmentDates = row.slice(6);\r\n    \r\n    replenishmentDates.forEach((date) => {\r\n      if (forecastMap.has(date)) {\r\n        forecastMap.set(date, forecastMap.get(date) + total);\r\n        drugDataMap.set(\r\n          date,\r\n          drugDataMap.get(date) != undefined ? drugDataMap.get(date) + total : total\r\n        );\r\n      }\r\n    });\r\n  }\r\n  return drugDataMap;\r\n}\r\n\r\nfunction applyAutoReplenishOnce(forecastMap, autoData) {\r\n  let autoReplenish = new Map();\r\n  autoData.forEach((row) => {\r\n    const [Group, Company, Medication, expDate, priceStr, status] = row;\r\n\r\n    if (status !== \"Enabled\") return;\r\n    const price = typeof priceStr == \"string\" ? parseFloat(priceStr.replace(\"$\", \"\")) : priceStr;\r\n\r\n    // Parse expiration date consistently\r\n    const date = parseMonthString(expDate);\r\n    if (!date) return;\r\n    \r\n    const key = `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, \"0\")}`;\r\n    \r\n    if (forecastMap.has(key)) {\r\n      if (!isNaN(price)) {\r\n        forecastMap.set(key, forecastMap.get(key) + price);\r\n        autoReplenish.set(\r\n          key,\r\n          autoReplenish.get(key) !== undefined ? autoReplenish.get(key) + price : price\r\n        );\r\n      }\r\n    }\r\n  });\r\n  return autoReplenish;\r\n}\r\n\r\n// ... (all helper functions remain the same)\r\n\r\n//  Helper Functions (Timezone Safe) \r\n\r\nfunction excelSerialDateToJSDate(serial) {\r\n  // More robust Excel serial date conversion with UTC\r\n  if (!serial || isNaN(serial)) return new Date(NaN);\r\n  \r\n  const utcDays = Math.floor(serial - 25569);\r\n  const utcValue = utcDays * 86400;\r\n  const dateInfo = new Date(utcValue * 1000);\r\n  \r\n  // Return UTC date to avoid timezone shifts\r\n  return new Date(Date.UTC(\r\n    dateInfo.getUTCFullYear(),\r\n    dateInfo.getUTCMonth(),\r\n    dateInfo.getUTCDate()\r\n  ));\r\n}\r\n\r\nfunction isPastMonth(inputDate) {\r\n  const today = getCurrentMonthUTC();\r\n  \r\n  const currentYear = today.getUTCFullYear();\r\n  const currentMonth = today.getUTCMonth() + 1;\r\n\r\n  let year, month;\r\n\r\n  if (inputDate instanceof Date) {\r\n    year = inputDate.getUTCFullYear();\r\n    month = inputDate.getUTCMonth() + 1;\r\n  } else if (typeof inputDate === \"string\") {\r\n    [year, month] = inputDate.split(\"-\").map(Number);\r\n  } else {\r\n    return false;\r\n  }\r\n\r\n  return (currentYear > year || (currentYear === year && currentMonth > month));\r\n}\r\n\r\nfunction formatDate(date) {\r\n  // Always use UTC to avoid timezone issues\r\n  const year = date.getUTCFullYear();\r\n  const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n  return `${year}-${month}`;\r\n}\r\n\r\nfunction formatDateWithDay(date) {\r\n  // Always use UTC to avoid timezone issues\r\n  const year = date.getUTCFullYear();\r\n  const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n  const day = String(date.getUTCDate()).padStart(2, \"0\");\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction formatMonth(dt) {\r\n  const y = dt.getUTCFullYear(),\r\n    m = String(dt.getUTCMonth() + 1).padStart(2, \"0\");\r\n  return `${y}-${m}`;\r\n}\r\n\r\nfunction addDays(dt, n) {\r\n  // Use UTC to avoid DST issues\r\n  const result = new Date(dt);\r\n  result.setUTCDate(result.getUTCDate() + n);\r\n  return result;\r\n}\r\n\r\nfunction getCurrentMonthUTC() {\r\n  const now = new Date();\r\n  return new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), 1));\r\n}\r\n\r\nfunction parseMonthString(ym) {\r\n  // Robust parsing of various date formats\r\n  if (!ym || ym === \"N/A\") return new Date(NaN);\r\n  \r\n  try {\r\n    // Handle \"YYYY-MM\" format\r\n    if (/^\\d{4}-\\d{2}$/.test(ym)) {\r\n      const [y, m] = ym.split(\"-\").map(Number);\r\n      return new Date(Date.UTC(y, m - 1, 1));\r\n    }\r\n    \r\n    // Handle \"MM/DD/YYYY\" or other formats\r\n    const parsed = new Date(ym);\r\n    if (isNaN(parsed.getTime())) return new Date(NaN);\r\n    \r\n    // Convert to UTC first day of month\r\n    return new Date(Date.UTC(parsed.getUTCFullYear(), parsed.getUTCMonth(), 1));\r\n  } catch (e) {\r\n    return new Date(NaN);\r\n  }\r\n}\r\n\r\nfunction findDateIndexInHistory(datesInHistory, targetDate) {\r\n  // Normalize both dates for comparison\r\n  const normalizedTarget = normalizeDateForComparison(targetDate);\r\n  \r\n  for (let i = 0; i < datesInHistory.length; i++) {\r\n    const normalizedHistory = normalizeDateForComparison(datesInHistory[i]);\r\n    if (normalizedTarget.getTime() === normalizedHistory.getTime()) {\r\n      return i;\r\n    }\r\n  }\r\n  \r\n  console.warn(\"Target date not found in history, using index 0\");\r\n  return 0;\r\n}\r\n\r\nfunction normalizeDateForComparison(dateStr) {\r\n  // Handle both \"YYYY-MM\" and \"YYYY-MM-DD\" formats\r\n  const parts = dateStr.split('-');\r\n  const year = parseInt(parts[0]);\r\n  const month = parseInt(parts[1]);\r\n  \r\n  // Always return the first day of month in UTC for consistent comparison\r\n  return new Date(Date.UTC(year, month - 1, 1));\r\n}\r\n\r\n// Legacy function kept for compatibility\r\nfunction parseMonth(ym) {\r\n  return parseMonthString(ym);\r\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Protect It First Functions</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header style=\\\"display:flex;justify-content:center;align-items:center;height:20vh\\\"> <h1 class=\\\"ms-font-su\\\">Functions</h1> </header> <div style=\\\"padding:10px\\\"> <div style=\\\"padding:10px;border:1px dashed #000\\\"> <h1>Revenue Predictions</h1> <h2>Instructions</h2> <ol> <li>Please Don't rename the sheets </li> <li>Keep the format of the sheets constant.</li> <li>Drug Replenish Dates(New Kits) & Revenue Prediction contain the Drug replenishment dates and Revenue Predictions respectively</li> <li>To Create the prediction click the button below</li> </ol> <div id=\\\"run\\\" style=\\\"padding:10px;background-color:#6495ed;color:#fff;cursor:pointer;text-align:center;font-weight:700\\\"> <span class=\\\"ms-Button-label\\\" style=\\\"text-align:center\\\">Create Revenue Predictions</span> </div> </div> </div> <p><label id=\\\"item-subject\\\"></label></p>  </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_createForOfIteratorHelper","_n","F","s","next","_slicedToArray","_arrayWithHoles","push","_iterableToArrayLimit","_nonIterableRest","toString","slice","constructor","name","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","run","_run","_callee2","_t0","_context2","Excel","_ref3","_callee","context","FREE_DRUGS","ws","packageDetails","packageDetailsRange","usedRange","drugsExpirationPredictions","wsAutoReplenishMedGroups","wsRevenuePredictions","wsAEDDetails","aedUsedRange","aedLastRow","aedDataRange","aedMedsObj","monthlyIncreaseMap","yearlyIncreaseSheet","usedRangeIncrease","increaseDataRange","lastRow","data","packageDetailsData","medsObj","emkDetails","wsNewKit","newKitsLastRow","newKitsLastRowIndex","dataRange","newKitData","salesHistory","discountPercentage","discountRange","getAdjustedPrice","calculatedKitData","takeoverRevenueMap","takeoverDrugPredictions","drugsTakeoverExpirationPredictions","wsTakeoverDrugDetails","takeoverDrugsUsedRange","takeoverDrugsLastRow","takeoverDrugsDataRange","takeoverDrugDetails","drugCount","wsNewTakeoverKitData","takeoverKitsUsedRange","takeoverKitsLastRow","takeoverKitsDataRange","kitColumns","totalProcessed","monthlyBreakdown","currentPredictionsRange","currentRowCount","newKitDrugPredictions","updatedDrugData","baseMap","forecastMap","drugDataMap","usedRangeAutoReplenishMedGroups","lastRowAutoReplenishMedGroups","rangeAutoReplenishMedGroupsAll","outputAutoReplenishAndForecast","_iterator3","_step3","_row4","_row5","group","company","medication","expirationStr","price","_autoReplenish2","config","baseDate","isFreeDrug","adjustedPrice","shelfLife","_i4","futureDate","futureAdjustedPrice","wsAutoReplenishAEDGroups","usedRangeAutoReplenishAEDGroups","lastRowAutoReplenishAEDGroups","rangeAutoReplenishAEDGroupsAll","outputAEDAutoReplenishAndForecast","_iterator4","_step4","_row6","_row7","_group","_company","aedItem","_expirationStr","_price","_autoReplenish3","cleanAEDItem","_config","_baseDate","_isFreeDrug","_adjustedPrice","_shelfLife","_i5","_futureDate","_futureAdjustedPrice","autoReplenish","aedAutoReplenish","allMonths","finalRevenueForecast","currentMonth","currentMonthKey","nonAutoReplenishSheet","nonAutoPercentage","g2Range","h2Range","aedSalesValue","aedSalesSheet","aedSalesRange","sortedMonths","_iterator5","_step5","_month3","newkit","auto","_aedAuto","_drugData","_takeoverRevenue","nonAutoReplenishment","_aedSales","_totalRevenue","headers","autoReplenishDatesAndData","sheet","autoReplenishHistoryUsedRange","headerRange","datesRange","headersHistory","currentMonthFormatted","currentMonthPostion","datesInHistory","beginningDateIndex","aedAutoReplenishDatesAndData","aedHistorySheet","aedHistoryUsedRange","currentDateFormatted","_allMonths","datesColumn","valuesColumn","lastHeaderRange","datesColumnRange","existingDates","newColumnIndex","month","newMonths","startRow","_i2","_month","_value","yearlyRevenueSheet","revenueDataRange","revenueData","yearlySummary","_i3","row","_row3","_month2","totalRevenue","newKit","_autoReplenish","drugData","nonAuto","aedSales","aedAuto","takeoverRevenue","year","yearData","yearlyArray","_headers","sheetData","_headerRange","_t3","_t4","_t5","_t8","_t9","_context","Set","workbook","worksheets","getItem","getRange","getUsedRange","getLastRow","load","sync","rowIndex","concat","values","forEach","trim","itemName","units","unitCost","totalUnitCost","laCarte","basePrice","console","log","keys","Map","rowCount","isNaN","monthKey","formatDate","excelSerialDateToJSDate","set","parseFloat","getRangeByIndexes","clear","ClearApplyTo","contents","includedInPackages","retailPrice","newKitShares","purchasePrice","drugs","baseRetailPrice","targetDate","increaseMap","size","currentDate","Date","targetMonthKey","_step2","cumulativeIncrease","_iterator2","sort","increaseMonth","err","map","isPastMonth","numberOfKits","rowDate","EMK1_base_retail","EMK5_base_retail","EMK10_base_retail","EMK15_base_retail","EMK1Mini_base_retail","EMK10Mini_base_retail","EMK1_base","Math","floor","EMK5_base","EMK10_base","EMK15_base","EMK1Mini_base","EMK10Mini_base","totalDiscountedRevenue","EMK1","EMK5","EMK10","EMK15","EMK1Mini","EMK10Mini","index","drugName","kit","daysToFirstReplenishment","parseInt","drugPrice","takeoverDate","takeoverMonthKey","kits","revenue","_loop2","kitName","numberOfTakeovers","drug","has","firstReplenishDate","setUTCDate","getUTCDate","replenishmentDates","replenishmentRevenues","expireDate","expireYear","getUTCFullYear","expireMonth","String","getUTCMonth","padStart","drugRevenue","currentRevenue","entries","totalKitAmount","kitAmount","drugDate","parseMonthString","adjustedDrugPrice","_row2","date","expiryDays","_date$split$map2","split","Number","UTC","replenishments","getBaseKitMap","generateForecast","applyDrugDataRevenue","formatMonth","addDays","toFixed","applyAutoReplenishOnce","getCurrentMonthUTC","table","_ref4","_ref5","localeCompare","columnCount","formatDateWithDay","indexOf","x","findDateIndexInHistory","numberFormat","_ref6","_ref7","error","add","filter","_ref8","includes","total","takeover","_ref0","_ref1","format","fill","color","font","bold","autofitColumns","_x","baseKitRevenue","now","nextMonth","_ref","_ref2","dateStr","start","months","forecast","_start$split$map2","startYear","startMonth","baseRevenue","setUTCMonth","_step","_iterator","_loop","autoData","_row","expDate","priceStr","serial","NaN","utcDays","dateInfo","inputDate","today","currentYear","_inputDate$split$map2","day","dt","result","ym","_ym$split$map2","parsed","getTime","normalizedTarget","normalizeDateForComparison","normalizedHistory","warn","parts","Office","onReady","info","host","HostType","getElementById","onclick","URL"],"sourceRoot":""}