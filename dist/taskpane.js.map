{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n/* global console, document, Excel, Office */\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Excel) {\r\n    document.getElementById(\"run\").onclick = run;\r\n  }\r\n});\r\n\r\nexport async function run() {\r\n  try {\r\n    await Excel.run(async (context) => {\r\n      let ws = context.workbook.worksheets.getItem(\"DrugDetails\");\r\n      let packageDetails = context.workbook.worksheets.getItem(\"packageDistribution\");\r\n      let packageDetailsRange = packageDetails.getRange(\"A2:D7\");\r\n      let usedRange = ws.getUsedRange().getLastRow();\r\n      let wsAutoReplenishHistroy = context.workbook.worksheets.getItem(\"AutoReplenishHistory\");\r\n      let drugsExpirationPredictions = context.workbook.worksheets.getItem(\r\n        \"Drug Replenish Dates(New Kits)\"\r\n      );\r\n      let wsAutoReplenishMedGroups = context.workbook.worksheets.getItem(\r\n        \"auto_replenish_med_groups\"\r\n      );\r\n      let wsRevenuePredictions = context.workbook.worksheets.getItem(\"Revenue Prediction\");\r\n      \r\n      // Get monthly increase data from \"Yearly Med Increase\" sheet\r\n      let monthlyIncreaseMap = new Map();\r\n      try {\r\n        const yearlyIncreaseSheet = context.workbook.worksheets.getItem(\"Yearly Med Increase\");\r\n        const usedRangeIncrease = yearlyIncreaseSheet.getUsedRange();\r\n        usedRangeIncrease.load(\"rowCount\");\r\n        await context.sync();\r\n        \r\n        if (usedRangeIncrease.rowCount > 1) {\r\n          const increaseDataRange = yearlyIncreaseSheet.getRange(`A2:B${usedRangeIncrease.rowCount}`);\r\n          increaseDataRange.load(\"values\");\r\n          await context.sync();\r\n          \r\n          increaseDataRange.values.forEach(row => {\r\n            if (row[0] && row[1] !== null && row[1] !== \"\" && !isNaN(row[1])) {\r\n              const date = excelSerialDateToJSDate(row[0]);\r\n              const monthKey = formatDate(date);\r\n              //Percentage Increase Area\r\n              monthlyIncreaseMap.set(monthKey, parseFloat(row[1]));\r\n            }\r\n          });\r\n          console.log(\"Monthly increase data loaded:\", monthlyIncreaseMap);\r\n        }\r\n      } catch (error) {\r\n        console.log(\"Yearly Med Increase sheet not found or error reading data, using no increases\");\r\n      }\r\n      \r\n      // Clear only up to column J to preserve discount in column L\r\n      wsRevenuePredictions.getRangeByIndexes(1, 0, 10000, 10).clear(Excel.ClearApplyTo.contents);\r\n      drugsExpirationPredictions\r\n        .getRangeByIndexes(1, 0, 10000, 50)\r\n        .clear(Excel.ClearApplyTo.contents);\r\n      \r\n      //Get the Details\r\n      usedRange.load(\"rowIndex\");\r\n      await context.sync();\r\n      let lastRow = usedRange.rowIndex;\r\n      let data = ws.getRange(`B${1}:O${lastRow + 1}`);\r\n      data.load(\"values\");\r\n      packageDetailsRange.load(\"values\");\r\n      await context.sync();\r\n      let packageDetailsData = packageDetailsRange.values;\r\n      let medsObj = {};\r\n      let emkDetails = {};\r\n      \r\n      //Get the drug details\r\n      console.log(data.values);\r\n      data.values.forEach((row) => {\r\n        medsObj[row[0]] = {\r\n          totalUnitCost: row[3],\r\n          laCarte: row[4],\r\n          includedInPackages: [],\r\n          shelfLife: row[7],\r\n          basePrice: row[4] // Store base price for monthly increases\r\n        };\r\n        for (let i = 8; i <= 13; i++) {\r\n          if (row[i].toString().trim() !== \"\") {\r\n            medsObj[row[0]].includedInPackages.push(data.values[0][i]);\r\n          }\r\n        }\r\n      });\r\n\r\n      packageDetailsData.forEach((row) => {\r\n        //Create the emk objecst\r\n        emkDetails[row[0]] = {\r\n          retailPrice: row[1],\r\n          newKitShares: row[2],\r\n          purchasePrice: row[3],\r\n          drugs: [],\r\n          baseRetailPrice: row[1] // Store base price for monthly increases\r\n        };\r\n      });\r\n      console.log(medsObj,\"Meds Object\")\r\n\r\n      //Get the New Kit Data\r\n      let wsNewKit = context.workbook.worksheets.getItem(\"New Kit Data\");\r\n      let newKitsLastRow = wsNewKit.getUsedRange().getLastRow();\r\n      newKitsLastRow.load(\"rowIndex\");\r\n      await context.sync();\r\n      let newKitsLastRowIndex = newKitsLastRow.rowIndex;\r\n      let dataRange = wsNewKit.getRange(`A2:B${newKitsLastRowIndex + 1}`);\r\n      dataRange.load(\"values\");\r\n      await context.sync();\r\n      let newKitData = dataRange.values;\r\n      let salesHistory = {};\r\n      \r\n      // Get discount percentage from L2\r\n      let discountPercentage = 0;\r\n      try {\r\n        const discountRange = wsNewKit.getRange(\"L2\");\r\n        discountRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        if (discountRange.values[0][0] !== null && discountRange.values[0][0] !== \"\" && !isNaN(discountRange.values[0][0])) {\r\n          discountPercentage = parseFloat(discountRange.values[0][0]);\r\n          console.log(\"Using discount percentage:\", discountPercentage);\r\n        }\r\n      } catch (error) {\r\n        console.log(\"Error reading discount from L2, using 0% discount\");\r\n      }\r\n      \r\n      // Function to apply monthly price increases cumulatively\r\n      const getAdjustedPrice = (basePrice, targetDate, increaseMap) => {\r\n        if (increaseMap.size === 0) return basePrice;\r\n        \r\n        const currentDate = new Date();\r\n        const targetMonthKey = formatDate(targetDate);\r\n        \r\n        // If target date is before current date, no increases applied\r\n        if (targetDate < currentDate) return basePrice;\r\n        \r\n        // Sort all increase months chronologically\r\n        const sortedIncreaseMonths = Array.from(increaseMap.keys()).sort();\r\n        \r\n        let adjustedPrice = basePrice;\r\n        let cumulativeIncrease = 1;\r\n        \r\n        // Apply all increases that occur before or in the target month\r\n        for (const increaseMonth of sortedIncreaseMonths) {\r\n          if (increaseMonth <= targetMonthKey) {\r\n            const increaseRate = increaseMap.get(increaseMonth);\r\n            cumulativeIncrease *= (1 + increaseRate);\r\n          }\r\n        }\r\n        \r\n        adjustedPrice = basePrice * cumulativeIncrease;\r\n        return adjustedPrice;\r\n      };\r\n      \r\n      //Get the Kit Revenue for each Kit and total Revenue with discount applied\r\n      let calculatedKitData = newKitData.map((row) => {\r\n        let currentMonthKey = formatDate(excelSerialDateToJSDate(row[0]))\r\n        if(!isPastMonth(currentMonthKey)){\r\n          salesHistory[currentMonthKey] = row[1];\r\n        }\r\n        let numberOfKits = row[1];\r\n        const rowDate = excelSerialDateToJSDate(row[0]);\r\n        \r\n        // Calculate base prices with monthly increases applied\r\n        let EMK1_base_retail = getAdjustedPrice(emkDetails[\"EMK1\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK5_base_retail = getAdjustedPrice(emkDetails[\"EMK5\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK10_base_retail = getAdjustedPrice(emkDetails[\"EMK10\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK15_base_retail = getAdjustedPrice(emkDetails[\"EMK15\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK1Mini_base_retail = getAdjustedPrice(emkDetails[\"EMK1-Mini\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        let EMK10Mini_base_retail = getAdjustedPrice(emkDetails[\"EMK10-Mini\"].baseRetailPrice, rowDate, monthlyIncreaseMap);\r\n        \r\n        let EMK1_base =\r\n          Math.floor(emkDetails[\"EMK1\"].newKitShares * numberOfKits) *\r\n          EMK1_base_retail;\r\n        let EMK5_base =\r\n          Math.floor(emkDetails[\"EMK5\"].newKitShares * numberOfKits) *\r\n          EMK5_base_retail;\r\n        let EMK10_base =\r\n          Math.floor(emkDetails[\"EMK10\"].newKitShares * numberOfKits) *\r\n          EMK10_base_retail;\r\n        let EMK15_base =\r\n          Math.floor(emkDetails[\"EMK15\"].newKitShares * numberOfKits) *\r\n          EMK15_base_retail;\r\n        let EMK1Mini_base =\r\n          Math.floor(emkDetails[\"EMK1-Mini\"].newKitShares * numberOfKits) *\r\n          EMK1Mini_base_retail;\r\n        let EMK10Mini_base =\r\n          Math.floor(emkDetails[\"EMK10-Mini\"].newKitShares * numberOfKits) *\r\n          EMK10Mini_base_retail;\r\n        \r\n        // Apply discount to total revenue\r\n        let totalBaseRevenue = EMK1_base + EMK5_base + EMK10_base + EMK15_base + EMK1Mini_base + EMK10Mini_base;\r\n        let totalDiscountedRevenue = totalBaseRevenue * (1 - discountPercentage);\r\n        \r\n        // Apply discount to individual kit revenues\r\n        let EMK1 = EMK1_base * (1 - discountPercentage);\r\n        let EMK5 = EMK5_base * (1 - discountPercentage);\r\n        let EMK10 = EMK10_base * (1 - discountPercentage);\r\n        let EMK15 = EMK15_base * (1 - discountPercentage);\r\n        let EMK1Mini = EMK1Mini_base * (1 - discountPercentage);\r\n        let EMK10Mini = EMK10Mini_base * (1 - discountPercentage);\r\n        \r\n        return [\r\n          row[0],\r\n          row[1],\r\n          totalDiscountedRevenue,\r\n          \"\",\r\n          EMK1,\r\n          EMK5,\r\n          EMK10,\r\n          EMK15,\r\n          EMK1Mini,\r\n          EMK10Mini,\r\n        ];\r\n      });\r\n      \r\n      //Add the Kit Revenue to the sheet (only up to column J to preserve discount in L)\r\n      wsNewKit.getRange(\"A2:J\" + (calculatedKitData.length + 1)).values = calculatedKitData;\r\n      \r\n      //Get the drugs that belong to each Kit\r\n      data.values.forEach((row) => {\r\n        row[8] === \"X\" ? emkDetails[\"EMK1\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[9] === \"X\" ? emkDetails[\"EMK5\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[10] === \"X\" ? emkDetails[\"EMK10\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[11] === \"X\" ? emkDetails[\"EMK15\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[12] === \"X\" ? emkDetails[\"EMK1-Mini\"][\"drugs\"].push(row[0]) : \"\";\r\n        row[13] === \"X\" ? emkDetails[\"EMK10-Mini\"][\"drugs\"].push(row[0]) : \"\";\r\n      });\r\n      \r\n      //Creating calculation for all drugs per month with monthly price increases\r\n      let newKitDrugPredictions = [];\r\n      Object.keys(salesHistory).forEach((month) => {\r\n        let totalKitAmount = salesHistory[month];\r\n        Object.keys(emkDetails).forEach((kit) => {\r\n          let kitAmount = Math.floor(totalKitAmount * emkDetails[kit].newKitShares);\r\n          if (kitAmount < 1) return;\r\n          emkDetails[kit].drugs.forEach((drug) => {\r\n            if (medsObj[drug].shelfLife == \"\" || medsObj[drug].shelfLife == \"N/A\") return;\r\n            \r\n            // Apply monthly increase to drug price\r\n            const drugDate = parseMonthString(month);\r\n            const adjustedDrugPrice = getAdjustedPrice(medsObj[drug].basePrice, drugDate, monthlyIncreaseMap);\r\n            \r\n            newKitDrugPredictions.push([\r\n              month,\r\n              kit,\r\n              drug,\r\n              kitAmount,\r\n              adjustedDrugPrice * kitAmount, // Use adjusted price\r\n              medsObj[drug].shelfLife,\r\n            ]);\r\n          });\r\n        });\r\n      });\r\n\r\n      //Adding Replenish Dates to the Drug Details\r\n      const updatedDrugData = newKitDrugPredictions.map((row) => {\r\n        const [date, code, description, qty, total, expiryDays] = row;\r\n        const [year, month] = date.split(\"-\").map(Number);\r\n        const baseDate = new Date(Date.UTC(year, month - 1, 1)); // Use UTC\r\n\r\n        const replenishments = [];\r\n\r\n        for (let i = 1; i <= 10; i++) {\r\n          const expireDate = new Date(baseDate);\r\n          expireDate.setUTCDate(expireDate.getUTCDate() + expiryDays * i); // Use UTC\r\n\r\n          const expireYear = expireDate.getUTCFullYear();\r\n          const expireMonth = String(expireDate.getUTCMonth() + 1).padStart(2, \"0\");\r\n\r\n          replenishments.push(`${expireYear}-${expireMonth}`);\r\n        }\r\n\r\n        return [...row, ...replenishments];\r\n      });\r\n      \r\n      drugsExpirationPredictions.getRangeByIndexes(\r\n        1,\r\n        0,\r\n        updatedDrugData.length,\r\n        updatedDrugData[0].length\r\n      ).values = updatedDrugData;\r\n      \r\n      // --- Step 5: Execute everything\r\n      const baseMap = getBaseKitMap(calculatedKitData);\r\n      const forecastMap = generateForecast(\"2025-07\", 300, baseMap);\r\n\r\n      // Plug in your generated updatedDrugData (with replenishment dates)\r\n      let drugDataMap = applyDrugDataRevenue(forecastMap, updatedDrugData);\r\n      let usedRangeAutoReplenishMedGroups = wsAutoReplenishMedGroups.getUsedRange();\r\n      let lastRowAutoReplenishMedGroups = usedRangeAutoReplenishMedGroups.getLastRow();\r\n      lastRowAutoReplenishMedGroups.load(\"rowIndex\");\r\n      await context.sync();\r\n      \r\n      //Get Autor replenish sheet data\r\n      let rangeAutoReplenishMedGroupsAll = wsAutoReplenishMedGroups.getRangeByIndexes(\r\n        2,\r\n        0,\r\n        lastRowAutoReplenishMedGroups.rowIndex - 1,\r\n        6\r\n      );\r\n      rangeAutoReplenishMedGroupsAll.load(\"values\");\r\n      await context.sync();\r\n      \r\n      //Add the Future expiration dates for the auto replenishments with monthly price increases\r\n      const outputAutoReplenishAndForecast = [\r\n        [\r\n          \"Group\",\r\n          \"Company\",\r\n          \"Medication\",\r\n          \"Expiration\",\r\n          \"Price\",\r\n          \"Auto Replenish\",\r\n          \"Generated Dates\",\r\n        ],\r\n      ];\r\n\r\n      for (const row of rangeAutoReplenishMedGroupsAll.values) {\r\n        const [group, company, medication, expirationStr, price, autoReplenish] = row;\r\n\r\n        if (autoReplenish !== \"Enabled\" || expirationStr == \"N/A\" || expirationStr == \"\") continue;\r\n\r\n        const config = medsObj[medication];\r\n        const baseDate = excelSerialDateToJSDate(expirationStr);\r\n\r\n        // Apply monthly increase to the base price\r\n        const adjustedPrice = baseDate ? getAdjustedPrice(price, baseDate, monthlyIncreaseMap) : price;\r\n\r\n        // Always include original\r\n        outputAutoReplenishAndForecast.push([\r\n          group,\r\n          company,\r\n          medication,\r\n          baseDate ? formatMonth(baseDate) : \"N/A\",\r\n          adjustedPrice,\r\n          autoReplenish,\r\n          \"\",\r\n        ]);\r\n\r\n        if (!config || !baseDate){ \r\n          continue\r\n        };\r\n\r\n        const { shelfLife } = config;\r\n\r\n        for (let i = 1; i <= 20; i++) {\r\n          const futureDate = addDays(baseDate, shelfLife * i);\r\n          const futureAdjustedPrice = getAdjustedPrice(price, futureDate, monthlyIncreaseMap);\r\n          \r\n          outputAutoReplenishAndForecast.push([\r\n            group,\r\n            company,\r\n            medication,\r\n            formatMonth(futureDate),\r\n            parseFloat(futureAdjustedPrice.toFixed(2)),\r\n            autoReplenish,\r\n            \"Generated\",\r\n          ]);\r\n        }\r\n      }\r\n\r\n      // Auto-replenish items (only applied once)\r\n      let autoReplenish = applyAutoReplenishOnce(forecastMap, outputAutoReplenishAndForecast);\r\n      console.log(drugDataMap, baseMap, autoReplenish);\r\n\r\n      // 1. Combine all unique months\r\n      const allMonths = new Set([\r\n        ...drugDataMap.keys(),\r\n        ...autoReplenish.keys(),\r\n        ...baseMap.keys(),\r\n        ...forecastMap.keys(),\r\n      ]);\r\n\r\n      // 2. Generate final forecast array with Non-Auto Replenishment column\r\n      const finalRevenueForecast = [];\r\n      const currentMonth = getCurrentMonthUTC();\r\n      const currentMonthKey = formatMonth(currentMonth);\r\n      // Get the percentage from Non-Auto Replenish sheet\r\n      let nonAutoReplenishSheet;\r\n      let nonAutoPercentage = 0.25; // Default to 25%\r\n      \r\n      try {\r\n        nonAutoReplenishSheet = context.workbook.worksheets.getItem(\"Non-Auto Replenish\");\r\n        const g2Range = nonAutoReplenishSheet.getRange(\"G2\");\r\n        const h2Range = nonAutoReplenishSheet.getRange(\"H2\");\r\n        \r\n        g2Range.load(\"values\");\r\n        h2Range.load(\"values\");\r\n        await context.sync();\r\n        \r\n        // Use H2 if not empty, otherwise use G2\r\n        if (h2Range.values[0][0] !== null && h2Range.values[0][0] !== \"\" && !isNaN(h2Range.values[0][0])) {\r\n          nonAutoPercentage = parseFloat(h2Range.values[0][0]);\r\n        } else if (g2Range.values[0][0] !== null && g2Range.values[0][0] !== \"\" && !isNaN(g2Range.values[0][0])) {\r\n          nonAutoPercentage = parseFloat(g2Range.values[0][0]);\r\n        }\r\n        \r\n        console.log(\"Using Non-Auto Replenishment percentage:\", nonAutoPercentage);\r\n      } catch (error) {\r\n        console.log(\"Non-Auto Replenish sheet not found or error reading values, using default 25%\");\r\n      }\r\n\r\n      // Get AED sales value\r\n      let aedSalesValue = 0;\r\n      try {\r\n        const aedSalesSheet = context.workbook.worksheets.getItem(\"AED Sales\");\r\n        const aedSalesRange = aedSalesSheet.getRange(\"G2\");\r\n        aedSalesRange.load(\"values\");\r\n        await context.sync();\r\n        \r\n        if (aedSalesRange.values[0][0] !== null && aedSalesRange.values[0][0] !== \"\" && !isNaN(aedSalesRange.values[0][0])) {\r\n          aedSalesValue = parseFloat(aedSalesRange.values[0][0]);\r\n        }\r\n        \r\n        console.log(\"Using AED Sales value:\", aedSalesValue);\r\n      } catch (error) {\r\n        console.log(\"AED Sales sheet not found or error reading G2 value, using 0\");\r\n      }\r\n\r\n      for (const month of [...allMonths].sort()) {\r\n        const newkit = baseMap.get(month) || 0;\r\n        const auto = autoReplenish.get(month) || 0;\r\n        const drugData = drugDataMap.get(month) || 0;\r\n        \r\n        // Calculate Non-Auto Replenishment (25% of Auto Replenish, only for future months)\r\n        const nonAutoReplenishment = (month > currentMonthKey) ? auto * nonAutoPercentage : 0;\r\n        \r\n        // Calculate AED Sales (only for future months)\r\n        const aedSales = (month > currentMonthKey) ? aedSalesValue : 0;\r\n        \r\n        // Update total revenue to include non-auto replenishment and AED sales\r\n        const totalRevenue = newkit + auto + drugData + nonAutoReplenishment + aedSales;\r\n\r\n        finalRevenueForecast.push([\r\n          month, \r\n          totalRevenue, \r\n          newkit, \r\n          auto, \r\n          drugData,\r\n          nonAutoReplenishment,  // New column: Non-Auto Replenishment\r\n          aedSales               // New column: AED sales\r\n        ]);\r\n      }\r\n\r\n      wsRevenuePredictions.getRangeByIndexes(\r\n        1,\r\n        0,\r\n        finalRevenueForecast.length,\r\n        finalRevenueForecast[0].length\r\n      ).values = finalRevenueForecast;\r\n      await context.sync();\r\n      console.table(finalRevenueForecast);\r\n\r\n      //AutoReplenish History\r\n      let autoReplenishDatesAndData = getDatesAndData(finalRevenueForecast);\r\n      const sheet = context.workbook.worksheets.getItem(\"AutoReplenishHistory\");\r\n      \r\n      //Get last column\r\n      const autoReplenishHistoryUsedRange = sheet.getUsedRange();\r\n      autoReplenishHistoryUsedRange.load([\"columnIndex\", \"columnCount\",\"rowCount\"]);\r\n      await context.sync();\r\n      \r\n      // Load row 2 headers (row index 1)\r\n      if(autoReplenishHistoryUsedRange.columnCount <=1) return //There is no data.\r\n      \r\n      const headerRange = sheet.getRangeByIndexes(1, 1, 1, autoReplenishHistoryUsedRange.columnCount-1);\r\n      const datesRange = sheet.getRangeByIndexes(2,0,autoReplenishHistoryUsedRange.rowCount-2,1);\r\n      headerRange.load(\"values\");\r\n      datesRange.load(\"values\");\r\n      await context.sync();\r\n      \r\n      console.log(\"Dates in History:\", datesRange.values);\r\n      const headers = headerRange.values[0] // Row 2\r\n      let currentMonthFormatted = formatDateWithDay(new Date());\r\n      let currentMonthPostion = headers.indexOf(currentMonthFormatted);\r\n      let datesInHistory = datesRange.values.map(x => x[0]);\r\n      \r\n      // Use normalized date comparison to find the correct starting row\r\n      let beginningDateIndex = findDateIndexInHistory(datesInHistory, autoReplenishDatesAndData[0][0]);\r\n      \r\n      console.log(\"Beginning Date Index:\", beginningDateIndex);\r\n      console.log(\"Target Date:\", autoReplenishDatesAndData[0][0]);\r\n      console.log(\"Current Month Position:\", currentMonthPostion);\r\n      \r\n      await context.sync();\r\n      \r\n      //Check if it exists in the headers\r\n      if(currentMonthPostion !== -1){ //it Exists\r\n        //Add data to the same column\r\n        sheet.getRangeByIndexes(2+beginningDateIndex,currentMonthPostion+1,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[1]])\r\n        sheet.getRangeByIndexes(2+beginningDateIndex,0,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[0]])\r\n      }\r\n      else{\r\n        //Add data to a new column(The last column) starting at index 1 \r\n        \r\n        sheet.getRangeByIndexes(1, autoReplenishHistoryUsedRange.columnCount, 1, 1).numberFormat = [[\"@\"]]; // force text\r\n        sheet.getRangeByIndexes(1, autoReplenishHistoryUsedRange.columnCount, 1, 1).values = [[currentMonthFormatted]];\r\n        sheet.getRangeByIndexes(2+beginningDateIndex,autoReplenishHistoryUsedRange.columnCount,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[1]])\r\n        sheet.getRangeByIndexes(2+beginningDateIndex,0,autoReplenishDatesAndData.length,1).values = autoReplenishDatesAndData.map(x=>[x[0]])\r\n      }\r\n      \r\n      await context.sync();\r\n      return context.sync();\r\n    });\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\n// ... (all the helper functions remain exactly the same as in your original code)\r\n// getDatesAndData, getBaseKitMap, generateForecast, applyDrugDataRevenue, applyAutoReplenishOnce,\r\n// excelSerialDateToJSDate, isPastMonth, formatDate, formatDateWithDay, formatMonth, addDays,\r\n// getCurrentMonthUTC, parseMonthString, findDateIndexInHistory, normalizeDateForComparison, parseMonth\r\n\r\nfunction getDatesAndData(foreCastData=[[]]){\r\n  return foreCastData.map(\r\n    x => [x[0],x[3]]\r\n  )\r\n}\r\n\r\nfunction getBaseKitMap(baseKitRevenue) {\r\n  const map = new Map();\r\n\r\n  const now = getCurrentMonthUTC(); // Use UTC for consistency\r\n  const nextMonth = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth() + 1, 1));\r\n\r\n  baseKitRevenue.forEach(([dateStr, kitQuantity, revenue]) => {\r\n    const date = excelSerialDateToJSDate(dateStr);\r\n    if (date >= nextMonth) {\r\n      const key = `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, \"0\")}`;\r\n      map.set(key, revenue);\r\n    }\r\n  });\r\n\r\n  return map;\r\n}\r\n\r\nfunction generateForecast(start = \"2023-06\", months = 120, baseMap = new Map()) {\r\n  const forecast = new Map();\r\n  const [startYear, startMonth] = start.split(\"-\").map(Number);\r\n  const date = new Date(Date.UTC(startYear, startMonth - 1, 1)); // Use UTC\r\n\r\n  for (let i = 0; i < months; i++) {\r\n    const year = date.getUTCFullYear();\r\n    const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n    const key = `${year}-${month}`;\r\n    const baseRevenue = baseMap.get(key) || 0;\r\n    forecast.set(key, baseRevenue);\r\n    date.setUTCMonth(date.getUTCMonth() + 1);\r\n  }\r\n\r\n  return forecast;\r\n}\r\n\r\nfunction applyDrugDataRevenue(forecastMap, drugData) {\r\n  let drugDataMap = new Map();\r\n  for (const row of drugData) {\r\n    const total = parseFloat(row[4]);\r\n    const replenishmentDates = row.slice(6);\r\n    \r\n    replenishmentDates.forEach((date) => {\r\n      if (forecastMap.has(date)) {\r\n        forecastMap.set(date, forecastMap.get(date) + total);\r\n        drugDataMap.set(\r\n          date,\r\n          drugDataMap.get(date) != undefined ? drugDataMap.get(date) + total : total\r\n        );\r\n      }\r\n    });\r\n  }\r\n  return drugDataMap;\r\n}\r\n\r\nfunction applyAutoReplenishOnce(forecastMap, autoData) {\r\n  let autoReplenish = new Map();\r\n  autoData.forEach((row) => {\r\n    const [Group, Company, Medication, expDate, priceStr, status] = row;\r\n\r\n    if (status !== \"Enabled\") return;\r\n    const price = typeof priceStr == \"string\" ? parseFloat(priceStr.replace(\"$\", \"\")) : priceStr;\r\n\r\n    // Parse expiration date consistently\r\n    const date = parseMonthString(expDate);\r\n    if (!date) return;\r\n    \r\n    const key = `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, \"0\")}`;\r\n    \r\n    if (forecastMap.has(key)) {\r\n      if (!isNaN(price)) {\r\n        forecastMap.set(key, forecastMap.get(key) + price);\r\n        autoReplenish.set(\r\n          key,\r\n          autoReplenish.get(key) !== undefined ? autoReplenish.get(key) + price : price\r\n        );\r\n      }\r\n    }\r\n  });\r\n  return autoReplenish;\r\n}\r\n\r\n//  Helper Functions (Timezone Safe) \r\n\r\nfunction excelSerialDateToJSDate(serial) {\r\n  // More robust Excel serial date conversion with UTC\r\n  if (!serial || isNaN(serial)) return new Date(NaN);\r\n  \r\n  const utcDays = Math.floor(serial - 25569);\r\n  const utcValue = utcDays * 86400;\r\n  const dateInfo = new Date(utcValue * 1000);\r\n  \r\n  // Return UTC date to avoid timezone shifts\r\n  return new Date(Date.UTC(\r\n    dateInfo.getUTCFullYear(),\r\n    dateInfo.getUTCMonth(),\r\n    dateInfo.getUTCDate()\r\n  ));\r\n}\r\n\r\nfunction isPastMonth(inputDate) {\r\n  const today = getCurrentMonthUTC();\r\n  \r\n  const currentYear = today.getUTCFullYear();\r\n  const currentMonth = today.getUTCMonth() + 1;\r\n\r\n  let year, month;\r\n\r\n  if (inputDate instanceof Date) {\r\n    year = inputDate.getUTCFullYear();\r\n    month = inputDate.getUTCMonth() + 1;\r\n  } else if (typeof inputDate === \"string\") {\r\n    [year, month] = inputDate.split(\"-\").map(Number);\r\n  } else {\r\n    return false;\r\n  }\r\n\r\n  return (currentYear > year || (currentYear === year && currentMonth > month));\r\n}\r\n\r\nfunction formatDate(date) {\r\n  // Always use UTC to avoid timezone issues\r\n  const year = date.getUTCFullYear();\r\n  const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n  return `${year}-${month}`;\r\n}\r\n\r\nfunction formatDateWithDay(date) {\r\n  // Always use UTC to avoid timezone issues\r\n  const year = date.getUTCFullYear();\r\n  const month = String(date.getUTCMonth() + 1).padStart(2, \"0\");\r\n  const day = String(date.getUTCDate()).padStart(2, \"0\");\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nfunction formatMonth(dt) {\r\n  const y = dt.getUTCFullYear(),\r\n    m = String(dt.getUTCMonth() + 1).padStart(2, \"0\");\r\n  return `${y}-${m}`;\r\n}\r\n\r\nfunction addDays(dt, n) {\r\n  // Use UTC to avoid DST issues\r\n  const result = new Date(dt);\r\n  result.setUTCDate(result.getUTCDate() + n);\r\n  return result;\r\n}\r\n\r\nfunction getCurrentMonthUTC() {\r\n  const now = new Date();\r\n  return new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), 1));\r\n}\r\n\r\nfunction parseMonthString(ym) {\r\n  // Robust parsing of various date formats\r\n  if (!ym || ym === \"N/A\") return new Date(NaN);\r\n  \r\n  try {\r\n    // Handle \"YYYY-MM\" format\r\n    if (/^\\d{4}-\\d{2}$/.test(ym)) {\r\n      const [y, m] = ym.split(\"-\").map(Number);\r\n      return new Date(Date.UTC(y, m - 1, 1));\r\n    }\r\n    \r\n    // Handle \"MM/DD/YYYY\" or other formats\r\n    const parsed = new Date(ym);\r\n    if (isNaN(parsed.getTime())) return new Date(NaN);\r\n    \r\n    // Convert to UTC first day of month\r\n    return new Date(Date.UTC(parsed.getUTCFullYear(), parsed.getUTCMonth(), 1));\r\n  } catch (e) {\r\n    return new Date(NaN);\r\n  }\r\n}\r\n\r\nfunction findDateIndexInHistory(datesInHistory, targetDate) {\r\n  // Normalize both dates for comparison\r\n  const normalizedTarget = normalizeDateForComparison(targetDate);\r\n  \r\n  for (let i = 0; i < datesInHistory.length; i++) {\r\n    const normalizedHistory = normalizeDateForComparison(datesInHistory[i]);\r\n    if (normalizedTarget.getTime() === normalizedHistory.getTime()) {\r\n      return i;\r\n    }\r\n  }\r\n  \r\n  console.warn(\"Target date not found in history, using index 0\");\r\n  return 0;\r\n}\r\n\r\nfunction normalizeDateForComparison(dateStr) {\r\n  // Handle both \"YYYY-MM\" and \"YYYY-MM-DD\" formats\r\n  const parts = dateStr.split('-');\r\n  const year = parseInt(parts[0]);\r\n  const month = parseInt(parts[1]);\r\n  \r\n  // Always return the first day of month in UTC for consistent comparison\r\n  return new Date(Date.UTC(year, month - 1, 1));\r\n}\r\n\r\n// Legacy function kept for compatibility\r\nfunction parseMonth(ym) {\r\n  return parseMonthString(ym);\r\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Protect It First Functions</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header style=\\\"display:flex;justify-content:center;align-items:center;height:20vh\\\"> <h1 class=\\\"ms-font-su\\\">Functions</h1> </header> <div style=\\\"padding:10px\\\"> <div style=\\\"padding:10px;border:1px dashed #000\\\"> <h1>Revenue Predictions</h1> <h2>Instructions</h2> <ol> <li>Please Don't rename the sheets </li> <li>Keep the format of the sheets constant.</li> <li>Drug Replenish Dates(New Kits) & Revenue Prediction contain the Drug replenishment dates and Revenue Predictions respectively</li> <li>To Create the prediction click the button below</li> </ol> <div id=\\\"run\\\" style=\\\"padding:10px;background-color:#6495ed;color:#fff;cursor:pointer;text-align:center;font-weight:700\\\"> <span class=\\\"ms-Button-label\\\" style=\\\"text-align:center\\\">Create Revenue Predictions</span> </div> </div> </div> <p><label id=\\\"item-subject\\\"></label></p>  </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_createForOfIteratorHelper","_n","F","s","next","_slicedToArray","_arrayWithHoles","push","_iterableToArrayLimit","_nonIterableRest","toString","slice","constructor","name","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","run","_run","_callee2","_t6","_context2","Excel","_ref3","_callee","context","ws","packageDetails","packageDetailsRange","usedRange","drugsExpirationPredictions","wsAutoReplenishMedGroups","wsRevenuePredictions","monthlyIncreaseMap","yearlyIncreaseSheet","usedRangeIncrease","increaseDataRange","lastRow","data","packageDetailsData","medsObj","emkDetails","wsNewKit","newKitsLastRow","newKitsLastRowIndex","dataRange","newKitData","salesHistory","discountPercentage","discountRange","getAdjustedPrice","calculatedKitData","newKitDrugPredictions","updatedDrugData","baseMap","forecastMap","drugDataMap","usedRangeAutoReplenishMedGroups","lastRowAutoReplenishMedGroups","rangeAutoReplenishMedGroupsAll","outputAutoReplenishAndForecast","_iterator3","_step3","row","_row3","group","company","medication","expirationStr","price","_autoReplenish","config","baseDate","adjustedPrice","shelfLife","futureDate","futureAdjustedPrice","autoReplenish","allMonths","finalRevenueForecast","currentMonth","currentMonthKey","nonAutoReplenishSheet","nonAutoPercentage","g2Range","h2Range","aedSalesValue","aedSalesSheet","aedSalesRange","_iterator4","_step4","month","newkit","auto","drugData","nonAutoReplenishment","aedSales","totalRevenue","autoReplenishDatesAndData","sheet","autoReplenishHistoryUsedRange","headerRange","datesRange","headers","currentMonthFormatted","currentMonthPostion","datesInHistory","beginningDateIndex","_t3","_context","workbook","worksheets","getItem","getRange","getUsedRange","getLastRow","Map","load","sync","rowCount","concat","values","forEach","isNaN","monthKey","formatDate","excelSerialDateToJSDate","set","parseFloat","console","log","getRangeByIndexes","clear","ClearApplyTo","contents","rowIndex","totalUnitCost","laCarte","includedInPackages","basePrice","trim","retailPrice","newKitShares","purchasePrice","drugs","baseRetailPrice","targetDate","increaseMap","size","currentDate","Date","targetMonthKey","_step2","cumulativeIncrease","_iterator2","keys","sort","increaseMonth","err","map","isPastMonth","numberOfKits","rowDate","EMK1_base_retail","EMK5_base_retail","EMK10_base_retail","EMK15_base_retail","EMK1Mini_base_retail","EMK10Mini_base_retail","EMK1_base","Math","floor","EMK5_base","EMK10_base","EMK15_base","EMK1Mini_base","EMK10Mini_base","totalDiscountedRevenue","EMK1","EMK5","EMK10","EMK15","EMK1Mini","EMK10Mini","totalKitAmount","kit","kitAmount","drug","drugDate","parseMonthString","adjustedDrugPrice","_row2","date","expiryDays","_date$split$map2","split","Number","year","UTC","replenishments","expireDate","setUTCDate","getUTCDate","expireYear","getUTCFullYear","expireMonth","String","getUTCMonth","padStart","getBaseKitMap","generateForecast","applyDrugDataRevenue","formatMonth","addDays","toFixed","applyAutoReplenishOnce","Set","getCurrentMonthUTC","table","getDatesAndData","columnCount","formatDateWithDay","indexOf","x","findDateIndexInHistory","numberFormat","_x","error","baseKitRevenue","now","nextMonth","_ref","_ref2","dateStr","revenue","start","months","forecast","_start$split$map2","startYear","startMonth","baseRevenue","setUTCMonth","_step","_iterator","_loop","total","has","autoData","_row","expDate","priceStr","serial","NaN","utcDays","dateInfo","inputDate","today","currentYear","_inputDate$split$map2","day","dt","result","ym","_ym$split$map2","parsed","getTime","normalizedTarget","normalizeDateForComparison","normalizedHistory","warn","parts","parseInt","Office","onReady","info","host","HostType","getElementById","onclick","URL"],"sourceRoot":""}